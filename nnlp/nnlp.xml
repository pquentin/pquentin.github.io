<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/Users/quentin/Code/nnlp"?>
<!-- %“documentclass–article˝ -->
<!-- %“documentclass–acmsmall˝ -->
<?latexml class="article" options="jair,twoside,11pt,theapa"?>
<?latexml package="jair,theapa,rawfonts"?>
<?latexml package="inputenc" options="utf8"?>
<?latexml package="url"?>
<?latexml package="amsmath"?>
<?latexml package="amssymb"?>
<?latexml package="mathtools"?>
<?latexml package="esdiff"?>
<?latexml package="algpseudocode" options="noend"?>
<?latexml package="algorithm"?>
<?latexml package="tikz"?>
<?latexml package="tikz-qtree"?>
<?latexml package="neuralnetwork"?>
<?latexml package="listings"?>
<!-- %**** root.tex Line 25 **** -->
<?latexml package="courier"?>
<!-- %**** root.tex Line 50 **** -->
<!-- %“author–Yoav Goldberg˝ -->
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <resource src="ltx-listings.css" type="text/css"/>
  <title>A Primer on Neural Network Models<break/>for Natural Language Processing</title>
  <creator role="author">
    <personname>Yoav Goldberg <break/><text fontsize="90%">Draft as of October 10, 2015.</text></personname>
  </creator>
  <abstract name="Abstract">
    <p>Over the past few years, neural networks have re-emerged as powerful
machine-learning models, yielding state-of-the-art results in fields such as image
recognition and speech processing. More recently, neural network models
started to be applied also to textual natural language signals, again with very
promising results. This tutorial surveys neural network models from the
perspective of natural language processing research, in an attempt to bring
natural-language researchers up to speed with the neural techniques. The
tutorial covers input encoding for natural language tasks, feed-forward
networks, convolutional networks, recurrent networks and recursive networks,
as well as the computation graph abstraction for
automatic gradient computation.</p>
  </abstract>
  <para xml:id="p1">
    <p>
<inline-block class="ltx_parbox" vattach="middle" width="390.3pt" framed="rectangle"><p><text fontsize="90%">The most up-to-date version of this manuscript is available at
<ref class="ltx_url" href="http://www.cs.biu.ac.il/~yogo/nnlp.pdf"><text font="typewriter">http://www.cs.biu.ac.il/~yogo/nnlp.pdf</text></ref>. Major updates will be published on
arxiv periodically.</text></p><p><text fontsize="90%">I welcome any comments you may have regarding the content and
presentation. If you spot a missing reference or have relevant work you’d
like to see mentioned, do let me know.</text></p><p><text fontsize="90%" font="typewriter">first.last@gmail</text></p></inline-block>
<!-- %**** root.tex Line 75 **** --></p>
  </para>
  <section refnum="1" xml:id="S1">
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>For a long time, core NLP techniques were dominated by machine-learning
approaches that used linear models such as support vector machines or logistic
regression, trained over very high dimensional yet very sparse feature vectors.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Recently, the field has seen some success in switching from such linear models
over sparse inputs to non-linear neural-network models over dense inputs. While
most of the neural network techniques are easy to apply, sometimes as almost
<!-- %**** root.tex Line 100 **** -->drop-in replacements of the old linear classifiers, there is in many cases a
strong barrier of entry. In this tutorial I attempt to provide NLP
practitioners (as well as newcomers) with the basic background, jargon, tools
and methodology that will allow them to understand the principles behind the
neural network models and apply them to their own work. This tutorial is
expected to be self-contained, while presenting the different approaches under a
unified notation and framework. It repeats a lot of material which is available
elsewhere. It also points to external sources for more advanced topics when
appropriate.</p>
    </para>
    <para xml:id="S1.p3">
      <p>This primer is not intended as a comprehensive resource for those that will go
on and develop the next advances in neural-network machinery (though it may
serve as a good entry point). Rather, it is aimed at those readers who are
interested in taking the existing, useful technology and applying it in useful
and creative ways to their favourite NLP problems. For more in-depth, general
discussion of neural networks, the theory behind them, advanced optimization
methods and other advanced topics, the reader is referred to other existing
resources. In particular, the book by Bengio et al <ERROR class="undefined">\citeyear</ERROR>bengio2015deep is highly
recommended.</p>
    </para>
    <paragraph xml:id="S1.SS0.SSS0.Px1">
      <title>Scope</title>
      <para xml:id="S1.SS0.SSS0.Px1.p1">
        <p>The focus is on applications of neural networks to language
processing tasks. However, some subareas of language processing with neural
networks were decidedly left out of scope of this tutorial.
These include the vast literature of language modeling and acoustic modeling,
the use of neural networks for machine translation, and multi-modal applications
<!-- %**** root.tex Line 125 **** -->combining language and other signals such as images and videos
(e.g. caption generation). Caching methods for efficient runtime performance,
methods for efficient training with
large output vocabularies and attention models are also not discussed.
Word embeddings are discussed only to the extent that is needed to understand in order
to use them as inputs for other models. Other unsupervised approaches, including
autoencoders and recursive autoencoders, also fall out of scope.
While some
applications of neural networks for language modeling and machine translation are
mentioned in the text, their treatment is by no means comprehensive.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S1.SS0.SSS0.Px2">
      <title>A Note on Terminology</title>
      <para xml:id="S1.SS0.SSS0.Px2.p1">
        <p>The word “feature” is used to refer to a concrete, linguistic input such
as a word, a suffix, or a part-of-speech tag. For example, in a first-order
part-of-speech tagger, the features might be “current word, previous word, next
word, previous part of speech”. The term “input vector” is used to refer to
the actual input that is fed to the neural-network classifier. Similarly,
“input vector entry” refers to a specific value of the input. This is in contrast to
a lot of the neural networks literature in which the word “feature” is overloaded
between the two uses, and is used primarily to refer to an input-vector entry.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S1.SS0.SSS0.Px3">
      <title>Mathematical Notation</title>
      <para xml:id="S1.SS0.SSS0.Px3.p1">
        <p>I use bold upper case letters to represent
matrices (<Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m1" tex="\mathbf{X}" text="X"><XMath><XMTok role="UNKNOWN" font="bold">X</XMTok></XMath></Math>, <Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m2" tex="\mathbf{Y}" text="Y"><XMath><XMTok role="UNKNOWN" font="bold">Y</XMTok></XMath></Math>, <Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m3" tex="\mathbf{Z}" text="Z"><XMath><XMTok role="UNKNOWN" font="bold">Z</XMTok></XMath></Math>), and bold lower-case letters to
represent vectors (<Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m4" tex="\mathbf{b}" text="b"><XMath><XMTok role="UNKNOWN" font="bold">b</XMTok></XMath></Math>). When there
are series of related matrices and vectors (for example, where each matrix
<!-- %**** root.tex Line 150 **** -->corresponds to a different layer in the network), superscript indices are used
(<Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m5" tex="\mathbf{W^{1}}" text="W ^ 1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMath></Math>, <Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m6" tex="\mathbf{W^{2}}" text="W ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMath></Math>). For the rare cases in which we want indicate the power of a
matrix or a vector, a pair of brackets is added around the item to be
exponentiated: <Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m7" tex="(\mathbf{W})^{2},(\mathbf{W^{3}})^{2}" text="list@(W ^ 2, W ^ 3 ^ 2)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM17"/><XMRef idref="XM18"/></XMApp><XMWrap><XMApp xml:id="XM17"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMDual><XMRef idref="XM15"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM15" font="bold">W</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM18"><XMTok role="SUPERSCRIPTOP" scriptpos="post2"/><XMDual><XMRef idref="XM16"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM16"><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="3" role="NUMBER" font="bold">3</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
Unless otherwise stated, vectors are assumed to be row vectors.
We use <Math mode="inline" xml:id="S1.SS0.SSS0.Px3.p1.m8" tex="[\mathbf{v_{1}};\mathbf{v_{2}}]" text="list@(v _ 1, v _ 2)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM19"/><XMRef idref="XM20"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM19"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">v</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM20"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">v</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math> to denote vector concatenation.</p>
      </para>
      <pagination role="newpage"/>
    </paragraph>
  </section>
  <section refnum="2" xml:id="S2">
    <title><tag close=" ">2</tag>Neural Network Architectures</title>
    <para xml:id="S2.p1">
      <p>Neural networks are powerful learning models.
We will discuss two kinds of neural network architectures, that can be mixed and
matched – feed-forward networks and Recurrent / Recursive networks.
Feed-forward networks include networks with fully connected layers, such as the
multi-layer perceptron, as well as networks with convolutional and pooling
layers. All of the networks act as classifiers, but each with different
strengths.</p>
    </para>
    <para xml:id="S2.p2">
      <p>Fully connected feed-forward neural networks (Section <ref labelref="LABEL:sec:ff"/>) are non-linear learners that
can, for the most part, be used as a drop-in replacement wherever a linear
learner is used. This includes binary and multiclass classification problems,
as well as more complex structured prediction problems (Section
<ref labelref="LABEL:sec:structured"/>). The non-linearity of the
network, as well as the ability to easily integrate pre-trained word embeddings,
often lead to superior classification accuracy. A series of works
<!-- %**** root.tex Line 175 **** --><cite>[<bibref bibrefs="chen2014fast,weiss2015structured,pei2015effective,durrett2015neural" separator="," show="Refnum" yyseparator=","/>]</cite> managed to obtain improved syntactic parsing
results by simply replacing the linear model of a parser with a fully connected
feed-forward network. Straight-forward applications of a feed-forward network as a
classifier replacement (usually coupled with the use of pre-trained word
vectors) provide
benefits also for CCG supertagging <cite>[<bibref bibrefs="lewis2014improved" separator="," show="Refnum" yyseparator=","/>]</cite>, dialog state tracking <cite>[<bibref bibrefs="henderson2013deep" separator="," show="Refnum" yyseparator=","/>]</cite>, pre-ordering
for statistical machine translation <cite>[<bibref bibrefs="degispert2015fast" separator="," show="Refnum" yyseparator=","/>]</cite> and language
modeling <cite>[<bibref bibrefs="bengio2003neural,vaswani2013decoding" separator="," show="Refnum" yyseparator=","/>]</cite>. Iyyer et al
<ERROR class="undefined">\citeyear</ERROR>iyyer2015deep demonstrate that multi-layer feed-forward networks can
provide competitive results on sentiment classification and factoid question
answering.</p>
    </para>
    <para xml:id="S2.p3">
      <p>Networks with convolutional and pooling layers (Section <ref labelref="LABEL:sec:convnet"/>) are useful for classification tasks in which
we expect to find strong local clues regarding class membership, but these clues
can appear in different places in the input. For example, in a document
classification task, a single key phrase (or an ngram) can help in determining the
topic of the document <cite>[<bibref bibrefs="johnson2015effective" separator="," show="Refnum" yyseparator=","/>]</cite>. We would like to learn that certain sequences of words
are good indicators of the topic, and do not necessarily care where they appear
in the document. Convolutional and pooling layers allow the model to learn to
find such local indicators, regardless of their position. Convolutional and
pooling architecture show promising results on many tasks, including document classification
<cite>[<bibref bibrefs="johnson2015effective" separator="," show="Refnum" yyseparator=","/>]</cite>, short-text categorization <cite>[<bibref bibrefs="wang2015semantic" separator="," show="Refnum" yyseparator=","/>]</cite>,
sentiment classification <cite>[<bibref bibrefs="kalchbrenner2014convolutional,kim2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite>,
relation type classification between entities
<cite>[<bibref bibrefs="zeng2014relation,dossantos2015classifying" separator="," show="Refnum" yyseparator=","/>]</cite>, event detection
<!-- %**** root.tex Line 200 **** --><cite>[<bibref bibrefs="chen2015event,nguyen2015event" separator="," show="Refnum" yyseparator=","/>]</cite>, paraphrase identification <cite>[<bibref bibrefs="yin2015convolutional" separator="," show="Refnum" yyseparator=","/>]</cite>
semantic role labeling <cite>[<bibref bibrefs="collobert2011natural" separator="," show="Refnum" yyseparator=","/>]</cite>, question answering
<cite>[<bibref bibrefs="dong2015question" separator="," show="Refnum" yyseparator=","/>]</cite>, predicting box-office revenues of movies based on
critic reviews <cite>[<bibref bibrefs="bitvai2015nonlinear" separator="," show="Refnum" yyseparator=","/>]</cite> modeling text interestingness
<cite>[<bibref bibrefs="gao2014modeling" separator="," show="Refnum" yyseparator=","/>]</cite>, and modeling the relation between character-sequences
and part-of-speech tags <cite>[<bibref bibrefs="santos2014learning" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S2.p4">
      <p>In natural language we often work with structured data of arbitrary sizes,
such as sequences and trees. We would like to be able to capture regularities
in such structures, or to model similarities between such structures. In many
cases, this means encoding the structure as a fixed width vector, which we can
then pass on to another statistical learner for further processing. While
convolutional and pooling architectures allow us to encode arbitrary large items
as fixed size vectors capturing their most salient features, they do so by sacrificing
most of the structural information. Recurrent (Section <ref labelref="LABEL:sec:rnn"/>) and
recursive (Section <ref labelref="LABEL:sec:recnn"/>) architectures, on
the other hand, allow us to work with sequences and trees while preserving a lot
of the structural information. Recurrent networks <cite>[<bibref bibrefs="elman1990finding" separator="," show="Refnum" yyseparator=","/>]</cite> are designed to model
sequences, while recursive networks <cite>[<bibref bibrefs="goller1996learning" separator="," show="Refnum" yyseparator=","/>]</cite> are generalizations of recurrent networks
that can handle trees. We will also discuss an extension of recurrent networks that
allow them to model stacks
<cite>[<bibref bibrefs="dyer2015transitionbased,watanabe2015transitionbased" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S2.p5">
      <p>Recurrent models have been shown to produce very
strong results for language modeling, including
<!-- %**** root.tex Line 225 **** --><cite>[<bibref bibrefs="mikolov2010recurrent,mikolov2011extensions,mikolov2012statistical,duh2013adaptation,adel2013combination,auli2013joint,auli2014decoder" separator="," show="Refnum" yyseparator=","/>]</cite>;
as well as for sequence tagging
<cite>[<bibref bibrefs="irsoy2014opinion,xu2015ccg,ling2015finding" separator="," show="Refnum" yyseparator=","/>]</cite>, machine translation
<cite>[<bibref bibrefs="sundermeyer2014translation,tamura2014recurrent,sutskever2014sequence,cho2014learning" separator="," show="Refnum" yyseparator=","/>]</cite>,
dependency parsing <cite>[<bibref bibrefs="dyer2015transitionbased,watanabe2015transitionbased" separator="," show="Refnum" yyseparator=","/>]</cite>,
sentiment analysis <cite>[<bibref bibrefs="wang2015predicting" separator="," show="Refnum" yyseparator=","/>]</cite>, noisy text normalization
<cite>[<bibref bibrefs="chrupala2014normalizing" separator="," show="Refnum" yyseparator=","/>]</cite>, dialog state tracking
<cite>[<bibref bibrefs="mrksic2015multidomain" separator="," show="Refnum" yyseparator=","/>]</cite>, response generation <cite>[<bibref bibrefs="sordoni2015neural" separator="," show="Refnum" yyseparator=","/>]</cite>, and
modeling the relation between character sequences and part-of-speech
tags <cite>[<bibref bibrefs="ling2015finding" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S2.p6">
      <p>Recursive models were shown to produce state-of-the-art or near state-of-the-art results for
constituency
<cite>[<bibref bibrefs="socher2013parsing" separator="," show="Refnum" yyseparator=","/>]</cite> and dependency <cite>[<bibref bibrefs="le2014insideoutside,zhu2015reranking" separator="," show="Refnum" yyseparator=","/>]</cite>
parse re-ranking, discourse parsing <cite>[<bibref bibrefs="li2014recursive" separator="," show="Refnum" yyseparator=","/>]</cite>, semantic relation classification
<cite>[<bibref bibrefs="hashimoto2013simple,liu2015dependencybased" separator="," show="Refnum" yyseparator=","/>]</cite>,
political ideology detection based on parse trees <cite>[<bibref bibrefs="iyyer2014political" separator="," show="Refnum" yyseparator=","/>]</cite>,
sentiment classification <cite>[<bibref bibrefs="socher2013recursive,hermann2013role" separator="," show="Refnum" yyseparator=","/>]</cite>,
target-dependent sentiment classification <cite>[<bibref bibrefs="dong2014adaptive" separator="," show="Refnum" yyseparator=","/>]</cite> and
question answering <cite>[<bibref bibrefs="iyyer2014neural" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
    </para>
    <pagination role="newpage"/>
  </section>
  <section refnum="3" xml:id="S3">
    <title><tag close=" ">3</tag>Feature Representation</title>
    <!-- %**** root.tex Line 250 **** -->
    <para xml:id="S3.p1">
      <p>Before discussing the network structure in more depth, it is important to pay
attention to how features are represented.
For now, we can think of a feed-forward neural network as a function <Math mode="inline" xml:id="S3.p1.m1" tex="NN(\mathbf{x})" text="N * N * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok><XMDual><XMRef idref="XM21"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM21" font="bold">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> that
takes as input a <Math mode="inline" xml:id="S3.p1.m2" tex="d_{in}" text="d _ (i * n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> dimensional vector <Math mode="inline" xml:id="S3.p1.m3" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> and produces a <Math mode="inline" xml:id="S3.p1.m4" tex="d_{out}" text="d _ (o * u * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math>
dimensional output vector. The function is often used as a <emph>classifier</emph>,
assigning the input <Math mode="inline" xml:id="S3.p1.m5" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> a degree of membership in one or more of <Math mode="inline" xml:id="S3.p1.m6" tex="d_{out}" text="d _ (o * u * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math>
classes. The function can be complex, and is almost always
non-linear. Common structures of this function will be discussed in Section
<ref labelref="LABEL:sec:ff"/>. Here, we focus on the input, <Math mode="inline" xml:id="S3.p1.m7" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>.
When dealing with natural language, the
input <Math mode="inline" xml:id="S3.p1.m8" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> encodes features such as words, part-of-speech tags or other
linguistic information. Perhaps the biggest jump when
moving from sparse-input linear models to neural-network based models is to stop
representing each feature as a unique dimension (the so called one-hot
representation) and representing them instead as dense vectors. That is,
each core feature is <emph>embedded</emph> into a <Math mode="inline" xml:id="S3.p1.m9" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> dimensional
space, and
represented as a vector in that space.<note mark="1" role="footnote">Different feature types may be embedded into different spaces.
For example, one may represent word features using 100 dimensions, and
part-of-speech features using 20 dimensions.</note>
The embeddings (the vector
representation of each core feature) can then be trained like the other parameter
of the function <Math mode="inline" xml:id="S3.p1.m10" tex="NN" text="N * N"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok></XMApp></XMath></Math>. Figure <ref labelref="LABEL:fig:sparse-vs-dense"/> shows the two approaches
to feature representation.</p>
    </para>
    <!-- %**** root.tex Line 275 **** -->
    <figure frefnum="Figure 1" placement="t" refnum="1" xml:id="S3.F1" labels="LABEL:fig:sparse-vs-dense">
      <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
      <p align="center">[width=0.7]feats.pdf</p>
      <toccaption><tag close=" ">1</tag><text font="bold">Sparse vs. dense feature representations</text>.
Two encodings of the information: <emph>current word is “dog”; previous word is “the”; previous pos-tag is “DET”</emph>.
(a) Sparse feature vector.
Each dimension represents a feature. Feature combinations receive their own
dimensions. Feature values are binary. Dimensionality is very high.
(b) Dense, embeddings-based feature vector. Each core feature is represented as a
vector. Each feature corresponds to several input vector entries. No explicit
encoding of feature combinations. Dimensionality is low. The feature-to-vector
mappings come from an embedding table.</toccaption>
      <caption><tag close=": ">Figure 1</tag><text font="bold">Sparse vs. dense feature representations</text>.
Two encodings of the information: <emph>current word is “dog”; previous word is “the”; previous pos-tag is “DET”</emph>.
(a) Sparse feature vector.
Each dimension represents a feature. Feature combinations receive their own
dimensions. Feature values are binary. Dimensionality is very high.
(b) Dense, embeddings-based feature vector. Each core feature is represented as a
vector. Each feature corresponds to several input vector entries. No explicit
encoding of feature combinations. Dimensionality is low. The feature-to-vector
mappings come from an embedding table.</caption>
    </figure>
    <para xml:id="S3.p2">
      <p>The feature embeddings (the values of the vector entries for each feature) are treated as <emph>model
parameters</emph> that need to be trained together with the other components of the
network. Methods of training (or obtaining) the feature embeddings will be
discussed later. For now, consider the feature embeddings as given.</p>
    </para>
    <para xml:id="S3.p3">
      <p>The general structure for an NLP classification system based on a feed-forward neural network is thus:</p>
      <enumerate xml:id="I1">
        <item frefnum="1." refnum="1" xml:id="I1.i1">
          <tag>1.</tag>
          <para xml:id="I1.i1.p1">
            <p>Extract a set of core linguistic features <Math mode="inline" xml:id="I1.i1.p1.m1" tex="f_{1},\dots,f_{k}" text="list@(f _ 1, dots, f _ k)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM22"/><XMRef idref="XM23"/><XMRef idref="XM24"/></XMApp><XMWrap><XMApp xml:id="XM22"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="dots" role="ID" xml:id="XM23">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM24"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMWrap></XMDual></XMath></Math> that are relevant
for predicting the output class.
<!-- %**** root.tex Line 300 **** --></p>
          </para>
        </item>
        <item frefnum="2." refnum="2" xml:id="I1.i2">
          <tag>2.</tag>
          <para xml:id="I1.i2.p1">
            <p>For each feature <Math mode="inline" xml:id="I1.i2.p1.m1" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> of interest, retrieve the corresponding vector <Math mode="inline" xml:id="I1.i2.p1.m2" tex="v(f_{i})" text="v * f _ i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM25"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM25"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>.</p>
          </para>
        </item>
        <item frefnum="3." refnum="3" xml:id="I1.i3">
          <tag>3.</tag>
          <para xml:id="I1.i3.p1">
            <p>Combine the vectors (either by concatenation, summation or a
combination of both) into an input vector <Math mode="inline" xml:id="I1.i3.p1.m1" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>.</p>
          </para>
        </item>
        <item frefnum="4." refnum="4" xml:id="I1.i4">
          <tag>4.</tag>
          <para xml:id="I1.i4.p1">
            <p>Feed <Math mode="inline" xml:id="I1.i4.p1.m1" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> into a non-linear classifier (feed-forward neural network).</p>
          </para>
        </item>
      </enumerate>
    </para>
    <para xml:id="S3.p4">
      <p>The biggest change in the input, then, is the move from sparse representations in which each
feature is its own dimension, to a dense representation in which each feature
is mapped to a vector. Another difference is that we extract only <emph>core
features</emph> and not feature combinations. We will elaborate on both these changes
briefly.</p>
    </para>
    <paragraph xml:id="S3.SS0.SSS0.Px1">
      <title>Dense Vectors vs. One-hot Representations</title>
      <para xml:id="S3.SS0.SSS0.Px1.p1">
        <p>What are the benefits of representing our features as vectors instead of as
unique IDs? Should we always represent features as dense vectors?
Let’s consider the two kinds of representations:</p>
        <description xml:id="I2">
          <item refnum="One Hot" xml:id="I2.ix1">
            <tag>
              <text font="bold">One Hot</text>
            </tag>
            <para xml:id="I2.ix1.p1">
              <p>Each feature is its own dimension.</p>
              <itemize xml:id="I2.I1">
                <item xml:id="I2.I1.i1">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I2.I1.i1.p1">
                    <p>Dimensionality of one-hot vector is same as number of distinct
features.</p>
                  </para>
                </item>
                <item xml:id="I2.I1.i2">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I2.I1.i2.p1">
                    <p>Features are completely independent from one another. The
feature “word is ‘dog’ ” is as dis-similar to “word is
‘thinking’ ”
<!-- %**** root.tex Line 325 **** -->than it is to “word is ‘cat’ ”.</p>
                  </para>
                </item>
              </itemize>
            </para>
          </item>
          <item refnum="Dense" xml:id="I2.ix2">
            <tag>
              <text font="bold">Dense</text>
            </tag>
            <para xml:id="I2.ix2.p1">
              <p>Each feature is a <Math mode="inline" xml:id="I2.ix2.p1.m1" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector.</p>
              <itemize xml:id="I2.I2">
                <item xml:id="I2.I2.i1">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I2.I2.i1.p1">
                    <p>Dimensionality of vector is <Math mode="inline" xml:id="I2.I2.i1.p1.m1" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>.</p>
                  </para>
                </item>
                <item xml:id="I2.I2.i2">
                  <tag>
                    <text font="bold">–</text>
                  </tag>
                  <para xml:id="I2.I2.i2.p1">
                    <p>Similar features will have similar vectors –
information is shared between similar features.</p>
                  </para>
                </item>
              </itemize>
            </para>
          </item>
        </description>
      </para>
      <para xml:id="S3.SS0.SSS0.Px1.p2">
        <p>One benefit of using dense and low-dimensional vectors is computational: the
majority of neural network toolkits do not play well with
very high-dimensional, sparse vectors. However, this is just a technical
obstacle, which can be resolved with some engineering effort.</p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px1.p3">
        <p>The main benefit of the dense representations is in generalization power: if we
believe some features may provide similar clues, it is worthwhile to provide a
representation that is able to capture these similarities.
For example, assume we have observed the word ‘dog’ many times during
training, but only observed the word ‘cat’ a handful of times, or not at all.
If each of the words is associated with its own dimension, occurrences of
‘dog’ will not tell us anything about the occurrences of ‘cat’. However, in
the dense vectors representation the learned vector for ‘dog’ may be similar
to the learned vector from ‘cat’, allowing the model to share statistical
strength between the two events. This argument assumes that “good” vectors are
<!-- %**** root.tex Line 350 **** -->somehow given to us. Section <ref labelref="LABEL:sec:word-embed"/> describes ways of
obtaining such vector representations.</p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px1.p4">
        <p>In cases where we have relatively few distinct features in the category, and we
believe there are no correlations between the different features, we may use the
one-hot representation. However, if we believe there are going to be correlations
between the different features in the group (for example, for part-of-speech
tags, we may believe that the different verb inflections <text font="typewriter">VB</text> and
<text font="typewriter">VBZ</text> may
behave similarly as far as our task is concerned) it may be worthwhile to let
the network figure out the correlations and gain some statistical strength by
sharing the parameters.
It may be the case that under some circumstances, when
the feature space is relatively small and the training data is plentiful, or
when we do not wish to share statistical information between distinct words, there
are gains to be made from using the one-hot representations. However, this is
still an open research question, and there are no strong evidence to either side.
The majority of work (pioneered by
<cite>[<bibref bibrefs="collobert2008unified,collobert2011natural,chen2014fast" separator="," show="Refnum" yyseparator=","/>]</cite>)
advocate the use of dense, trainable embedding vectors for all features.
For work using neural network architecture with sparse vector encodings see
<cite>[<bibref bibrefs="johnson2015effective" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px1.p5">
        <p>Finally, it is important to note that representing features as dense vectors
is an integral part of the neural network framework, and that consequentially
<!-- %**** root.tex Line 375 **** -->the differences between using sparse and dense feature representations are
subtler than they may appear at first. In fact, using sparse, one-hot vectors
as input when training a neural network amounts to dedicating the first layer
of the network to learning a dense embedding vector for each feature
based on the training data. We touch on this in Section <ref labelref="LABEL:sec:embed-layer"/>.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px2">
      <title>Variable Number of Features: Continuous Bag of Words</title>
      <para xml:id="S3.SS0.SSS0.Px2.p1">
        <p>Feed-forward networks assume a fixed dimensional input.
This can easily accommodate the case of a feature-extraction function that extracts a fixed
number of features: each feature is represented as a vector, and the vectors are
concatenated. This way, each region of the resulting input vector corresponds to a
different feature. However, in some cases the number of features is not known in
advance (for example, in document classification it is common that each word in
the sentence is a feature).
We thus need to represent an unbounded number of features using a fixed size
vector.
One way of achieving this is through a so-called <emph>continuous bag of words</emph>
(CBOW) representation <cite>[<bibref bibrefs="mikolov2013efficient" separator="," show="Refnum" yyseparator=","/>]</cite>. The CBOW is very similar to the traditional bag-of-words
representation in which we discard order information, and works by either summing or
averaging the
embedding vectors of the corresponding features:<note mark="2" role="footnote"><!-- %**** root.tex Line 400 **** -->Note that if the
<Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p1.m1" tex="v(f_{i})" text="v * f _ i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM26"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM26"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>s were one-hot vectors rather than dense feature representations, the
<Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p1.m2" tex="CBOW" text="C * B * O * W"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p1.m3" tex="WCBOW" text="W * C * B * O * W"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMTok role="UNKNOWN" font="italic">B</XMTok><XMTok role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">W</XMTok></XMApp></XMath></Math> equations above would reduce to the traditional (weighted) bag-of-words
representations, which is in turn equivalent to a sparse feature-vector
representation in which
each binary indicator feature corresponds to a unique “word”.</note></p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px2.p2">
        <equation xml:id="S3.Ex1">
          <Math mode="display" xml:id="S3.Ex1.m1" tex="CBOW(f_{1},...,f_{k})=\frac{1}{k}\sum_{i=1}^{k}v(f_{i})" text="C * B * O * W * vector@(f _ 1, ldots, f _ k) = (1 / k) * ((sum _ (i = 1)) ^ k)@(v * f _ i)">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">C</XMTok>
                  <XMTok role="UNKNOWN" font="italic">B</XMTok>
                  <XMTok role="UNKNOWN" font="italic">O</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">W</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM27"/>
                      <XMRef idref="XM28"/>
                      <XMRef idref="XM29"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM27">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="XM28">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM29">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                      <XMDual>
                        <XMRef idref="XM30"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM30">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS0.SSS0.Px2.p3">
        <p>A simple variation on the CBOW representation is weighted CBOW, in which different vectors receive different weights:</p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px2.p4">
        <equation xml:id="S3.Ex2">
          <Math mode="display" xml:id="S3.Ex2.m1" tex="WCBOW(f_{1},...,f_{k})=\frac{1}{\sum_{i=1}^{k}a_{i}}\sum_{i=1}^{k}a_{i}v(f_{i})" text="W * C * B * O * W * vector@(f _ 1, ldots, f _ k) = (1 / ((sum _ (i = 1)) ^ k)@(a _ i)) * ((sum _ (i = 1)) ^ k)@(a _ i * v * f _ i)">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">W</XMTok>
                  <XMTok role="UNKNOWN" font="italic">C</XMTok>
                  <XMTok role="UNKNOWN" font="italic">B</XMTok>
                  <XMTok role="UNKNOWN" font="italic">O</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">W</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM31"/>
                      <XMRef idref="XM32"/>
                      <XMRef idref="XM33"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM31">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="XM32">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM33">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">a</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">a</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      </XMApp>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                      <XMDual>
                        <XMRef idref="XM34"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM34">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS0.SSS0.Px2.p5">
        <p>Here, each feature <Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p5.m1" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> has an associated weight <Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p5.m2" tex="a_{i}" text="a _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>, indicating the relative
importance of the feature. For example, in a document classification task, a
feature <Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p5.m3" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> may correspond to a word in the document, and the associated
weight <Math mode="inline" xml:id="S3.SS0.SSS0.Px2.p5.m4" tex="a_{i}" text="a _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> could be the word’s TF-IDF score.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px3">
      <title>Distance and Position Features</title>
      <para xml:id="S3.SS0.SSS0.Px3.p1">
        <p>The linear distance in between two words in a
sentence may serve as an informative feature. For example, in an event
extraction task<note mark="3" role="footnote">The event extraction task involves identification of
events from a predefined set of event types. For example identification of
“purchase” events or “terror-attack” events. Each event type can be
triggered by various triggering words (commonly verbs), and has several slots
(arguments)
that needs to be filled (i.e. who purchased? what was purchased? at what
amount?).</note>
we may be given a trigger word and a candidate argument word, and asked to
predict if the argument word is indeed an argument of the trigger. The distance (or relative position)
between the trigger and the argument is a strong signal for this prediction task. In the
<!-- %**** root.tex Line 425 **** -->“traditional” NLP setup, distances are usually encoded by binning the
distances into several groups (i.e. 1, 2, 3, 4, 5–10, 10+) and associating each bin
with a one-hot vector. In a neural architecture, where the input vector is not composed of binary indicator features, it may seem natural to allocate a single
input vector entry to the distance feature, where the numeric value of that entry is the distance. However,
this approach is not taken in practice. Instead,
distance features are encoded
similarly to the other feature types: each bin is associated with a
<Math mode="inline" xml:id="S3.SS0.SSS0.Px3.p1.m1" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector, and these distance-embedding vectors are then trained as
regular parameters in the
network <cite>[<bibref bibrefs="zeng2014relation,dossantos2015classifying,zhu2015reranking,nguyen2015event" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px4">
      <title>Feature Combinations</title>
      <para xml:id="S3.SS0.SSS0.Px4.p1">
        <p>Note that the feature extraction stage in the
neural-network settings deals only with extraction of <emph>core</emph> features.
This is in contrast to the traditional linear-model-based NLP systems in which the
feature designer had to manually specify not only the core features of interests but
also interactions between them (e.g., introducing not only a feature stating
“word is X” and a feature
stating “tag is Y” but also combined feature stating “word is X and tag is Y” or
sometimes even “word is X, tag is Y and previous word is Z”). The combination
features are crucial in linear models because they introduce more
dimensions to the input, transforming it into a space where the data-points are
closer to being linearly separable. On the other hand, the space of possible
combinations is very large, and the feature designer has to spend a lot of time
coming up with an effective set of feature combinations.
<!-- %**** root.tex Line 450 **** -->One of the
promises of the non-linear neural network models is that one needs to define
only the core features. The non-linearity of the classifier, as defined by the
network structure, is expected to take care of finding the indicative feature
combinations, alleviating the need for feature combination engineering.</p>
      </para>
      <para xml:id="S3.SS0.SSS0.Px4.p2">
        <p>Kernel methods <cite>[<bibref bibrefs="shawe-taylor2004kernel" separator="," show="Refnum" yyseparator=","/>]</cite>, and in particular polynomial
kernels <cite>[<bibref bibrefs="kudo2003fast" separator="," show="Refnum" yyseparator=","/>]</cite>, also allow the
feature designer to specify only core features, leaving the feature combination
aspect to the learning algorithm. In contrast to neural-network models, kernels
methods are convex, admitting exact solutions to the optimization problem.
However, the classification efficiency in kernel methods scales linearly with the size
of the training data, making them too slow for most practical purposes, and not
suitable for training with large datasets.
On the other hand, neural network
classification efficiency scales linearly with the size of the network,
regardless of the training data size.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px5">
      <title>Dimensionality</title>
      <para xml:id="S3.SS0.SSS0.Px5.p1">
        <p>How many dimensions should we allocate for each
feature? Unfortunately, there are no theoretical bounds or even established best-practices
in this space.
Clearly, the dimensionality should grow with the number of the members in the class
(you probably want to assign more dimensions to word embeddings than to
part-of-speech embeddings) but how much is enough? In current research, the
<!-- %**** root.tex Line 475 **** -->dimensionality of word-embedding vectors range between about 50 to a few hundreds,
and, in some extreme cases, thousands. Since the dimensionality of the vectors
has a direct effect on memory requirements and processing time, a good rule of
thumb would be to experiment with a few different sizes, and choose a good
trade-off between speed and task accuracy.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px6">
      <title>Vector Sharing</title>
      <para xml:id="S3.SS0.SSS0.Px6.p1">
        <p>Consider a case where you have a few features that
share the same vocabulary. For example, when assigning a part-of-speech to a
given word, we may have a set of features considering the
previous word, and a set of features considering the next word. When building
the input to the classifier, we will concatenate the vector representation of
the previous word to the vector representation of the next word. The classifier
will then be able to distinguish the two different indicators, and treat them
differently. But should the two features share the same vectors? Should the
vector for “dog:previous-word” be the same as the vector of “dog:next-word”?
Or should we assign them two distinct vectors?
This, again, is mostly an empirical question. If you believe words behave
differently when they appear in different positions (e.g., word X behaves like
word Y when in the previous position, but X behaves like Z when in the next
position) then it may be a good idea to use two different vocabularies and
assign a different set of vectors for each feature type. However, if you believe
the words behave similarly in both locations, then something may be gained by
using a shared vocabulary for both feature types.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px7">
      <title>Network’s Output</title>
      <para xml:id="S3.SS0.SSS0.Px7.p1">
        <p>For multi-class classification problems with <Math mode="inline" xml:id="S3.SS0.SSS0.Px7.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>
<!-- %**** root.tex Line 500 **** -->classes, the
network’s output is a <Math mode="inline" xml:id="S3.SS0.SSS0.Px7.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-dimensional vector in which every dimension represents
the strength of a particular output class. That is, the output remains as in the
traditional linear models – scalar scores to items in a discrete set. However,
as we will see in Section
<ref labelref="LABEL:sec:ff"/>, there is a <Math mode="inline" xml:id="S3.SS0.SSS0.Px7.p1.m3" tex="d\times k" text="d * k"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMath></Math> matrix associated with the
output layer. The columns of this matrix can be thought of as <Math mode="inline" xml:id="S3.SS0.SSS0.Px7.p1.m4" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> dimensional
embeddings of the output classes. The vector similarities between the vector
representations of the <Math mode="inline" xml:id="S3.SS0.SSS0.Px7.p1.m5" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> classes indicate the model’s learned similarities between the
output classes.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S3.SS0.SSS0.Px8">
      <title>Historical Note</title>
      <para xml:id="S3.SS0.SSS0.Px8.p1">
        <p>Representing words as dense vectors for input to a
neural network was introduced by Bengio et al <cite>[<bibref bibrefs="bengio2003neural" separator="," show="Refnum" yyseparator=","/>]</cite> in the
context of neural language modeling. It was introduced to NLP tasks in the
pioneering work of Collobert, Weston and colleagues
<ERROR class="undefined">\citeyear</ERROR>collobert2008unified,collobert2011natural. Using embeddings for
representing not only words but arbitrary features was popularized following Chen and Manning <ERROR class="undefined">\citeyear</ERROR>chen2014fast.</p>
      </para>
      <pagination role="newpage"/>
    </paragraph>
  </section>
  <section refnum="4" xml:id="S4" labels="LABEL:sec:ff">
    <title><tag close=" ">4</tag>Feed-forward Neural Networks</title>
    <paragraph xml:id="S4.SS0.SSS0.Px1">
      <title>A Brain-inspired metaphor</title>
      <para xml:id="S4.SS0.SSS0.Px1.p1">
        <p>As the name suggest, neural-networks are
inspired by the brain’s computation mechanism, which consists of computation
<!-- %**** root.tex Line 525 **** -->units called neurons. In the metaphor, a neuron is a computational unit that has
scalar inputs and outputs. Each input has an associated weight. The neuron
multiplies each input by its weight, and then sums<note mark="4" role="footnote">While summing is the
most common operation, other functions, such as a max, are also possible</note> them,
applies a non-linear function to the result, and passes it to its output.
The neurons are connected to each other, forming a network: the output of a
neuron may feed into the inputs of one or more neurons. Such networks were shown to
be very capable computational devices. If the weights are set correctly, a neural network
with enough neurons and a non-linear activation function can approximate a very wide range of mathematical functions (we will be more precise
about this later).</p>
      </para>
      <figure frefnum="Figure 2" placement="h!" refnum="2" xml:id="S4.F2" labels="LABEL:fig:nn1">
        <ERROR class="undefined ltx_centering">{neuralnetwork}</ERROR>
        <p align="center">[height=4,style=rotate=90,layertitleheight=5.5em,toprow=true]




<ERROR class="undefined">\inputlayer</ERROR>[count=4, bias=false, title=Input layer, text=<Math mode="inline" xml:id="S4.F2.m1" tex="x_{\hiddenlayer}" text="x _ [\hiddenlayer]"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">x</XMTok><ERROR class="undefined">\hiddenlayer</ERROR></XMApp></XMath></Math>[count=6, bias=false, title=Hidden layer, text=<Math mode="inline" xml:id="S4.F2.m2" tex="\int" text="integral"><XMath><XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok></XMath></Math><ERROR class="undefined">\hiddenlayer</ERROR>[count=5, bias=false, title=Hidden layer, text=<Math mode="inline" xml:id="S4.F2.m3" tex="\int" text="integral"><XMath><XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok></XMath></Math><ERROR class="undefined">\outputlayer</ERROR>[count=3, title=Output layer, text=<Math mode="inline" xml:id="S4.F2.m4" tex="y_{\linklayers}" text="y _ [\linklayers]"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">y</XMTok><ERROR class="undefined">\linklayers</ERROR></XMApp></XMath></Math></p>
        <toccaption><tag close=" ">2</tag>Feed-forward neural network with two hidden layers.</toccaption>
        <caption><tag close=": ">Figure 2</tag>Feed-forward neural network with two hidden layers.</caption>
        <!-- %**** root.tex Line 550 **** -->
      </figure>
      <para xml:id="S4.SS0.SSS0.Px1.p2">
        <p>A typical feed-forward neural network may be drawn as in Figure <ref labelref="LABEL:fig:nn1"/>.
Each circle is a neuron, with incoming arrows being the neuron’s inputs and
outgoing arrows being the neuron’s outputs. Each arrow carries a weight,
reflecting its importance (not shown).
Neurons are arranged in layers,
reflecting the flow of information. The bottom layer has no incoming arrows,
and is the input to the network. The top-most layer has no outgoing arrows, and
is the output of the network. The other layers are considered “hidden”.
The sigmoid shape inside the neurons in the
middle layers represent a non-linear function (typically a <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p2.m1" tex="1/(1+e^{-x}"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok mathstyle="inline" meaning="divide" role="MULOP">/</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">e</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp></XMWrap></XMath></Math>)) that
is applied to the neuron’s value before passing it to the output.
In the figure, each neuron is connected to all of the neurons in the next layer
– this is called a <emph>fully-connected layer</emph> or an <emph>affine layer</emph>.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px1.p3">
        <p>While the brain metaphor is sexy and
intriguing, it is also distracting and cumbersome to manipulate mathematically.
We therefore switch to using more concise mathematic notation.
The values of each row of neurons in the network can be thought of as a vector. In Figure
<ref labelref="LABEL:fig:nn1"/> the input layer is a <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m1" tex="4" text="4"><XMath><XMTok meaning="4" role="NUMBER">4</XMTok></XMath></Math> dimensional vector (<Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m2" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>), and the
layer above it is a <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m3" tex="6" text="6"><XMath><XMTok meaning="6" role="NUMBER">6</XMTok></XMath></Math> dimensional vector (<Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m4" tex="\mathbf{h^{1}}" text="h ^ 1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMath></Math>).
The fully connected layer can be
thought of as a linear transformation from <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m5" tex="4" text="4"><XMath><XMTok meaning="4" role="NUMBER">4</XMTok></XMath></Math> dimensions to <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m6" tex="6" text="6"><XMath><XMTok meaning="6" role="NUMBER">6</XMTok></XMath></Math> dimensions.
<!-- %**** root.tex Line 575 **** -->A fully-connected layer implements a vector-matrix multiplication, <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m7" tex="\mathbf{h}=\mathbf{x}\mathbf{W}" text="h = xW"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">xW</XMTok></XMApp></XMath></Math> where
the weight of the connection from the <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m8" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th neuron in the input row to the <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m9" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math>th
neuron in the output row is <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m10" tex="W_{ij}" text="W _ (i * j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">W</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>.<note mark="5" role="footnote">To see why this is the case,
denote the weight of the <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m11" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th input of the <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m12" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math>th neuron in <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m13" tex="\mathbf{h}" text="h"><XMath><XMTok role="UNKNOWN" font="bold">h</XMTok></XMath></Math> as <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m14" tex="w_{ij}" text="w _ (i * j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>.
The value of <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m15" tex="h_{j}" text="h _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMath></Math> is then <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m16" tex="h_{j}=\sum_{i=1}^{4}x_{i}\cdot w_{ij}" text="h _ j = ((sum _ (i = 1)) ^ 4)@(x _ i cdot w _ (i * j))"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok meaning="4" role="NUMBER">4</XMTok></XMApp><XMApp><XMTok name="cdot" role="MULOP">⋅</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">w</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math>.</note> The values of
<Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m17" tex="\mathbf{h}" text="h"><XMath><XMTok role="UNKNOWN" font="bold">h</XMTok></XMath></Math> are then transformed by a non-linear function <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m18" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> that is applied to
each value before being passed on to the next input. The whole computation from
input to output can be written as: <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m19" tex="(g(\mathbf{x}\mathbf{W^{1}}))\mathbf{W^{2}}" text="g * xW ^ 1 * W ^ 2"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMDual><XMRef idref="XM36"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM36"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="XM35"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM35"><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">xW</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMApp></XMath></Math> where <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m20" tex="\mathbf{W^{1}}" text="W ^ 1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMath></Math>
are the weights of the first layer and <Math mode="inline" xml:id="S4.SS0.SSS0.Px1.p3.m21" tex="\mathbf{W^{2}}" text="W ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMath></Math> are the weights of the second
one.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S4.SS0.SSS0.Px2">
      <title>In Mathematical Notation</title>
      <para xml:id="S4.SS0.SSS0.Px2.p1">
        <p>From this point on, we will abandon the brain metaphor and describe networks exclusively
in terms of vector-matrix operations.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p2" class="ltx_noindent">
        <p>The simplest neural network is the perceptron, which is a linear function of its inputs:</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p3">
        <equation xml:id="S4.Ex3">
          <Math mode="display" xml:id="S4.Ex3.m1" tex="NN_{Perceptron}(\mathbf{x})=\mathbf{x}\mathbf{W}+\mathbf{b}" text="N * N _ (P * e * r * c * e * p * t * r * o * n) * x = xW + b">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">N</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                      <XMTok role="UNKNOWN" font="italic">n</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="XM37"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM37" font="bold">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                  <XMTok role="UNKNOWN" font="bold">b</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S4.Ex4">
          <Math mode="display" xml:id="S4.Ex4.m1" tex="\mathbf{x}\in\mathbb{R}^{d_{in}},\;\;\mathbf{W}\in\mathbb{R}^{d_{in}\times d_{%&#10;out}},\;\;\mathbf{b}\in\mathbb{R}^{d_{out}}" text="formulae@(x element-of R ^ (d _ (i * n)), formulae@(W element-of R ^ (d _ (i * n) * d _ (o * u * t)), b element-of R ^ (d _ (o * u * t))))">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM40"/>
                  <XMRef idref="XM41"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM40">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">n</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                  <XMDual xml:id="XM41">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM38"/>
                      <XMRef idref="XM39"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM38">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">×</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                      <XMApp xml:id="XM39">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">u</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p4" class="ltx_noindent">
        <p><Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p4.m1" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math> is the weight matrix, and <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p4.m2" tex="\mathbf{b}" text="b"><XMath><XMTok role="UNKNOWN" font="bold">b</XMTok></XMath></Math> is a bias term.<note mark="6" role="footnote"><!-- %**** root.tex Line 600 **** -->The
network in figure <ref labelref="LABEL:fig:nn1"/> does not include bias terms. A bias term can be
added to a layer by adding to it an additional neuron that does not have any incoming connections,
whose value is always <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p4.m3" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>.</note>
In order to go beyond linear functions, we introduce a non-linear hidden layer (the network in Figure <ref labelref="LABEL:fig:nn1"/> has two such layers),
resulting in the 1-layer Multi Layer Perceptron (MLP1).
A one-layer feed-forward neural network has the form:</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p5">
        <equation xml:id="S4.Ex5">
          <Math mode="display" xml:id="S4.Ex5.m1" tex="NN_{MLP1}(\mathbf{x})=g(\mathbf{x}\mathbf{W^{1}}+\mathbf{b^{1}})\mathbf{W^{2}}%&#10;+\mathbf{b^{2}}" text="N * N _ (M * L * P * 1) * x = g * (xW ^ 1 + b ^ 1) * W ^ 2 + b ^ 2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">N</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      <XMTok role="UNKNOWN" font="italic">L</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="XM42"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM42" font="bold">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" font="italic">g</XMTok>
                    <XMDual>
                      <XMRef idref="XM43"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="XM43">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="bold">b</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="bold">W</XMTok>
                      <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                    <XMTok role="UNKNOWN" font="bold">b</XMTok>
                    <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S4.Ex6">
          <Math mode="display" xml:id="S4.Ex6.m1" tex="\mathbf{x}\in\mathbb{R}^{d_{in}},\;\;\mathbf{W^{1}}\in\mathbb{R}^{d_{in}\times&#10;d%&#10;_{1}},\;\;\mathbf{b^{1}}\in\mathbb{R}^{d_{1}},\;\;\mathbf{W^{2}}\in\mathbb{R}^%&#10;{d_{1}\times d_{2}},\;\;\mathbf{b^{2}}\in\mathbb{R}^{d_{2}}" text="formulae@(x element-of R ^ (d _ (i * n)), formulae@(W ^ 1 element-of R ^ (d _ (i * n) * d _ 1), formulae@(b ^ 1 element-of R ^ (d _ 1), formulae@(W ^ 2 element-of R ^ (d _ 1 * d _ 2), b ^ 2 element-of R ^ (d _ 2)))))">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM50"/>
                  <XMRef idref="XM51"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM50">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">n</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                  <XMDual xml:id="XM51">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM48"/>
                      <XMRef idref="XM49"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM48">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">×</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                      <XMDual xml:id="XM49">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM46"/>
                          <XMRef idref="XM47"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM46">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="bold">b</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                          <XMDual xml:id="XM47">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="XM44"/>
                              <XMRef idref="XM45"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="XM44">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                              <XMApp xml:id="XM45">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                  <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p6">
        <p>Here <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p6.m1" tex="\mathbf{W^{1}}" text="W ^ 1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p6.m2" tex="\mathbf{b^{1}}" text="b ^ 1"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMath></Math> are a matrix and a bias term for the first linear
transformation of the input, <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p6.m3" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> is a non-linear function that is applied element-wise
(also called a <emph>non-linearity</emph> or an <emph>activation function</emph>), and
<Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p6.m4" tex="\mathbf{W^{2}}" text="W ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p6.m5" tex="\mathbf{b^{2}}" text="b ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMath></Math> are the matrix and bias term for a second linear transform.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p7">
        <p>Breaking it down, <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m1" tex="\mathbf{x}\mathbf{W^{1}}+\mathbf{b^{1}}" text="xW ^ 1 + b ^ 1"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">xW</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math> is a linear transformation of the input <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m2" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>
from <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m3" tex="d_{in}" text="d _ (i * n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> dimensions to <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m4" tex="d_{1}" text="d _ 1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> dimensions. <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m5" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> is then applied to each of the
<Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m6" tex="d_{1}" text="d _ 1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> dimensions, and the matrix <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m7" tex="\mathbf{W^{2}}" text="W ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp></XMath></Math> together with bias vector <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m8" tex="\mathbf{b}^{2}" text="b ^ 2"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> are then
used to transform the result into the <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m9" tex="d_{2}" text="d _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> dimensional output vector.
The non-linear activation function <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m10" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> has a crucial role in the network’s
ability to represent complex functions. Without the non-linearity in <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p7.m11" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math>, the
neural network can only represent linear transformations of the
<!-- %**** root.tex Line 625 **** -->input.<note mark="7" role="footnote">To see why, consider that a sequence of linear transformations
is still a linear transformation.</note></p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p8">
        <p>We can add additional linear-transformations and non-linearities, resulting in a
2-layer MLP (the network in Figure <ref labelref="LABEL:fig:nn1"/> is of this form):</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p9">
        <equation xml:id="S4.Ex7">
          <Math mode="display" xml:id="S4.Ex7.m1" tex="NN_{MLP2}(\mathbf{x})=(g^{2}(g^{1}(\mathbf{x}\mathbf{W^{1}}+\mathbf{b^{1}})%&#10;\mathbf{W^{2}}+\mathbf{b^{2}}))\mathbf{W^{3}}" text="N * N _ (M * L * P * 2) * x = g ^ 2 * (g ^ 1 * (xW ^ 1 + b ^ 1) * W ^ 2 + b ^ 2) * W ^ 3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">N</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">M</XMTok>
                      <XMTok role="UNKNOWN" font="italic">L</XMTok>
                      <XMTok role="UNKNOWN" font="italic">P</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="XM52"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM52" font="bold">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMDual>
                    <XMRef idref="XM59"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM59">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM58"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM58">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="XM57"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM57">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                        <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                    <XMTok role="UNKNOWN" font="bold">W</XMTok>
                    <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p10" class="ltx_noindent">
        <p>It is perhaps clearer to write deeper networks like this using intermediary
variables:</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p11">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx1">
          <equation xml:id="S4.Ex8">
            <MathFork>
              <Math xml:id="S4.Ex8.m3" tex="\displaystyle NN_{MLP2}(\mathbf{x})=\mathbf{y}" text="N * N _ (M * L * P * 2) * x = y">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM60"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM60" font="bold">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="UNKNOWN" font="bold">y</XMTok>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle NN_{MLP2}(\mathbf{x})=" xml:id="S4.Ex8.m1" text="N * N _ (M * L * P * 2) * x = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">P</XMTok>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM61"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM61" font="bold">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{y}" xml:id="S4.Ex8.m2" text="y">
                    <XMath>
                      <XMTok role="UNKNOWN" font="bold">y</XMTok>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex9">
            <MathFork>
              <Math xml:id="S4.Ex9.m3" tex="\displaystyle\mathbf{h^{1}}=g^{1}(\mathbf{x}\mathbf{W^{1}}+\mathbf{b^{1}})" text="h ^ 1 = g ^ 1 * (xW ^ 1 + b ^ 1)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">h</XMTok>
                      <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">g</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM62"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM62">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">b</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{h^{1}}=" xml:id="S4.Ex9.m1" text="h ^ 1 = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle g^{1}(\mathbf{x}\mathbf{W^{1}}+\mathbf{b^{1}})" xml:id="S4.Ex9.m2" text="g ^ 1 * (xW ^ 1 + b ^ 1)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM63"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM63">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                                <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex10">
            <MathFork>
              <Math xml:id="S4.Ex10.m3" tex="\displaystyle\mathbf{h^{2}}=g^{2}(\mathbf{h^{1}}\mathbf{W^{2}}+\mathbf{b^{2}})" text="h ^ 2 = g ^ 2 * (h ^ 1 * W ^ 2 + b ^ 2)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">h</XMTok>
                      <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">g</XMTok>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM64"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM64">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">b</XMTok>
                              <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{h^{2}}=" xml:id="S4.Ex10.m1" text="h ^ 2 = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle g^{2}(\mathbf{h^{1}}\mathbf{W^{2}}+\mathbf{b^{2}})" xml:id="S4.Ex10.m2" text="g ^ 2 * (h ^ 1 * W ^ 2 + b ^ 2)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM65"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM65">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex11">
            <MathFork>
              <Math xml:id="S4.Ex11.m3" tex="\displaystyle\mathbf{y}=\mathbf{h^{2}}\mathbf{W^{3}}" text="y = h ^ 2 * W ^ 3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">y</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">h</XMTok>
                        <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                        <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{y}=" xml:id="S4.Ex11.m1" text="y = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">y</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{h^{2}}\mathbf{W^{3}}" xml:id="S4.Ex11.m2" text="h ^ 2 * W ^ 3">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p12">
        <p>The vector resulting from each linear transform is referred to as a <emph>layer</emph>.
The outer-most linear transform results in the <emph>output layer</emph> and the other
linear transforms result in <emph>hidden layers</emph>. Each hidden layer is followed
by a non-linear activation.
In some cases, such as in the last layer of our example,
the bias vectors are forced to 0 (“dropped”).</p>
      </para>
      <!-- %**** root.tex Line 650 **** -->
      <para xml:id="S4.SS0.SSS0.Px2.p13">
        <p>Layers resulting from linear transformations are often referred to as <emph>fully
connected</emph>, or <emph>affine</emph>.
Other types of architectures exist.
In particular, image
recognition problems benefit from <emph>convolutional</emph> and <emph>pooling</emph> layers.
Such layers have uses also in language processing, and will be discussed in
Section <ref labelref="LABEL:sec:convnet"/>. Networks with more than one hidden layer are said to
be <emph>deep</emph> networks, hence the name <emph>deep learning</emph>.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p14">
        <p>When describing a neural network, one should specify the <emph>dimensions</emph> of
the layers and the input. A layer will expect a <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m1" tex="d_{in}" text="d _ (i * n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> dimensional vector as
its input, and transform it into a <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m2" tex="d_{out}" text="d _ (o * u * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math> dimensional vector. The
dimensionality of the layer is taken to be the dimensionality of its output.
For a fully connected layer <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m3" tex="l(\mathbf{x})=\mathbf{x}\mathbf{W}+\mathbf{b}" text="l * x = xW + b"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">l</XMTok><XMDual><XMRef idref="XM66"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM66" font="bold">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">xW</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp></XMApp></XMath></Math> with input
dimensionality <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m4" tex="d_{in}" text="d _ (i * n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> and output dimensionality <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m5" tex="d_{out}" text="d _ (o * u * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math>, the dimensions of
<Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m6" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> is <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m7" tex="1\times d_{in}" text="1 * d _ (i * n)"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMApp></XMath></Math>, of <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m8" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math> is <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m9" tex="d_{in}\times d_{out}" text="d _ (i * n) * d _ (o * u * t)"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMApp></XMath></Math> and of <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m10" tex="\mathbf{b}" text="b"><XMath><XMTok role="UNKNOWN" font="bold">b</XMTok></XMath></Math>
is <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p14.m11" tex="1\times d_{out}" text="1 * d _ (o * u * t)"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMApp></XMath></Math>.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p15">
        <p>The output of the network is a <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p15.m1" tex="d_{out}" text="d _ (o * u * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math> dimensional vector. In case <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p15.m2" tex="d_{out}=1" text="d _ (o * u * t) = 1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>, the network’s output is a scalar. Such networks can be used for regression
(or scoring)
by considering the value of the output, or for binary
classification by consulting the sign of the output. Networks with <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p15.m3" tex="d_{out}=k&gt;1" text="d _ (o * u * t) = k &gt; 1"><XMath><XMApp><XMTok meaning="multirelation"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="greater-than" role="RELOP">&gt;</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> can be used for <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p15.m4" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-class classification, by associating each dimension
<!-- %**** root.tex Line 675 **** -->with a class, and looking for the dimension with maximal value. Similarly, if
the output vector entries are positive and sum to one, the output can be
interpreted as a distribution over class assignments (such output
normalization is typically achieved by applying a softmax transformation on
the output layer, see Section <ref labelref="LABEL:sec:softmax"/>).</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p16">
        <p>The matrices and the bias terms that define the linear transformations are the
<emph>parameters</emph> of the network. It is common to refer to the collection of all
parameters as <Math mode="inline" xml:id="S4.SS0.SSS0.Px2.p16.m1" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>. Together with the input, the parameters
determine the network’s output. The training algorithm is responsible for
setting their values such that the network’s predictions are correct.
Training is discussed in Section <ref labelref="LABEL:sec:training"/>.</p>
      </para>
    </paragraph>
    <subsection refnum="4.1" xml:id="S4.SS1">
      <title><tag close=" ">4.1</tag>Representation Power</title>
      <para xml:id="S4.SS1.p1">
        <p>In terms of representation power, it was shown
by <cite>[<bibref bibrefs="hornik1989multilayer,cybenko1989approximation" separator="," show="Refnum" yyseparator=","/>]</cite> that MLP1 is a universal
approximator – it can approximate with any desired non-zero amount of error a
family of functions<note mark="8" role="footnote">Specifically, a feed-forward network with linear
output layer and at least one hidden layer with a “squashing” activation function
can approximate any Borel measurable function from one finite dimensional space to another.</note>
that include all continuous functions on a closed and bounded
subset of <Math mode="inline" xml:id="S4.SS1.p1.m1" tex="\mathbb{R}^{n}" text="R ^ n"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMath></Math>, and any function mapping from any finite dimensional
<!-- %**** root.tex Line 700 **** -->discrete space to another. This may suggest there is no reason to go
beyond MLP1 to more complex architectures. However, the theoretical result does not state
how large the hidden layer should be, nor does it say anything about the
learnability of the neural network (it states that a representation exists, but
does not say how easy or hard it is to set the parameters based on training data
and a specific learning algorithm). It also does not guarantee that a
training algorithm will find the <emph>correct</emph> function generating our training data.
Since in practice we train neural networks on relatively small amounts of data,
using a combination of the backpropagation algorithm and variants of stochastic gradient descent,
and use hidden layers of relatively modest sizes (up to several thousands), there is
benefit to be had in trying out more complex architectures than MLP1.
In many
cases, however, MLP1 does indeed provide very strong results.
For further discussion on the representation power of feed-forward neural
networks, see <cite>[<bibref bibrefs="bengio2015deep" separator="," show="Refnum" yyseparator=","/>, Section 6.5]</cite>.</p>
      </para>
    </subsection>
    <subsection refnum="4.2" xml:id="S4.SS2">
      <title><tag close=" ">4.2</tag>Common Non-linearities</title>
      <para xml:id="S4.SS2.p1">
        <p>The non-linearity <Math mode="inline" xml:id="S4.SS2.p1.m1" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> can take many forms. There is currently no good theory as
to which non-linearity to apply in which conditions, and choosing the correct
non-linearity for a given task is for the most part an empirical question. I
will now go over the common non-linearities from the literature: the sigmoid,
tanh, hard tanh and the rectified linear unit (ReLU). Some NLP researchers also
experimented with other forms of non-linearities such as cube and tanh-cube.</p>
      </para>
      <!-- %**** root.tex Line 725 **** -->
      <paragraph xml:id="S4.SS2.SSS0.Px1">
        <title>Sigmoid</title>
        <para xml:id="S4.SS2.SSS0.Px1.p1">
          <p>The sigmoid activation function <Math mode="inline" xml:id="S4.SS2.SSS0.Px1.p1.m1" tex="\sigma(x)=1/(1+e^{-x})" text="sigma * x = 1 / (1 + e ^ (- x))"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="sigma" possibleFunction="yes" role="UNKNOWN" font="italic">σ</XMTok><XMDual><XMRef idref="XM67"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM67" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok mathstyle="inline" meaning="divide" role="MULOP">/</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMDual><XMRef idref="XM68"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM68"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">e</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> is an
S-shaped function, transforming each value <Math mode="inline" xml:id="S4.SS2.SSS0.Px1.p1.m2" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> into the range <Math mode="inline" xml:id="S4.SS2.SSS0.Px1.p1.m3" tex="[0,1]" text="closed-interval@(0, 1)"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM69"/><XMRef idref="XM70"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="0" role="NUMBER" xml:id="XM69">0</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM70">1</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS2.SSS0.Px2">
        <title>Hyperbolic tangent (tanh)</title>
        <para xml:id="S4.SS2.SSS0.Px2.p1">
          <p>The hyperbolic tangent <Math mode="inline" xml:id="S4.SS2.SSS0.Px2.p1.m1" tex="tanh(x)=\frac{e^{2x}-1}{e^{2x}+1}" text="t * a * n * h * x = (e ^ (2 * x) - 1) / (e ^ (2 * x) + 1)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="XM71"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM71" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">e</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">e</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMath></Math> activation
function is an S-shaped function, transforming the values <Math mode="inline" xml:id="S4.SS2.SSS0.Px2.p1.m2" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> into the range <Math mode="inline" xml:id="S4.SS2.SSS0.Px2.p1.m3" tex="[-1,1]" text="closed-interval@(- 1, 1)"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM72"/><XMRef idref="XM73"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM72"><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM73">1</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS2.SSS0.Px3">
        <title>Hard tanh</title>
        <para xml:id="S4.SS2.SSS0.Px3.p1">
          <p>The hard-tanh activation function is an approximation of
the <Math mode="inline" xml:id="S4.SS2.SSS0.Px3.p1.m1" tex="tanh" text="t * a * n * h"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok></XMApp></XMath></Math> function which is faster to compute and take derivatives of:</p>
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx2">
            <equation xml:id="S4.Ex12">
              <MathFork>
                <Math xml:id="S4.Ex12.m2" tex="\displaystyle hardtanh(x)=\begin{cases}-1&amp;x&lt;-1\\&#10;1&amp;x&gt;1\\&#10;x&amp;\text{otherwise}\end{cases}" text="h * a * r * d * t * a * n * h * x = cases@(- 1, x less - 1, 1, x &gt; 1, x, [otherwise])">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">h</XMTok>
                        <XMTok role="UNKNOWN" font="italic">a</XMTok>
                        <XMTok role="UNKNOWN" font="italic">r</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok role="UNKNOWN" font="italic">a</XMTok>
                        <XMTok role="UNKNOWN" font="italic">n</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok>
                        <XMDual>
                          <XMRef idref="XM74"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM74" font="italic">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="cases"/>
                          <XMRef idref="XM5.mf"/>
                          <XMRef idref="XM6.mf"/>
                          <XMRef idref="XM7.mf"/>
                          <XMRef idref="XM8.mf"/>
                          <XMRef idref="XM9.mf"/>
                          <XMRef idref="XM10.mf"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN">{</XMTok>
                          <XMArray>
                            <XMRow>
                              <XMCell align="left">
                                <XMApp xml:id="XM5.mf">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMCell>
                              <XMCell align="left">
                                <XMApp xml:id="XM6.mf">
                                  <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMCell>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMTok meaning="1" role="NUMBER" xml:id="XM7.mf">1</XMTok>
                              </XMCell>
                              <XMCell align="left">
                                <XMApp xml:id="XM8.mf">
                                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMCell>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMTok role="UNKNOWN" xml:id="XM9.mf" font="italic">x</XMTok>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="XM10.mf">otherwise</XMText>
                              </XMCell>
                            </XMRow>
                          </XMArray>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle hardtanh(x)=\begin{cases}-1&amp;x&lt;-1\\&#10;1&amp;x&gt;1\\&#10;x&amp;\text{otherwise}\end{cases}" xml:id="S4.Ex12.m1" text="h * a * r * d * t * a * n * h * x = cases@(- 1, x less - 1, 1, x &gt; 1, x, [otherwise])">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">h</XMTok>
                            <XMTok role="UNKNOWN" font="italic">a</XMTok>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            <XMTok role="UNKNOWN" font="italic">a</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok>
                            <XMDual>
                              <XMRef idref="XM75"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM75" font="italic">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="cases"/>
                              <XMRef idref="XM5"/>
                              <XMRef idref="XM6"/>
                              <XMRef idref="XM7"/>
                              <XMRef idref="XM8"/>
                              <XMRef idref="XM9"/>
                              <XMRef idref="XM10"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN">{</XMTok>
                              <XMArray>
                                <XMRow>
                                  <XMCell align="left">
                                    <XMApp xml:id="XM5">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMCell>
                                  <XMCell align="left">
                                    <XMApp xml:id="XM6">
                                      <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                      <XMApp>
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                                <XMRow>
                                  <XMCell align="left">
                                    <XMTok meaning="1" role="NUMBER" xml:id="XM7">1</XMTok>
                                  </XMCell>
                                  <XMCell align="left">
                                    <XMApp xml:id="XM8">
                                      <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                                <XMRow>
                                  <XMCell align="left">
                                    <XMTok role="UNKNOWN" xml:id="XM9" font="italic">x</XMTok>
                                  </XMCell>
                                  <XMCell align="left">
                                    <XMText xml:id="XM10">otherwise</XMText>
                                  </XMCell>
                                </XMRow>
                              </XMArray>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS2.SSS0.Px4">
        <title>Rectifier (ReLU)</title>
        <para xml:id="S4.SS2.SSS0.Px4.p1">
          <p>The Rectifier activation function <cite>[<bibref bibrefs="glorot2011deep" separator="," show="Refnum" yyseparator=","/>]</cite>, also known as
the rectified linear unit is a very simple activation function that is easy to
work with and was shown many times to produce excellent results.<note mark="9" role="footnote"><!-- %**** root.tex Line 750 **** -->The technical
advantages of the ReLU over the sigmoid and tanh activation functions is that it
does not involve expensive-to-compute functions, and more importantly that it
does not saturate. The sigmoid and tanh activation are capped at <Math mode="inline" xml:id="S4.SS2.SSS0.Px4.p1.m1" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>, and
the gradients at this region of the functions are near zero, driving the entire
gradient near zero. The ReLU activation does not have this problem, making it
especially suitable for networks with multiple layers, which are
susceptible to the vanishing gradients problem when trained with the saturating
units.</note>
The ReLU unit
clips each value <Math mode="inline" xml:id="S4.SS2.SSS0.Px4.p1.m2" tex="x&lt;0" text="x less 0"><XMath><XMApp><XMTok meaning="less-than" role="RELOP">&lt;</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math> at 0. Despite its simplicity, it performs well for many
tasks, especially when combined with the dropout regularization technique
(see Section <ref labelref="LABEL:sec:dropout"/>).</p>
        </para>
        <para xml:id="S4.SS2.SSS0.Px4.p2">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx3">
            <equation xml:id="S4.Ex13">
              <MathFork>
                <Math xml:id="S4.Ex13.m2" tex="\displaystyle ReLU(x)=\max(0,x)=\begin{cases}0&amp;x&lt;0\\&#10;x&amp;\text{otherwise}\end{cases}" text="R * e * L * U * x = maximum@(0, x) = cases@(0, x less 0, x, [otherwise])">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="multirelation"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">R</XMTok>
                        <XMTok role="UNKNOWN" font="italic">e</XMTok>
                        <XMTok role="UNKNOWN" font="italic">L</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">U</XMTok>
                        <XMDual>
                          <XMRef idref="XM76"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM76" font="italic">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM77"/>
                          <XMRef idref="XM78"/>
                          <XMRef idref="XM79"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM77">max</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="XM78">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM79" font="italic">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="cases"/>
                          <XMRef idref="XM11.mf"/>
                          <XMRef idref="XM12.mf"/>
                          <XMRef idref="XM13.mf"/>
                          <XMRef idref="XM14.mf"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN">{</XMTok>
                          <XMArray>
                            <XMRow>
                              <XMCell align="left">
                                <XMTok meaning="0" role="NUMBER" xml:id="XM11.mf">0</XMTok>
                              </XMCell>
                              <XMCell align="left">
                                <XMApp xml:id="XM12.mf">
                                  <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMCell>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMTok role="UNKNOWN" xml:id="XM13.mf" font="italic">x</XMTok>
                              </XMCell>
                              <XMCell align="left">
                                <XMText xml:id="XM14.mf">otherwise</XMText>
                              </XMCell>
                            </XMRow>
                          </XMArray>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle ReLU(x)=\max(0,x)=\begin{cases}0&amp;x&lt;0\\&#10;x&amp;\text{otherwise}\end{cases}" xml:id="S4.Ex13.m1" text="R * e * L * U * x = maximum@(0, x) = cases@(0, x less 0, x, [otherwise])">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">R</XMTok>
                            <XMTok role="UNKNOWN" font="italic">e</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">U</XMTok>
                            <XMDual>
                              <XMRef idref="XM80"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM80" font="italic">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="XM81"/>
                              <XMRef idref="XM82"/>
                              <XMRef idref="XM83"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM81">max</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="XM82">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM83" font="italic">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="cases"/>
                              <XMRef idref="XM11"/>
                              <XMRef idref="XM12"/>
                              <XMRef idref="XM13"/>
                              <XMRef idref="XM14"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN">{</XMTok>
                              <XMArray>
                                <XMRow>
                                  <XMCell align="left">
                                    <XMTok meaning="0" role="NUMBER" xml:id="XM11">0</XMTok>
                                  </XMCell>
                                  <XMCell align="left">
                                    <XMApp xml:id="XM12">
                                      <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                      <XMTok meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                                <XMRow>
                                  <XMCell align="left">
                                    <XMTok role="UNKNOWN" xml:id="XM13" font="italic">x</XMTok>
                                  </XMCell>
                                  <XMCell align="left">
                                    <XMText xml:id="XM14">otherwise</XMText>
                                  </XMCell>
                                </XMRow>
                              </XMArray>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S4.SS2.SSS0.Px4.p3">
          <p>As a rule of thumb, ReLU units work better than tanh, and tanh works better than
sigmoid.<note mark="10" role="footnote"><!-- %**** root.tex Line 775 **** -->
In addition to these activation functions, recent works from the NLP community
experiment with and reported success with other forms of non-linearities.
The <text font="bold">Cube</text> activation function, <Math mode="inline" xml:id="S4.SS2.SSS0.Px4.p3.m1" tex="g(x)=(x)^{3}" text="g * x = x ^ 3"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="XM84"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM84" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMDual><XMRef idref="XM85"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM85" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok meaning="3" role="NUMBER">3</XMTok></XMApp></XMApp></XMath></Math>, was suggested by
<cite>[<bibref bibrefs="chen2014fast" separator="," show="Refnum" yyseparator=","/>]</cite>, who found it to be more effective than other non-linearities
in a feed-forward network that was used to predict the actions in a greedy
transition-based dependency parser.
The <text font="bold">tanh cube</text> activation function <Math mode="inline" xml:id="S4.SS2.SSS0.Px4.p3.m2" tex="g(x)=\tanh((x)^{3}+x)" text="g * x = hyperbolic-tangent@(x ^ 3 + x)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="XM86"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM86" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMDual><XMApp><XMRef idref="XM88"/><XMRef idref="XM89"/></XMApp><XMApp><XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM88">tanh</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM89"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMDual><XMRef idref="XM87"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM87" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok meaning="3" role="NUMBER">3</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMApp></XMDual></XMApp></XMath></Math> was proposed by <cite>[<bibref bibrefs="pei2015effective" separator="," show="Refnum" yyseparator=","/>]</cite>,
who found it to be more effective than other non-linearities
in a feed-forward network that was used as a component in a
structured-prediction graph-based dependency parser.
The cube and tanh-cube activation functions are motivated by the desire
to better capture interactions between different features.
While these activation functions are reported to improve performance in certain
situations, their general applicability is still to be determined.</note></p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="4.3" xml:id="S4.SS3" labels="LABEL:sec:softmax">
      <title><tag close=" ">4.3</tag>Output Transformations</title>
      <para xml:id="S4.SS3.p1">
        <p>In many cases, the output layer vector is also transformed.
A common transformation is the <emph>softmax</emph>:</p>
      </para>
      <para xml:id="S4.SS3.p2">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx4">
          <equation xml:id="S4.Ex14">
            <MathFork>
              <Math xml:id="S4.Ex14.m3" tex="\displaystyle\mathbf{x}=x_{1},\ldots,x_{k}" text="x = list@(x _ 1, ldots, x _ k)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="XM90"/>
                        <XMRef idref="XM91"/>
                        <XMRef idref="XM92"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="XM90">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">x</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="ldots" role="ID" xml:id="XM91">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="XM92">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">x</XMTok>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{x}=" xml:id="S4.Ex14.m1" text="x = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle x_{1},\ldots,x_{k}" xml:id="S4.Ex14.m2" text="list@(x _ 1, ldots, x _ k)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="XM93"/>
                          <XMRef idref="XM94"/>
                          <XMRef idref="XM95"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM93">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok name="ldots" role="ID" xml:id="XM94">…</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM95">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex15">
            <MathFork>
              <Math xml:id="S4.Ex15.m3" tex="\displaystyle softmax(x_{i})=\frac{e^{x_{i}}}{\sum_{j=1}^{k}e^{x_{j}}}" text="s * o * f * t * m * a * x * x _ i = e ^ (x _ i) / ((sum _ (j = 1)) ^ k)@(e ^ (x _ j))">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                      <XMTok role="UNKNOWN" font="italic">m</XMTok>
                      <XMTok role="UNKNOWN" font="italic">a</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">x</XMTok>
                      <XMDual>
                        <XMRef idref="XM96"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM96">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="italic">e</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                          <XMTok role="UNKNOWN" font="italic">x</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="italic">e</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">j</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle softmax(x_{i})=" xml:id="S4.Ex15.m1" text="s * o * f * t * m * a * x * x _ i = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">o</XMTok>
                          <XMTok role="UNKNOWN" font="italic">f</XMTok>
                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          <XMTok role="UNKNOWN" font="italic">m</XMTok>
                          <XMTok role="UNKNOWN" font="italic">a</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">x</XMTok>
                          <XMDual>
                            <XMRef idref="XM97"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM97">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\frac{e^{x_{i}}}{\sum_{j=1}^{k}e^{x_{j}}}" xml:id="S4.Ex15.m2" text="e ^ (x _ i) / ((sum _ (j = 1)) ^ k)@(e ^ (x _ j))">
                    <XMath>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="italic">e</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="italic">e</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                              <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              <XMTok role="UNKNOWN" font="italic">j</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S4.SS3.p3">
        <p>The result is a vector of non-negative real numbers that sum to one, making it a
discrete probability distribution over <Math mode="inline" xml:id="S4.SS3.p3.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> possible outcomes.</p>
      </para>
      <!-- %**** root.tex Line 800 **** -->
      <para xml:id="S4.SS3.p4">
        <p>The <Math mode="inline" xml:id="S4.SS3.p4.m1" tex="softmax" text="s * o * f * t * m * a * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> output transformation is used when we are
interested in modeling a probability distribution over the possible output
classes. To be effective, it should be used in conjunction with a probabilistic
training objective such as cross-entropy (see Section <ref labelref="LABEL:sec:crossent"/> below).</p>
      </para>
      <para xml:id="S4.SS3.p5">
        <p>When the softmax transformation is applied to the output of a network without a
hidden layer, the result is the well known multinomial logistic regression
model, also known as a maximum-entropy classifier.</p>
      </para>
    </subsection>
    <subsection refnum="4.4" xml:id="S4.SS4" labels="LABEL:sec:embed-layer">
      <title><tag close=" ">4.4</tag>Embedding Layers</title>
      <para xml:id="S4.SS4.p1">
        <p>Up until now, the discussion ignored the source of <Math mode="inline" xml:id="S4.SS4.p1.m1" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>, treating it as an arbitrary
vector. In an NLP application, <Math mode="inline" xml:id="S4.SS4.p1.m2" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> is usually composed of various embeddings
vectors.
We can be explicit about the source of <Math mode="inline" xml:id="S4.SS4.p1.m3" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>, and include it in the network’s definition.
We introduce <Math mode="inline" xml:id="S4.SS4.p1.m4" tex="c(\cdot)" text="c * cdot"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM98"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok name="cdot" role="MULOP" xml:id="XM98">⋅</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, a function from core features to an input vector.</p>
      </para>
      <para xml:id="S4.SS4.p2">
        <p>It is common for <Math mode="inline" xml:id="S4.SS4.p2.m1" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> to extract the embedding vector associated with each feature, and concatenate them:</p>
      </para>
      <para xml:id="S4.SS4.p3">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx5">
          <equation xml:id="S4.Ex16">
            <MathFork>
              <Math xml:id="S4.Ex16.m3" tex="\displaystyle\mathbf{x}=c(f_{1},f_{2},f_{3})=[v(f_{1});v(f_{2});v(f_{3})]" text="x = c * vector@(f _ 1, f _ 2, f _ 3) = list@(v * f _ 1, v * f _ 2, v * f _ 3)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="XM99"/>
                          <XMRef idref="XM100"/>
                          <XMRef idref="XM101"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM99">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM100">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM101">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="3" role="NUMBER">3</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="XM105"/>
                        <XMRef idref="XM106"/>
                        <XMRef idref="XM107"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="XM105">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM102"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM102">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">;</XMTok>
                        <XMApp xml:id="XM106">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM103"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM103">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">;</XMTok>
                        <XMApp xml:id="XM107">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM104"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM104">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="3" role="NUMBER">3</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{x}=c(f_{1},f_{2},f_{3})=" xml:id="S4.Ex16.m1" text="x = c * vector@(f _ 1, f _ 2, f _ 3) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="XM108"/>
                              <XMRef idref="XM109"/>
                              <XMRef idref="XM110"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM108">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM109">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM110">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="3" role="NUMBER">3</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle[v(f_{1});v(f_{2});v(f_{3})]" xml:id="S4.Ex16.m2" text="list@(v * f _ 1, v * f _ 2, v * f _ 3)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="XM114"/>
                          <XMRef idref="XM115"/>
                          <XMRef idref="XM116"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="XM114">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                            <XMDual>
                              <XMRef idref="XM111"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM111">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="XM115">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                            <XMDual>
                              <XMRef idref="XM112"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM112">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="XM116">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                            <XMDual>
                              <XMRef idref="XM113"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM113">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex17">
            <MathFork>
              <Math xml:id="S4.Ex17.m3" tex="\displaystyle NN_{MLP1}(\mathbf{x})=NN_{MLP1}(c(f_{1},f_{2},f_{3}))" text="N * N _ (M * L * P * 1) * x = N * N _ (M * L * P * 1) * c * vector@(f _ 1, f _ 2, f _ 3)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM117"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM117" font="bold">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM127"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM127">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="XM124"/>
                                <XMRef idref="XM125"/>
                                <XMRef idref="XM126"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM124">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM125">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM126">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}(\mathbf{x})=" xml:id="S4.Ex17.m1" text="N * N _ (M * L * P * 1) * x = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">P</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM128"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM128" font="bold">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}(c(f_{1},f_{2},f_{3}))" xml:id="S4.Ex17.m2" text="N * N _ (M * L * P * 1) * c * vector@(f _ 1, f _ 2, f _ 3)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM138"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM138">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="vector"/>
                                  <XMRef idref="XM135"/>
                                  <XMRef idref="XM136"/>
                                  <XMRef idref="XM137"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM135">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM136">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM137">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex18">
            <MathFork>
              <Math xml:id="S4.Ex18.m3" tex="\displaystyle=NN_{MLP1}([v(f_{1});v(f_{2});v(f_{3})])" text="absent = N * N _ (M * L * P * 1) * list@(v * f _ 1, v * f _ 2, v * f _ 3)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM163"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMDual xml:id="XM163">
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="XM160"/>
                              <XMRef idref="XM161"/>
                              <XMRef idref="XM162"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="XM160">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM157"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM157">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="XM161">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM158"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM158">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="XM162">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM159"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM159">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S4.Ex18.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}([v(f_{1});v(f_{2});v(f_{3})])" xml:id="S4.Ex18.m2" text="N * N _ (M * L * P * 1) * list@(v * f _ 1, v * f _ 2, v * f _ 3)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM188"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMDual xml:id="XM188">
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="XM185"/>
                                <XMRef idref="XM186"/>
                                <XMRef idref="XM187"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="XM185">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM182"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM182">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">;</XMTok>
                                <XMApp xml:id="XM186">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM183"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM183">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">;</XMTok>
                                <XMApp xml:id="XM187">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM184"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM184">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex19">
            <MathFork>
              <Math xml:id="S4.Ex19.m3" tex="\displaystyle=(g([v(f_{1});v(f_{2});v(f_{3})]\mathbf{W^{1}}+\mathbf{b^{1}}))%&#10;\mathbf{W^{2}}+\mathbf{b^{2}}" text="absent = g * (list@(v * f _ 1, v * f _ 2, v * f _ 3) * W ^ 1 + b ^ 1) * W ^ 2 + b ^ 2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMRef idref="XM226"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM226">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">g</XMTok>
                              <XMDual>
                                <XMRef idref="XM225"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM225">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="XM222"/>
                                          <XMRef idref="XM223"/>
                                          <XMRef idref="XM224"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="XM222">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                            <XMDual>
                                              <XMRef idref="XM219"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="XM219">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="PUNCT">;</XMTok>
                                          <XMApp xml:id="XM223">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                            <XMDual>
                                              <XMRef idref="XM220"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="XM220">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="PUNCT">;</XMTok>
                                          <XMApp xml:id="XM224">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                            <XMDual>
                                              <XMRef idref="XM221"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="XM221">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                      <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                      <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                        <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S4.Ex19.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle(g([v(f_{1});v(f_{2});v(f_{3})]\mathbf{W^{1}}+\mathbf{b^{1}}))%&#10;\mathbf{W^{2}}+\mathbf{b^{2}}" xml:id="S4.Ex19.m2" text="g * (list@(v * f _ 1, v * f _ 2, v * f _ 3) * W ^ 1 + b ^ 1) * W ^ 2 + b ^ 2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="XM264"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM264">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                <XMDual>
                                  <XMRef idref="XM263"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM263">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="XM260"/>
                                            <XMRef idref="XM261"/>
                                            <XMRef idref="XM262"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                                            <XMApp xml:id="XM260">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM257"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM257">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="PUNCT">;</XMTok>
                                            <XMApp xml:id="XM261">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM258"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM258">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="PUNCT">;</XMTok>
                                            <XMApp xml:id="XM262">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM259"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM259">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">W</XMTok>
                            <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">b</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S4.SS4.p4">
        <p>Another common choice is for <Math mode="inline" xml:id="S4.SS4.p4.m1" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> to sum the embedding vectors (this assumes the
embedding vectors all share the same dimensionality):</p>
      </para>
      <para xml:id="S4.SS4.p5">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx6">
          <equation xml:id="S4.Ex20">
            <MathFork>
              <Math xml:id="S4.Ex20.m3" tex="\displaystyle\mathbf{x}=c(f_{1},f_{2},f_{3})=v(f_{1})+v(f_{2})+v(f_{3})" text="x = c * vector@(f _ 1, f _ 2, f _ 3) = v * f _ 1 + v * f _ 2 + v * f _ 3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="XM265"/>
                          <XMRef idref="XM266"/>
                          <XMRef idref="XM267"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM265">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM266">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM267">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">f</XMTok>
                            <XMTok meaning="3" role="NUMBER">3</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                        <XMDual>
                          <XMRef idref="XM268"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM268">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">f</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                        <XMDual>
                          <XMRef idref="XM269"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM269">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">f</XMTok>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                        <XMDual>
                          <XMRef idref="XM270"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM270">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">f</XMTok>
                              <XMTok meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{x}=c(f_{1},f_{2},f_{3})=" xml:id="S4.Ex20.m1" text="x = c * vector@(f _ 1, f _ 2, f _ 3) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="XM271"/>
                              <XMRef idref="XM272"/>
                              <XMRef idref="XM273"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM271">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM272">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM273">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="3" role="NUMBER">3</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle v(f_{1})+v(f_{2})+v(f_{3})" xml:id="S4.Ex20.m2" text="v * f _ 1 + v * f _ 2 + v * f _ 3">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM274"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM274">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM275"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM275">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                          <XMDual>
                            <XMRef idref="XM276"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM276">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                <XMTok meaning="3" role="NUMBER">3</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex21">
            <MathFork>
              <Math xml:id="S4.Ex21.m3" tex="\displaystyle NN_{MLP1}(\mathbf{x})=NN_{MLP1}(c(f_{1},f_{2},f_{3}))" text="N * N _ (M * L * P * 1) * x = N * N _ (M * L * P * 1) * c * vector@(f _ 1, f _ 2, f _ 3)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM277"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM277" font="bold">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM287"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM287">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="XM284"/>
                                <XMRef idref="XM285"/>
                                <XMRef idref="XM286"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM284">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM285">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM286">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}(\mathbf{x})=" xml:id="S4.Ex21.m1" text="N * N _ (M * L * P * 1) * x = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">P</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM288"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM288" font="bold">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}(c(f_{1},f_{2},f_{3}))" xml:id="S4.Ex21.m2" text="N * N _ (M * L * P * 1) * c * vector@(f _ 1, f _ 2, f _ 3)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM298"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM298">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="vector"/>
                                  <XMRef idref="XM295"/>
                                  <XMRef idref="XM296"/>
                                  <XMRef idref="XM297"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM295">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM296">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM297">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex22">
            <MathFork>
              <Math xml:id="S4.Ex22.m3" tex="\displaystyle=NN_{MLP1}(v(f_{1})+v(f_{2})+v(f_{3}))" text="absent = N * N _ (M * L * P * 1) * (v * f _ 1 + v * f _ 2 + v * f _ 3)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">P</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM306"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM306">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                              <XMDual>
                                <XMRef idref="XM303"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM303">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                              <XMDual>
                                <XMRef idref="XM304"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM304">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                              <XMDual>
                                <XMRef idref="XM305"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM305">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S4.Ex22.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle NN_{MLP1}(v(f_{1})+v(f_{2})+v(f_{3}))" xml:id="S4.Ex22.m2" text="N * N _ (M * L * P * 1) * (v * f _ 1 + v * f _ 2 + v * f _ 3)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            <XMTok role="UNKNOWN" font="italic">L</XMTok>
                            <XMTok role="UNKNOWN" font="italic">P</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM314"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM314">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM311"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM311">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM312"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM312">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                <XMDual>
                                  <XMRef idref="XM313"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM313">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S4.Ex23">
            <MathFork>
              <Math xml:id="S4.Ex23.m3" tex="\displaystyle=(g((v(f_{1})+v(f_{2})+v(f_{3}))\mathbf{W^{1}}+\mathbf{b^{1}}))%&#10;\mathbf{W^{2}}+\mathbf{b^{2}}" text="absent = g * ((v * f _ 1 + v * f _ 2 + v * f _ 3) * W ^ 1 + b ^ 1) * W ^ 2 + b ^ 2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMRef idref="XM340"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM340">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">g</XMTok>
                              <XMDual>
                                <XMRef idref="XM339"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM339">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMDual>
                                        <XMRef idref="XM338"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="XM338">
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM335"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM335">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM336"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM336">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM337"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM337">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                    <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                      <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                      <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                        <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S4.Ex23.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle(g((v(f_{1})+v(f_{2})+v(f_{3}))\mathbf{W^{1}}+\mathbf{b^{1}}))%&#10;\mathbf{W^{2}}+\mathbf{b^{2}}" xml:id="S4.Ex23.m2" text="g * ((v * f _ 1 + v * f _ 2 + v * f _ 3) * W ^ 1 + b ^ 1) * W ^ 2 + b ^ 2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="XM366"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM366">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                <XMDual>
                                  <XMRef idref="XM365"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM365">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMRef idref="XM364"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="XM364">
                                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                                <XMDual>
                                                  <XMRef idref="XM361"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="XM361">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                                <XMDual>
                                                  <XMRef idref="XM362"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="XM362">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                                                <XMDual>
                                                  <XMRef idref="XM363"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="XM363">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                                      <XMTok role="UNKNOWN" font="italic">f</XMTok>
                                                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">W</XMTok>
                            <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">b</XMTok>
                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <!-- %Of course, the input dimensionality of $“m–W^1˝$ should be set to match the number of dimensions of $“m–x˝$. -->
      <para xml:id="S4.SS4.p6">
        <p>The form of <Math mode="inline" xml:id="S4.SS4.p6.m1" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> is an essential part of the network’s design.
In many papers, it is common to refer to <Math mode="inline" xml:id="S4.SS4.p6.m2" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> as part of the network,
and likewise treat the word embeddings <Math mode="inline" xml:id="S4.SS4.p6.m3" tex="v(f_{i})" text="v * f _ i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM367"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM367"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> as resulting
from an “embedding layer” or “lookup layer”. Consider a vocabulary of <Math mode="inline" xml:id="S4.SS4.p6.m4" tex="|V|" text="absolute-value@(V)"><XMath><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="XM368"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" xml:id="XM368" font="italic">V</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual></XMath></Math>
words, each embedded as a <Math mode="inline" xml:id="S4.SS4.p6.m5" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> dimensional vector. The collection of vectors can
then be thought of as a <Math mode="inline" xml:id="S4.SS4.p6.m6" tex="|V|\times d" text="absolute-value@(V) * d"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="XM369"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" xml:id="XM369" font="italic">V</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMath></Math> embedding matrix <Math mode="inline" xml:id="S4.SS4.p6.m7" tex="\mathbf{E}" text="E"><XMath><XMTok role="UNKNOWN" font="bold">E</XMTok></XMath></Math> in which each row
corresponds to an embedded feature.
Let <Math mode="inline" xml:id="S4.SS4.p6.m8" tex="\mathbf{f_{i}}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">f</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> be a <Math mode="inline" xml:id="S4.SS4.p6.m9" tex="|V|" text="absolute-value@(V)"><XMath><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="XM370"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" xml:id="XM370" font="italic">V</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual></XMath></Math>-dimensional vector, which is all zeros except from one
index, corresponding to the value of the <Math mode="inline" xml:id="S4.SS4.p6.m10" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th feature, in which the value is
<Math mode="inline" xml:id="S4.SS4.p6.m11" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math> (this is called a one-hot vector). The multiplication <Math mode="inline" xml:id="S4.SS4.p6.m12" tex="\mathbf{f_{i}}\mathbf{E}" text="f _ i * E"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">f</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">E</XMTok></XMApp></XMath></Math> will then
<!-- %**** root.tex Line 850 **** -->“select” the corresponding row of <Math mode="inline" xml:id="S4.SS4.p6.m13" tex="\mathbf{E}" text="E"><XMath><XMTok role="UNKNOWN" font="bold">E</XMTok></XMath></Math>. Thus, <Math mode="inline" xml:id="S4.SS4.p6.m14" tex="v(f_{i})" text="v * f _ i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM371"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM371"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> can be defined in
terms of <Math mode="inline" xml:id="S4.SS4.p6.m15" tex="\mathbf{E}" text="E"><XMath><XMTok role="UNKNOWN" font="bold">E</XMTok></XMath></Math> and <Math mode="inline" xml:id="S4.SS4.p6.m16" tex="\mathbf{f_{i}}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">f</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>:</p>
        <equation xml:id="S4.Ex24">
          <Math mode="display" xml:id="S4.Ex24.m1" tex="v(f_{i})=\mathbf{f_{i}}\mathbf{E}" text="v * f _ i = f _ i * E">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                  <XMDual>
                    <XMRef idref="XM372"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM372">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                    <XMTok role="UNKNOWN" font="bold">f</XMTok>
                    <XMTok role="UNKNOWN" font="bold">i</XMTok>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="bold">E</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S4.SS4.p7">
        <p>And similarly:</p>
      </para>
      <para xml:id="S4.SS4.p8">
        <equation xml:id="S4.Ex25">
          <Math mode="display" xml:id="S4.Ex25.m1" tex="CBOW(f_{1},...,f_{k})=\sum_{i=1}^{k}(\mathbf{f_{i}}\mathbf{E})=(\sum_{i=1}^{k}%&#10;\mathbf{f_{i}})\mathbf{E}" text="C * B * O * W * vector@(f _ 1, ldots, f _ k) = ((sum _ (i = 1)) ^ k)@(f _ i * E) = ((sum _ (i = 1)) ^ k)@(f _ i) * E">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">C</XMTok>
                  <XMTok role="UNKNOWN" font="italic">B</XMTok>
                  <XMTok role="UNKNOWN" font="italic">O</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">W</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM373"/>
                      <XMRef idref="XM374"/>
                      <XMRef idref="XM375"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM373">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="XM374">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM375">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">f</XMTok>
                        <XMTok role="UNKNOWN" font="italic">k</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="XM376"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM376">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">f</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="bold">E</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMDual>
                    <XMRef idref="XM377"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM377">
                        <XMApp scriptpos="mid">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">f</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="UNKNOWN" font="bold">E</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S4.SS4.p9">
        <p>The input to the network is then considered to be a collection of one-hot
vectors. While this is elegant and well defined mathematically, an efficient
implementation typically involves a hash-based data structure mapping features
to their corresponding embedding vectors, without going through the one-hot
representation.</p>
      </para>
      <para xml:id="S4.SS4.p10">
        <p>In this tutorial, we take <Math mode="inline" xml:id="S4.SS4.p10.m1" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> to be separate from the
network architecture: the network’s inputs are always dense real-valued input
vectors, and <Math mode="inline" xml:id="S4.SS4.p10.m2" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math> is applied before the input is passed the network, similar to a
“feature function” in the familiar linear-models terminology. However, when
training a network, the input vector <Math mode="inline" xml:id="S4.SS4.p10.m3" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> does remember how it was
constructed, and can propagate error gradients back to its component embedding
vectors, as appropriate.</p>
      </para>
      <paragraph xml:id="S4.SS4.SSS0.Px1">
        <title>A note on notation</title>
        <para xml:id="S4.SS4.SSS0.Px1.p1">
          <p>When describing network layers that get
concatenated vectors <Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m1" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>, <Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m2" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math> and <Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m3" tex="\mathbf{z}" text="z"><XMath><XMTok role="UNKNOWN" font="bold">z</XMTok></XMath></Math> as input, some authors
use explicit concatenation
<!-- %**** root.tex Line 875 **** -->(<Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m4" tex="[\mathbf{x};\mathbf{y};\mathbf{z}]\mathbf{W}+\mathbf{b}" text="list@(x, y, z) * W + b"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM378"/><XMRef idref="XM379"/><XMRef idref="XM380"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok role="UNKNOWN" xml:id="XM378" font="bold">x</XMTok><XMTok role="PUNCT">;</XMTok><XMTok role="UNKNOWN" xml:id="XM379" font="bold">y</XMTok><XMTok role="PUNCT">;</XMTok><XMTok role="UNKNOWN" xml:id="XM380" font="bold">z</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="UNKNOWN" font="bold">W</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp></XMath></Math>) while others use an affine transformation
(<Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m5" tex="\mathbf{x}\mathbf{U}+\mathbf{y}\mathbf{V}+\mathbf{z}\mathbf{W}+\mathbf{b})"><XMath><XMTok role="UNKNOWN" font="bold">xU</XMTok><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">yV</XMTok><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">zW</XMTok><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMath></Math>. If the weight matrices
<Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m6" tex="\mathbf{U}" text="U"><XMath><XMTok role="UNKNOWN" font="bold">U</XMTok></XMath></Math>, <Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m7" tex="\mathbf{V}" text="V"><XMath><XMTok role="UNKNOWN" font="bold">V</XMTok></XMath></Math>, <Math mode="inline" xml:id="S4.SS4.SSS0.Px1.p1.m8" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math> in the affine transformation are different than one
another, the two notations are equivalent.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS4.SSS0.Px2">
        <title>A note on sparse vs. dense features</title>
        <para xml:id="S4.SS4.SSS0.Px2.p1" class="ltx_noindent">
          <p>Consider a network which uses
a “traditional” sparse representation for its input vectors,
and no embedding layer.
Assuming the set of all available features is <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p1.m1" tex="V" text="V"><XMath><XMTok role="UNKNOWN" font="italic">V</XMTok></XMath></Math> and we have <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> “on”
features <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p1.m3" tex="f_{1},\ldots,f_{k}" text="list@(f _ 1, ldots, f _ k)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM381"/><XMRef idref="XM382"/><XMRef idref="XM383"/></XMApp><XMWrap><XMApp xml:id="XM381"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM382">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM383"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p1.m4" tex="f_{i}\in V" text="f _ i element-of V"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">V</XMTok></XMApp></XMath></Math>,
the network’s input is:</p>
          <equation xml:id="S4.Ex26">
            <Math mode="display" xml:id="S4.Ex26.m1" tex="\mathbf{x}=\sum_{i=1}^{k}\mathbf{f_{i}}\;\;\;\;\;\;\;\;\;\;\mathbf{x}\in%&#10;\mathbb{N}_{+}^{|V|}" text="formulae@(x = ((sum _ (i = 1)) ^ k)@(f _ i), x element-of (N _ +) ^ (absolute-value@(V)))">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="XM385"/>
                    <XMRef idref="XM386"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="XM385">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok role="UNKNOWN" font="bold">x</XMTok>
                      <XMApp>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">f</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok name="qquad" role="PUNCT" font="italic">    </XMTok>
                    <XMApp xml:id="XM386">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="bold">x</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">N</XMTok>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="XM384"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM384" font="italic">V</XMTok>
                            <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>and so the first layer (ignoring the non-linear activation) is:</p>
          <equation xml:id="S4.Ex27">
            <Math mode="display" xml:id="S4.Ex27.m1" tex="\mathbf{x}\mathbf{W}+\mathbf{b}=(\sum_{i=1}^{k}\mathbf{f_{i}})\mathbf{W}" text="xW + b = ((sum _ (i = 1)) ^ k)@(f _ i) * W">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok role="UNKNOWN" font="bold">xW</XMTok>
                    <XMTok role="UNKNOWN" font="bold">b</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMDual>
                      <XMRef idref="XM387"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="XM387">
                          <XMApp scriptpos="mid">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid3"/>
                            <XMApp scriptpos="mid">
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="bold">f</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="UNKNOWN" font="bold">W</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
          <equation xml:id="S4.Ex28">
            <Math mode="display" xml:id="S4.Ex28.m1" tex="\mathbf{W}\in\mathbb{R}^{|V|\times d},\;\;\;\mathbf{b}\in\mathbb{R}^{d}" text="formulae@(W element-of R ^ (absolute-value@(V) * d), b element-of R ^ d)">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="XM389"/>
                    <XMRef idref="XM390"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="XM389">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="bold">W</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">×</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="absolute-value"/>
                              <XMRef idref="XM388"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM388" font="italic">V</XMTok>
                              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT" rpadding="8.4pt">,</XMTok>
                    <XMApp xml:id="XM390">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="bold">b</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS4.SSS0.Px2.p2">
          <p>This layer selects rows of <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p2.m1" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math> corresponding to the input features in
<Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p2.m2" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> and sums them, then adding a bias term. This is very similar to
an embedding layer that produces a CBOW representation over the features,
<!-- %**** root.tex Line 900 **** -->where the matrix <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p2.m3" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math> acts as the embedding matrix. The main difference
is the introduction of the bias vector <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p2.m4" tex="\mathbf{b}" text="b"><XMath><XMTok role="UNKNOWN" font="bold">b</XMTok></XMath></Math>, and the fact that the embedding
layer typically does not undergo a non-linear activation but rather passed on
directly to the first layer. Another difference is that this scenario forces
each feature to receive a separate vector (row in <Math mode="inline" xml:id="S4.SS4.SSS0.Px2.p2.m5" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math>) while the embedding
layer provides more flexibility, allowing for example for the features “next
word is dog” and “previous word is dog” to share the same vector. However,
these differences are small and subtle. When it comes to multi-layer
feed-forward networks, the difference between dense and sparse inputs
is smaller than it may seem at first sight.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="4.5" xml:id="S4.SS5">
      <title><tag close=" ">4.5</tag>Loss Functions</title>
      <para xml:id="S4.SS5.p1">
        <p>When training a neural network (more on training in Section <ref labelref="LABEL:sec:training"/> below),
much like when training a linear classifier,
one defines a loss function <Math mode="inline" xml:id="S4.SS5.p1.m1" tex="L(\mathbf{\hat{y}},\mathbf{y})" text="L * open-interval@(hat@(y), y)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM391"/><XMRef idref="XM392"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM391"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM392" font="bold">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, stating the loss of
predicting <Math mode="inline" xml:id="S4.SS5.p1.m2" tex="\mathbf{\hat{y}}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp></XMath></Math> when the true output is <Math mode="inline" xml:id="S4.SS5.p1.m3" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math>. The training
objective is then to minimize the loss across the different training examples.
The loss <Math mode="inline" xml:id="S4.SS5.p1.m4" tex="L(\mathbf{\hat{y}},\mathbf{y})" text="L * open-interval@(hat@(y), y)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM393"/><XMRef idref="XM394"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM393"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM394" font="bold">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> assigns a numerical score (a scalar) for the
network’s output <Math mode="inline" xml:id="S4.SS5.p1.m5" tex="\mathbf{\hat{y}}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp></XMath></Math> given the true expected output
<Math mode="inline" xml:id="S4.SS5.p1.m6" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math>.<note mark="11" role="footnote">In our notation, both the model’s output and the expected
output are vectors, while in many cases it is more natural to think of the
expected output as a scalar (class assignment). In such cases, <Math mode="inline" xml:id="S4.SS5.p1.m7" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math> is simply
the corresponding one-hot vector.</note> The loss is always positive, and should be
zero only for cases where the network’s output is correct.
<!-- %**** root.tex Line 925 **** --></p>
      </para>
      <para xml:id="S4.SS5.p2">
        <p>The parameters of the network (the matrices <Math mode="inline" xml:id="S4.SS5.p2.m1" tex="\mathbf{W^{i}}" text="W ^ i"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>, the biases <Math mode="inline" xml:id="S4.SS5.p2.m2" tex="\mathbf{b^{i}}" text="b ^ i"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> and
commonly the embeddings <Math mode="inline" xml:id="S4.SS5.p2.m3" tex="\mathbf{E}" text="E"><XMath><XMTok role="UNKNOWN" font="bold">E</XMTok></XMath></Math>) are then set in order to minimize the loss <Math mode="inline" xml:id="S4.SS5.p2.m4" tex="L" text="L"><XMath><XMTok role="UNKNOWN" font="italic">L</XMTok></XMath></Math>
over the training examples (usually, it is the sum of the losses over the
different training examples that is being minimized).</p>
      </para>
      <para xml:id="S4.SS5.p3">
        <p>The loss can be an arbitrary function mapping two vectors to a scalar. For
practical purposes of optimization, we restrict ourselves to functions for which
we can easily compute gradients (or sub-gradients). In most cases, it is
sufficient and advisable to rely on a common loss function rather than defining
your own. For a detailed discussion on loss functions for neural networks see
<cite>[<bibref bibrefs="lecun2006tutorial,lecun2005loss,bengio2015deep" separator="," show="Refnum" yyseparator=","/>]</cite>.
We now discuss some loss functions that are commonly used in neural networks for
NLP.</p>
      </para>
      <paragraph xml:id="S4.SS5.SSS0.Px1">
        <title>Hinge (binary)</title>
        <para xml:id="S4.SS5.SSS0.Px1.p1">
          <p>For binary classification problems, the network’s output is a single scalar
<Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m1" tex="\hat{y}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMath></Math> and the intended output <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m2" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> is in <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m3" tex="\{+1,-1\}" text="set@(+ 1, - 1)"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="XM397"/><XMRef idref="XM398"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMApp xml:id="XM397"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM398"><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math>. The classification rule
is <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m4" tex="sign(\hat{y})" text="s * i * g * n * hat@(y)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">g</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">n</XMTok><XMDual><XMRef idref="XM399"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM399"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>, and a classification is
considered correct if <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m5" tex="y\cdot\hat{y}&gt;0" text="y cdot hat@(y) &gt; 0"><XMath><XMApp><XMTok meaning="greater-than" role="RELOP">&gt;</XMTok><XMApp><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math>, meaning that <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m6" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> and <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p1.m7" tex="\hat{y}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMath></Math> share
the same sign.
The hinge loss, also known as margin loss or SVM loss, is defined as:</p>
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx7">
            <equation xml:id="S4.Ex29">
              <MathFork>
                <Math xml:id="S4.Ex29.m2" tex="\displaystyle L_{hinge(binary)}(\hat{y},y)=\max(0,1-y\cdot\hat{y})" text="L _ (h * i * n * g * e * b * i * n * a * r * y) * open-interval@(hat@(y), y) = maximum@(0, 1 - y cdot hat@(y))">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">h</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok role="UNKNOWN" font="italic">g</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                            <XMDual>
                              <XMRef idref="XM400"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM400">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">b</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM401"/>
                            <XMRef idref="XM402"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM401">
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM402" font="italic">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM403"/>
                          <XMRef idref="XM404"/>
                          <XMRef idref="XM405"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM403">max</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="XM404">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM405">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{hinge(binary)}(\hat{y},y)=\max(0,1-y\cdot\hat{y})" xml:id="S4.Ex29.m1" text="L _ (h * i * n * g * e * b * i * n * a * r * y) * open-interval@(hat@(y), y) = maximum@(0, 1 - y cdot hat@(y))">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                                <XMDual>
                                  <XMRef idref="XM406"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM406">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">b</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM407"/>
                                <XMRef idref="XM408"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM407">
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM408" font="italic">y</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="XM409"/>
                              <XMRef idref="XM410"/>
                              <XMRef idref="XM411"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM409">max</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="XM410">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM411">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                    <XMApp>
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <!-- %**** root.tex Line 950 **** -->
        </para>
        <para xml:id="S4.SS5.SSS0.Px1.p2">
          <p>The loss is 0 when <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p2.m1" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> and <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p2.m2" tex="\hat{y}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMath></Math> share the same sign and <Math mode="inline" xml:id="S4.SS5.SSS0.Px1.p2.m3" tex="|\hat{y}|\geq 1" text="absolute-value@(hat@(y)) &gt;= 1"><XMath><XMApp><XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="XM412"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp xml:id="XM412"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>.
Otherwise, the loss is linear. In other words, the binary hinge loss attempts to achieve a
correct classification, with a margin of at least 1.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS5.SSS0.Px2">
        <title>Hinge (multiclass)</title>
        <para xml:id="S4.SS5.SSS0.Px2.p1">
          <p>The hinge loss was extended to the multiclass setting by Crammer and Singer
<ERROR class="undefined">\citeyear</ERROR>crammer2002algorithmic.
Let <Math mode="inline" xml:id="S4.SS5.SSS0.Px2.p1.m1" tex="\mathbf{\hat{y}}=\hat{y}_{1},\ldots,\hat{y}_{n}" text="hat@(y) = list@((hat@(y)) _ 1, ldots, (hat@(y)) _ n)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM413"/><XMRef idref="XM414"/><XMRef idref="XM415"/></XMApp><XMWrap><XMApp xml:id="XM413"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM414">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM415"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMApp></XMath></Math> be the network’s output vector, and
<Math mode="inline" xml:id="S4.SS5.SSS0.Px2.p1.m2" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math> be the one-hot vector for the correct output class.</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px2.p2">
          <p>The classification rule is defined as
selecting the class with the highest score:</p>
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx8">
            <equation xml:id="S4.Ex30">
              <MathFork>
                <Math xml:id="S4.Ex30.m2" tex="\displaystyle\text{prediction}=\arg\max_{i}\hat{y}_{i}" text="[prediction] = argument@((maximum _ i)@((hat@(y)) _ i))">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMText>prediction</XMText>
                      <XMApp>
                        <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                            <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle\text{prediction}=\arg\max_{i}\hat{y}_{i}" xml:id="S4.Ex30.m1" text="[prediction] = argument@((maximum _ i)@((hat@(y)) _ i))">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMText>prediction</XMText>
                          <XMApp>
                            <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                            <XMApp>
                              <XMApp scriptpos="mid">
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                                <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>,</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px2.p3">
          <p>Denote by <Math mode="inline" xml:id="S4.SS5.SSS0.Px2.p3.m1" tex="t=\operatorname*{arg\,max}_{i}y_{i}" content-tex="t=\argmax_{i}y_{i}" text="t = (argmax _ i)@(y _ i)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMDual role="OPFUNCTION"><XMTok name="argmax" role="OPFUNCTION" scriptpos="mid"/><XMApp role="OPERATOR" scriptpos="mid"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok><XMTok role="UNKNOWN">max</XMTok></XMApp></XMDual><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp></XMath></Math> the correct
class, and by <Math mode="inline" xml:id="S4.SS5.SSS0.Px2.p3.m2" tex="k=\operatorname*{arg\,max}_{i\neq t}\hat{y}_{i}" content-tex="k=\argmax_{i\neq t}\hat{y}_{i}" text="k = (argmax _ (i not-equals t))@((hat@(y)) _ i)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMDual role="OPFUNCTION"><XMTok name="argmax" role="OPFUNCTION" scriptpos="mid"/><XMApp role="OPERATOR" scriptpos="mid"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok><XMTok role="UNKNOWN">max</XMTok></XMApp></XMDual><XMApp><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp></XMath></Math> the highest scoring class such that <Math mode="inline" xml:id="S4.SS5.SSS0.Px2.p3.m3" tex="k\neq t" text="k not-equals t"><XMath><XMApp><XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math>.
The multiclass hinge loss is defined as:</p>
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx9">
            <equation xml:id="S4.Ex31">
              <MathFork>
                <Math xml:id="S4.Ex31.m2" tex="\displaystyle L_{hinge(multiclass)}(\mathbf{\hat{y}},\mathbf{y})=\max(0,1-(%&#10;\hat{y}_{t}-\hat{y}_{k}))" text="L _ (h * i * n * g * e * m * u * l * t * i * c * l * a * s * s) * open-interval@(hat@(y), y) = maximum@(0, 1 - (hat@(y)) _ t - (hat@(y)) _ k)">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">h</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok role="UNKNOWN" font="italic">g</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                            <XMDual>
                              <XMRef idref="XM416"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM416">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">m</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM417"/>
                            <XMRef idref="XM418"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM417">
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="bold">y</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM418" font="bold">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM420"/>
                          <XMRef idref="XM421"/>
                          <XMRef idref="XM422"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM420">max</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="XM421">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM422">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMRef idref="XM419"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM419">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMApp>
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                      </XMApp>
                                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                      <XMApp>
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                      </XMApp>
                                      <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{hinge(multiclass)}(\mathbf{\hat{y}},\mathbf{y})=\max(0,1-(%&#10;\hat{y}_{t}-\hat{y}_{k}))" xml:id="S4.Ex31.m1" text="L _ (h * i * n * g * e * m * u * l * t * i * c * l * a * s * s) * open-interval@(hat@(y), y) = maximum@(0, 1 - (hat@(y)) _ t - (hat@(y)) _ k)">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                                <XMDual>
                                  <XMRef idref="XM423"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM423">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">m</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM424"/>
                                <XMRef idref="XM425"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM424">
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">y</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM425" font="bold">y</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="XM427"/>
                              <XMRef idref="XM428"/>
                              <XMRef idref="XM429"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM427">max</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="XM428">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM429">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM426"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM426">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                          <XMApp>
                                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                          </XMApp>
                                          <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                          <XMApp>
                                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                          </XMApp>
                                          <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <!-- %**** root.tex Line 975 **** -->
        <para xml:id="S4.SS5.SSS0.Px2.p4" class="ltx_noindent">
          <p>The multiclass hinge loss attempts to score the correct class above
all other classes with a margin of at least 1.</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px2.p5">
          <p>Both the binary and multiclass hinge losses are intended to be used with a
linear output layer. The hinge losses are useful whenever we require a hard
decision rule, and do not attempt to model class membership probability.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS5.SSS0.Px3">
        <title>Log loss</title>
        <para xml:id="S4.SS5.SSS0.Px3.p1">
          <p>The log loss is a common variation of the hinge loss, which
can be seen as a “soft” version of the hinge loss with an infinite margin
<cite>[<bibref bibrefs="lecun2006tutorial" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px3.p2">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx10">
            <equation xml:id="S4.Ex32">
              <MathFork>
                <Math xml:id="S4.Ex32.m2" tex="\displaystyle L_{log}(\mathbf{\hat{y}},\mathbf{y})=\log(1+exp(-(\hat{y}_{t}-%&#10;\hat{y}_{k}))">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">l</XMTok>
                        <XMTok role="UNKNOWN" font="italic">o</XMTok>
                        <XMTok role="UNKNOWN" font="italic">g</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM430">
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok role="UNKNOWN" font="bold">y</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM431" font="bold">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                          </XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMWrap>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{log}(\mathbf{\hat{y}},\mathbf{y})=\log(1+exp(-(\hat{y}_{t}-%&#10;\hat{y}_{k}))" xml:id="S4.Ex32.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">l</XMTok>
                            <XMTok role="UNKNOWN" font="italic">o</XMTok>
                            <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM438">
                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                            <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM439" font="bold">y</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok role="UNKNOWN" font="italic">e</XMTok>
                          <XMTok role="UNKNOWN" font="italic">x</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              </XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMWrap>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <!-- %“paragraph–Binary cross entropy˝ The binary 
     %cross-entropy loss, also referred to as “emph–logistic loss˝ is used in binary classification with
     %conditional probability outputs. We assume a set of two target classes labeled
     %0 and 1, with a correct label $y “in “–0,1“˝$.
     %The classifier’s output $“hat–y˝$ is transformed using the sigmoid (also called
     %the logistic) function
     %$“sigma(x) = 1/(1+e^–-x˝)$ to
     %the range $[0,1]$, and is interpreted as the conditional probability
     %$“hat–y˝ = P(y=1—“m–x˝)$. The prediction rule is:
     %“begin–align*˝
     %**** root.tex Line 1000 ****
     %prediction = “begin–cases˝
     %0 & “hat–y˝ ¡ 0.5 ““
     %1 & “hat–y˝ “geq 0.5
     %“end–cases˝
     %“end–align*˝
     %The network is trained to maximize the log conditional probability $“log
     %P(y=1—“m–x˝)$ for each training example $(“m–x˝,y)$.  The logistic loss is defined
     %as:
     %“begin–align*˝
     %L˙–logistic˝(“hat–y˝,y) = -y“log“hat–y˝ - (1-y)“log(1-“hat–y˝)
     %“end–align*˝
     %The logistic loss is useful when we want the network to produce class
     %conditional probability for a binary classification problem. When using the
     %logistic loss, it is assumed that the output layer is transformed using the
     %sigmoid activation function.-->
      </paragraph>
      <paragraph xml:id="S4.SS5.SSS0.Px4" labels="LABEL:sec:crossent">
        <title>Categorical cross-entropy loss</title>
        <para xml:id="S4.SS5.SSS0.Px4.p1">
          <p>The categorical cross-entropy loss (also referred to as <emph>negative log
likelihood</emph>) is
used when a probabilistic interpretation of the scores is desired.</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p2">
          <p>Let <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m1" tex="\mathbf{y}=y_{1},\ldots,y_{n}" text="y = list@(y _ 1, ldots, y _ n)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM446"/><XMRef idref="XM447"/><XMRef idref="XM448"/></XMApp><XMWrap><XMApp xml:id="XM446"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM447">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM448"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMApp></XMath></Math> be a vector representing
<!-- %**** root.tex Line 1025 **** -->the true multinomial distribution over the labels <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m2" tex="1,\ldots,n" text="list@(1, ldots, n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM449"/><XMRef idref="XM450"/><XMRef idref="XM451"/></XMApp><XMWrap><XMTok meaning="1" role="NUMBER" xml:id="XM449">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM450">…</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM451" font="italic">n</XMTok></XMWrap></XMDual></XMath></Math>, and let
<Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m3" tex="\mathbf{\hat{y}}=\hat{y_{1}},\ldots,\hat{y_{n}}" text="hat@(y) = list@(hat@(y _ 1), ldots, hat@(y _ n))"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM452"/><XMRef idref="XM453"/><XMRef idref="XM454"/></XMApp><XMWrap><XMApp xml:id="XM452"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM453">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM454"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMWrap></XMDual></XMApp></XMath></Math> be the network’s output, which was
transformed by the <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m4" tex="softmax" text="s * o * f * t * m * a * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> activation function, and represent the class
membership conditional distribution <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m5" tex="\hat{y}_{i}=P(y=i|\mathbf{x})"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>.
The categorical cross entropy loss measures the dissimilarity between the true label distribution
<Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m6" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math> and the predicted label distribution <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p2.m7" tex="\mathbf{\hat{y}}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp></XMath></Math>, and is defined as
cross entropy:</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p3">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx11">
            <equation xml:id="S4.Ex33">
              <MathFork>
                <Math xml:id="S4.Ex33.m2" tex="\displaystyle L_{cross-entropy}(\mathbf{\hat{y}},\mathbf{y})=-\sum_{i}y_{i}%&#10;\log(\hat{y}_{i})" text="L _ (c * r * o * s * s - e * n * t * r * o * p * y) * open-interval@(hat@(y), y) = - (sum _ i)@(y _ i * logarithm@((hat@(y)) _ i))">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">c</XMTok>
                              <XMTok role="UNKNOWN" font="italic">r</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">e</XMTok>
                              <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok role="UNKNOWN" font="italic">r</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">p</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM455"/>
                            <XMRef idref="XM456"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM455">
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="bold">y</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM456" font="bold">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="XM457"/>
                                <XMRef idref="XM458"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM457">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM458">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMApp>
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                    </XMApp>
                                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{cross-entropy}(\mathbf{\hat{y}},\mathbf{y})=-\sum_{i}y_{i}%&#10;\log(\hat{y}_{i})" xml:id="S4.Ex33.m1" text="L _ (c * r * o * s * s - e * n * t * r * o * p * y) * open-interval@(hat@(y), y) = - (sum _ i)@(y _ i * logarithm@((hat@(y)) _ i))">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">e</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">p</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM459"/>
                                <XMRef idref="XM460"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM459">
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">y</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM460" font="bold">y</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMApp scriptpos="mid">
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="XM461"/>
                                    <XMRef idref="XM462"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM461">log</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM462">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                        <XMApp>
                                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                        </XMApp>
                                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p4">
          <p>For hard classification problems in which each training example has a single
correct class assignment, <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p4.m1" tex="\mathbf{y}" text="y"><XMath><XMTok role="UNKNOWN" font="bold">y</XMTok></XMath></Math> is a one-hot vector representing the true
class. In such cases, the cross entropy can be simplified to:</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p5">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx12">
            <equation xml:id="S4.Ex34">
              <MathFork>
                <Math xml:id="S4.Ex34.m2" tex="\displaystyle L_{cross-entropy(\text{hard classification})}(\mathbf{\hat{y}},%&#10;\mathbf{y})=-\log(\hat{y}_{t})" text="L _ (c * r * o * s * s - e * n * t * r * o * p * y * [hard classification]) * open-interval@(hat@(y), y) = - logarithm@((hat@(y)) _ t)">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">c</XMTok>
                              <XMTok role="UNKNOWN" font="italic">r</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                              <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">e</XMTok>
                              <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              <XMTok role="UNKNOWN" font="italic">r</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">p</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">y</XMTok>
                              <XMDual>
                                <XMRef idref="XM463"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMText xml:id="XM463">hard classification</XMText>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM464"/>
                            <XMRef idref="XM465"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM464">
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok role="UNKNOWN" font="bold">y</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM465" font="bold">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="XM466"/>
                            <XMRef idref="XM467"/>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM466">log</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM467">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">t</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{cross-entropy(\text{hard classification})}(\mathbf{\hat{y}},%&#10;\mathbf{y})=-\log(\hat{y}_{t})" xml:id="S4.Ex34.m1" text="L _ (c * r * o * s * s - e * n * t * r * o * p * y * [hard classification]) * open-interval@(hat@(y), y) = - logarithm@((hat@(y)) _ t)">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">e</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">p</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">y</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM468"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMText xml:id="XM468">hard classification</XMText>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM469"/>
                                <XMRef idref="XM470"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM469">
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">y</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM470" font="bold">y</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="XM471"/>
                                <XMRef idref="XM472"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM471">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM472">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                    <XMApp>
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                    </XMApp>
                                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p6" class="ltx_noindent">
          <p>where <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p6.m1" tex="t" text="t"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> is the correct class assignment. This attempts to set the
probability mass assigned to the correct class <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p6.m2" tex="t" text="t"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math> to 1. Because the scores
<Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p6.m3" tex="\mathbf{\hat{y}}" text="hat@(y)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">y</XMTok></XMApp></XMath></Math> have been transformed using the <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p6.m4" tex="softmax" text="s * o * f * t * m * a * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> function and represent a
conditional distribution, increasing the mass assigned to the correct class
means decreasing the mass assigned to all the other classes.
<!-- %**** root.tex Line 1050 **** --></p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px4.p7">
          <p>The cross-entropy loss is very common in the neural networks literature, and
produces a multi-class classifier which does not only predict the one-best
class label but but also predicts a distribution over the possible labels. When
using the cross-entropy loss, it is assumed that the network’s output is transformed
using the <Math mode="inline" xml:id="S4.SS5.SSS0.Px4.p7.m1" tex="softmax" text="s * o * f * t * m * a * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> transformation.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S4.SS5.SSS0.Px5">
        <title>Ranking losses</title>
        <para xml:id="S4.SS5.SSS0.Px5.p1">
          <p>In some settings, we are not given supervision in
term of labels, but rather as pairs of correct and incorrect items <Math mode="inline" xml:id="S4.SS5.SSS0.Px5.p1.m1" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> and
<Math mode="inline" xml:id="S4.SS5.SSS0.Px5.p1.m2" tex="\mathbf{x^{\prime}}" text="x ^ prime"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMath></Math>, and our goal is to score correct items above incorrect ones. Such
training situations arise when we have only positive examples, and generate
negative examples by corrupting a positive example.
A useful loss in such scenarios is the margin-based ranking
loss, defined for a pair of correct and incorrect examples:</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px5.p2">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx13">
            <equation xml:id="S4.Ex35">
              <MathFork>
                <Math xml:id="S4.Ex35.m2" tex="\displaystyle L_{ranking(margin)}(\mathbf{x},\mathbf{x^{\prime}})=\max(0,1-(NN%&#10;(\mathbf{x})-NN(\mathbf{x^{\prime}})))" text="L _ (r * a * n * k * i * n * g * m * a * r * g * i * n) * open-interval@(x, x ^ prime) = maximum@(0, 1 - N * N * x - N * N * x ^ prime)">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMTok role="UNKNOWN" font="italic">a</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                            <XMDual>
                              <XMRef idref="XM473"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM473">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">m</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM474"/>
                            <XMRef idref="XM475"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM474" font="bold">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM475">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM479"/>
                          <XMRef idref="XM480"/>
                          <XMRef idref="XM481"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM479">max</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="XM480">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM481">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMRef idref="XM478"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM478">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                      <XMDual>
                                        <XMRef idref="XM476"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok role="UNKNOWN" xml:id="XM476" font="bold">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                      <XMDual>
                                        <XMRef idref="XM477"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="XM477">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                            <XMTok name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{ranking(margin)}(\mathbf{x},\mathbf{x^{\prime}})=\max(0,1-(NN%&#10;(\mathbf{x})-NN(\mathbf{x^{\prime}})))" xml:id="S4.Ex35.m1" text="L _ (r * a * n * k * i * n * g * m * a * r * g * i * n) * open-interval@(x, x ^ prime) = maximum@(0, 1 - N * N * x - N * N * x ^ prime)">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                                <XMDual>
                                  <XMRef idref="XM482"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM482">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">m</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM483"/>
                                <XMRef idref="XM484"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM483" font="bold">x</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM484">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="XM488"/>
                              <XMRef idref="XM489"/>
                              <XMRef idref="XM490"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="XM488">max</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="XM489">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM490">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM487"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM487">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                          <XMDual>
                                            <XMRef idref="XM485"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok role="UNKNOWN" xml:id="XM485" font="bold">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                          <XMDual>
                                            <XMRef idref="XM486"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="XM486">
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                                <XMTok name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S4.SS5.SSS0.Px5.p3" class="ltx_noindent">
          <p>where <Math mode="inline" xml:id="S4.SS5.SSS0.Px5.p3.m1" tex="NN(\mathbf{x})" text="N * N * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok><XMDual><XMRef idref="XM491"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM491" font="bold">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is the score assigned by the network for input vector
<Math mode="inline" xml:id="S4.SS5.SSS0.Px5.p3.m2" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math>. The objective is to score (rank) correct inputs over incorrect ones with a
margin of at least 1.</p>
        </para>
        <para xml:id="S4.SS5.SSS0.Px5.p4">
          <p>A common variation is to use the log version of the ranking loss:</p>
        </para>
        <!-- %**** root.tex Line 1075 **** -->
        <para xml:id="S4.SS5.SSS0.Px5.p5">
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx14">
            <equation xml:id="S4.Ex36">
              <MathFork>
                <Math xml:id="S4.Ex36.m2" tex="\displaystyle L_{ranking(log)}(\mathbf{x},\mathbf{x^{\prime}})=\log(1+exp(-(NN%&#10;(\mathbf{x})-NN(\mathbf{x^{\prime}}))))" text="L _ (r * a * n * k * i * n * g * l * o * g) * open-interval@(x, x ^ prime) = logarithm@(1 + e * x * p * (- N * N * x - N * N * x ^ prime))">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMTok role="UNKNOWN" font="italic">a</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok role="UNKNOWN" font="italic">k</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                            <XMDual>
                              <XMRef idref="XM492"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM492">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM493"/>
                            <XMRef idref="XM494"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM493" font="bold">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM494">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM501"/>
                          <XMRef idref="XM502"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM501">log</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM502">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">e</XMTok>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                <XMTok role="UNKNOWN" font="italic">p</XMTok>
                                <XMDual>
                                  <XMRef idref="XM500"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM500">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMDual>
                                        <XMRef idref="XM499"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="XM499">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM495"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok role="UNKNOWN" xml:id="XM495" font="bold">x</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                              <XMDual>
                                                <XMRef idref="XM498"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM498">
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                                    <XMTok name="prime" role="SUPOP">′</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle L_{ranking(log)}(\mathbf{x},\mathbf{x^{\prime}})=\log(1+exp(-(NN%&#10;(\mathbf{x})-NN(\mathbf{x^{\prime}}))))" xml:id="S4.Ex36.m1" text="L _ (r * a * n * k * i * n * g * l * o * g) * open-interval@(x, x ^ prime) = logarithm@(1 + e * x * p * (- N * N * x - N * N * x ^ prime))">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" font="italic">r</XMTok>
                                <XMTok role="UNKNOWN" font="italic">a</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                                <XMDual>
                                  <XMRef idref="XM503"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM503">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">l</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM504"/>
                                <XMRef idref="XM505"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM504" font="bold">x</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM505">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="XM512"/>
                              <XMRef idref="XM513"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="XM512">log</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM513">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">e</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">p</XMTok>
                                    <XMDual>
                                      <XMRef idref="XM511"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="XM511">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMDual>
                                            <XMRef idref="XM510"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="XM510">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="XM506"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok role="UNKNOWN" xml:id="XM506" font="bold">x</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok role="UNKNOWN" font="italic">N</XMTok>
                                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="XM509"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="XM509">
                                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                                        <XMTok name="prime" role="SUPOP">′</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S4.SS5.SSS0.Px5.p6">
          <p>Examples using the ranking hinge loss in language tasks include training with the
auxiliary tasks used for deriving pre-trained word embeddings
(see section <ref labelref="LABEL:sec:word-embed"/>), in which we are given a correct word sequence and a
corrupted word sequence, and our goal is to score the correct sequence above
the corrupt one <cite>[<bibref bibrefs="collobert2008unified" separator="," show="Refnum" yyseparator=","/>]</cite>. Similarly, Van de Cruys <ERROR class="undefined">\citeyear</ERROR>vandecruys2014neural used the
ranking loss in a selectional-preferences task, in which the network was trained
to rank correct verb-object pairs above incorrect, automatically derived ones,
and <cite>[<bibref bibrefs="weston2013connecting" separator="," show="Refnum" yyseparator=","/>]</cite> trained a model to score correct
(head,relation,trail) triplets above corrupted ones in an information-extraction
setting. An example of using the ranking log loss can be found in
<cite>[<bibref bibrefs="gao2014modeling" separator="," show="Refnum" yyseparator=","/>]</cite>. A variation of the ranking log loss allowing for a
different margin for the negative and positive class is given in <cite>[<bibref bibrefs="dossantos2015classifying" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
        <pagination role="newpage"/>
      </paragraph>
    </subsection>
  </section>
  <section refnum="5" xml:id="S5" labels="LABEL:sec:word-embed">
    <title><tag close=" ">5</tag>Word Embeddings</title>
    <para xml:id="S5.p1">
      <p>A main component of the neural-network approach is the use of embeddings – representing each feature as a vector in a low dimensional space.
<!-- %**** root.tex Line 1100 **** -->But where do the vectors come from? This section will survey the common approaches.</p>
    </para>
    <subsection refnum="5.1" xml:id="S5.SS1">
      <title><tag close=" ">5.1</tag>Random Initialization</title>
      <para xml:id="S5.SS1.p1">
        <p>When enough supervised training data is available, one can just treat the feature
embeddings the same as the other model parameters: initialize the embedding
vectors to random values, and let the network-training procedure tune them into “good” vectors.</p>
      </para>
      <para xml:id="S5.SS1.p2">
        <p>Some care has to be taken in the way the random initialization is performed. The
method used by the effective word2vec implementation
<cite>[<bibref bibrefs="mikolov2013efficient,mikolov2013distributed" separator="," show="Refnum" yyseparator=","/>]</cite> is to initialize the word
vectors to uniformly sampled random numbers in the range <Math mode="inline" xml:id="S5.SS1.p2.m1" tex="[-\frac{1}{2d},\frac{1}{2d}]" text="closed-interval@(- 1 / (2 * d), 1 / (2 * d))"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM514"/><XMRef idref="XM515"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM514"><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM515"><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math> where <Math mode="inline" xml:id="S5.SS1.p2.m2" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> is the number of dimensions. Another option is to use
<emph>xavier initialization</emph> (see Section <ref labelref="LABEL:sec:glorot-init"/>) and initialize with
uniformly
sampled values from <Math mode="inline" xml:id="S5.SS1.p2.m3" tex="\left[-\frac{\sqrt{6}}{\sqrt{d}},\frac{\sqrt{6}}{\sqrt{d}}\right]" text="closed-interval@(- square-root@(6) / square-root@(d), square-root@(6) / square-root@(d))"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM516"/><XMRef idref="XM517"/></XMApp><XMWrap><XMTok role="OPEN">[</XMTok><XMApp xml:id="XM516"><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMApp><XMTok meaning="square-root"/><XMTok meaning="6" role="NUMBER">6</XMTok></XMApp><XMApp><XMTok meaning="square-root"/><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM517"><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMApp><XMTok meaning="square-root"/><XMTok meaning="6" role="NUMBER">6</XMTok></XMApp><XMApp><XMTok meaning="square-root"/><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp><XMTok role="CLOSE">]</XMTok></XMWrap></XMDual></XMath></Math>.</p>
      </para>
      <para xml:id="S5.SS1.p3">
        <p>In practice, one will often use the random initialization approach to initialize
the embedding vectors of commonly occurring features, such as part-of-speech
tags or individual letters, while using some form of supervised or unsupervised
pre-training to initialize the potentially rare features, such as features for
individual words. The pre-trained vectors can then either be treated as fixed
during the network training process, or, more commonly, treated like the
randomly-initialized vectors and further tuned to the task at hand.</p>
      </para>
      <!-- %**** root.tex Line 1125 **** -->
    </subsection>
    <subsection refnum="5.2" xml:id="S5.SS2">
      <title><tag close=" ">5.2</tag>Supervised Task-specific Pre-training</title>
      <para xml:id="S5.SS2.p1">
        <p>If we are interested in task A, for which we only have a limited amount of
labeled data (for example, syntactic parsing), but there is an auxiliary task B
(say, part-of-speech tagging) for which we have much more labeled data, we may
want to pre-train our word vectors so that they perform well as predictors for task B, and
then use the trained vectors for training task A. In this way, we can utilize
the larger amounts of labeled data we have for task B. When training
task A we can either treat the pre-trained vectors as fixed, or tune them
further for task A.
Another option is to train jointly for both objectives, see Section <ref labelref="LABEL:sec:joint"/> for more details.</p>
      </para>
    </subsection>
    <subsection refnum="5.3" xml:id="S5.SS3">
      <title><tag close=" ">5.3</tag>Unsupervised Pre-training</title>
      <para xml:id="S5.SS3.p1">
        <p>The common case is that we do not have an auxiliary task with large enough
amounts of annotated data (or maybe we want to help bootstrap the auxiliary task
training with better vectors). In such cases, we resort to “unsupervised”
methods, which can be trained on huge amounts of unannotated text.</p>
      </para>
      <para xml:id="S5.SS3.p2">
        <p>The techniques for training the word vectors are essentially those of supervised
learning, but instead of supervision for the task that we care about, we instead
create practically unlimited number of supervised training instances from raw
text, hoping that the tasks that we created will match (or be close enough to) the
final task we care about.<note mark="12" role="footnote">The interpretation of creating auxiliary problems from
raw text is inspired by Ando and Zhang <cite>[<bibref bibrefs="ando2005highperformance,ando2005framework" separator="," show="Refnum" yyseparator=","/>]</cite>.</note>
<!-- %**** root.tex Line 1150 **** --></p>
      </para>
      <para xml:id="S5.SS3.p3">
        <p>The key idea behind the unsupervised approaches is that one would like the
embedding vectors of “similar” words to have similar vectors. While word
similarity is hard to define and is usually very task-dependent, the current
approaches derive from the distributional hypothesis <cite>[<bibref bibrefs="harris1954distributional" separator="," show="Refnum" yyseparator=","/>]</cite>,
stating that <emph>words are similar if they appear in similar contexts</emph>. The different
methods all create supervised training instances in which the goal is to either
predict the word from its context, or predict the context from the word.</p>
      </para>
      <para xml:id="S5.SS3.p4">
        <p>An important benefit of training word embeddings on large amounts of unannotated
data is that it provides vector representations for words that do not appear in
the supervised training set. Ideally, the representations for these words will
be similar to those of related words that do appear in the training set,
allowing the model to generalize better on unseen events. It is thus desired
that
the similarity between word vectors learned by the unsupervised algorithm
captures the same aspects of similarity that are useful for performing the
intended task of the network.</p>
      </para>
      <para xml:id="S5.SS3.p5">
        <p>Common unsupervised word-embedding algorithms include <text font="typewriter">word2vec</text>
<note mark="13" role="footnote">While often treated as a single algorithm, <text font="typewriter">word2vec</text> is
actually a software package including various training objectives, optimization
methods and other hyperparameters. See <cite>[<bibref bibrefs="rong2014word2vec,levy2015improving" separator="," show="Refnum" yyseparator=","/>]</cite> for a discussion.</note>
<!-- %**** root.tex Line 1175 **** --><cite>[<bibref bibrefs="mikolov2013distributed,mikolov2013efficient" separator="," show="Refnum" yyseparator=","/>]</cite>, <text font="typewriter">GloVe</text> <cite>[<bibref bibrefs="pennington2014glove" separator="," show="Refnum" yyseparator=","/>]</cite> and the Collobert and Weston
<ERROR class="undefined">\citeyear</ERROR>collobert2008unified,collobert2011natural embeddings algorithm. These models are inspired by neural
networks and are based on stochastic gradient training. However, they are
deeply connected to another family of algorithms which evolved in the NLP and IR
communities, and that are based on matrix factorization (see <cite>[<bibref bibrefs="levy2014neural,levy2015improving" separator="," show="Refnum" yyseparator=","/>]</cite>
for a discussion).</p>
      </para>
      <!-- %It is our belief that -->
      <para xml:id="S5.SS3.p6">
        <p>Arguably, the choice of auxiliary problem (what is being predicted, based
on what kind of context) affects the resulting vectors much more than the learning
method that is being used to train them. We thus focus on the different
choices of auxiliary problems that are available, and only skim over the details
of the training methods. Several software packages for deriving word vectors
are available, including word2vec<note mark="14" role="footnote"><ref class="ltx_url" href="https://code.google.com/p/word2vec/"><text font="typewriter">https://code.google.com/p/word2vec/</text></ref></note> and Gensim<note mark="15" role="footnote"><ref class="ltx_url" href="https://radimrehurek.com/gensim/"><text font="typewriter">https://radimrehurek.com/gensim/</text></ref></note>
implementing the word2vec models with word-windows based contexts,
word2vecf<note mark="16" role="footnote"><ref class="ltx_url" href="https://bitbucket.org/yoavgo/word2vecf"><text font="typewriter">https://bitbucket.org/yoavgo/word2vecf</text></ref></note> which is a modified version of word2vec allowing
the use of arbitrary contexts, and GloVe<note mark="17" role="footnote"><ref class="ltx_url" href="http://nlp.stanford.edu/projects/glove/"><text font="typewriter">http://nlp.stanford.edu/projects/glove/</text></ref></note> implementing the GloVe model.
Many pre-trained word vectors are also available for download on the web.</p>
      </para>
      <para xml:id="S5.SS3.p7">
        <p>While beyond the scope of this tutorial, it is worth noting that the word
embeddings derived by unsupervised training algorithms have a wide range of
applications in NLP beyond using them for initializing the word-embeddings layer
of a neural-network model.</p>
      </para>
    </subsection>
    <subsection refnum="5.4" xml:id="S5.SS4">
      <title><tag close=" ">5.4</tag>Training Objectives</title>
      <!-- %**** root.tex Line 1200 **** -->
      <para xml:id="S5.SS4.p1">
        <p>Given a word <Math mode="inline" xml:id="S5.SS4.p1.m1" tex="w" text="w"><XMath><XMTok role="UNKNOWN" font="italic">w</XMTok></XMath></Math> and its context <Math mode="inline" xml:id="S5.SS4.p1.m2" tex="c" text="c"><XMath><XMTok role="UNKNOWN" font="italic">c</XMTok></XMath></Math>, different algorithms formulate different
auxiliary tasks. In all cases, each word is represented as a <Math mode="inline" xml:id="S5.SS4.p1.m3" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional
vector which is initialized to a random value. Training the model to perform the
auxiliary tasks well will result in good word embeddings for relating the words
to the contexts, which in turn will result in the embedding vectors for similar
words to be similar to each other.</p>
      </para>
      <para xml:id="S5.SS4.p2">
        <p>Language-modeling inspired approaches such as those taken by
<cite>[<bibref bibrefs="mikolov2013distributed,mnih2013learning" separator="," show="Refnum" yyseparator=","/>]</cite> as well as GloVe <cite>[<bibref bibrefs="pennington2014glove" separator="," show="Refnum" yyseparator=","/>]</cite>
use auxiliary tasks in which the goal
is to predict the word given its context. This is posed in a probabilistic
setup, trying to model the conditional probability <Math mode="inline" xml:id="S5.SS4.p2.m1" tex="P(w|c)"><XMath><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">w</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>.</p>
      </para>
      <para xml:id="S5.SS4.p3">
        <p>Other approaches reduce the problem to that of binary classification.
In addition to the set <Math mode="inline" xml:id="S5.SS4.p3.m1" tex="D" text="D"><XMath><XMTok role="UNKNOWN" font="italic">D</XMTok></XMath></Math> of observed word-context pairs, a set
<Math mode="inline" xml:id="S5.SS4.p3.m2" tex="\bar{D}" text="bar@(D)"><XMath><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">D</XMTok></XMApp></XMath></Math> is created from random words and context pairings.
The binary classification problem is then: does the given <Math mode="inline" xml:id="S5.SS4.p3.m3" tex="(w,c)" text="open-interval@(w, c)"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM518"/><XMRef idref="XM519"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM518" font="italic">w</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM519" font="italic">c</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> pair come from
<Math mode="inline" xml:id="S5.SS4.p3.m4" tex="D" text="D"><XMath><XMTok role="UNKNOWN" font="italic">D</XMTok></XMath></Math> or not? The approaches differ in how the set <Math mode="inline" xml:id="S5.SS4.p3.m5" tex="\bar{D}" text="bar@(D)"><XMath><XMApp><XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok><XMTok role="UNKNOWN" font="italic">D</XMTok></XMApp></XMath></Math> is constructed, what is the
structure of the classifier, and what is the objective being optimized.
Collobert and Weston <ERROR class="undefined">\citeyear</ERROR>collobert2008unified,collobert2011natural take a margin-based binary ranking
approach, training a feed-forward neural network to score correct <Math mode="inline" xml:id="S5.SS4.p3.m6" tex="(w,c)" text="open-interval@(w, c)"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM520"/><XMRef idref="XM521"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM520" font="italic">w</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM521" font="italic">c</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> pairs
over incorrect ones.
Mikolov et al <ERROR class="undefined">\citeyear</ERROR>mikolov2013distributed,goldberg2014word2vec take instead a probabilistic version, training a
log-bilinear model to predict the probability <Math mode="inline" xml:id="S5.SS4.p3.m7" tex="P((w,c)\in D|w,c)"><XMath><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM522" font="italic">w</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM523" font="italic">c</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">D</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" xml:id="XM524" font="italic">w</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM525" font="italic">c</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> that the pair come from the
<!-- %**** root.tex Line 1225 **** -->corpus rather than the random sample.</p>
      </para>
    </subsection>
    <subsection refnum="5.5" xml:id="S5.SS5">
      <title><tag close=" ">5.5</tag>The Choice of Contexts</title>
      <para xml:id="S5.SS5.p1">
        <p>In most cases, the contexts of a word are taken to be other words that appear in
its surrounding, either in a short window around it, or within the same
sentence, paragraph or document. In some cases the text is automatically parsed
by a syntactic parser, and the contexts are derived from the syntactic
neighbourhood induced by the automatic parse trees. Sometimes, the definitions
of words and context change to include also parts of words, such as prefixes or
suffixes.</p>
      </para>
      <para xml:id="S5.SS5.p2">
        <p>Neural word embeddings originated from the world of language modeling, in which
a network is trained to predict the next word based on a sequence of preceding
words <cite>[<bibref bibrefs="bengio2003neural" separator="," show="Refnum" yyseparator=","/>]</cite>. There, the text is used to create auxiliary tasks in
which the aim is to predict a word based on a context the <Math mode="inline" xml:id="S5.SS5.p2.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> previous words.
While training for the language modeling auxiliary prediction problems indeed
produce useful embeddings, this approach is needlessly restricted by the
constraints of the language modeling task, in which one is allowed to look only
at the previous words.
If we do not care about language modeling but only about the resulting
embeddings, we may do better by ignoring this constraint and taking the context
to be a symmetric window around the focus word.</p>
      </para>
      <subsubsection refnum="5.5.1" xml:id="S5.SS5.SSS1">
        <title><tag close=" ">5.5.1</tag>Window Approach</title>
        <para xml:id="S5.SS5.SSS1.p1">
          <p>The most common approach is a sliding window
<!-- %**** root.tex Line 1250 **** -->approach, in which auxiliary tasks are created by looking at a sequence of
<Math mode="inline" xml:id="S5.SS5.SSS1.p1.m1" tex="2k+1" text="2 * k + 1"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> words. The middle word is callled the <emph>focus word</emph> and the <Math mode="inline" xml:id="S5.SS5.SSS1.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> words
to each side are the <emph>contexts</emph>. Then, either a single task is created in
which the goal is to predict the focus word based on all of the context words
(represented either using CBOW <cite>[<bibref bibrefs="mikolov2013efficient" separator="," show="Refnum" yyseparator=","/>]</cite> or vector concatenation
<cite>[<bibref bibrefs="collobert2008unified" separator="," show="Refnum" yyseparator=","/>]</cite>), or <Math mode="inline" xml:id="S5.SS5.SSS1.p1.m3" tex="2k" text="2 * k"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMath></Math> distinct tasks are created, each pairing the focus
word with a different context word. The <Math mode="inline" xml:id="S5.SS5.SSS1.p1.m4" tex="2k" text="2 * k"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMath></Math> tasks approach, popularized by
<cite>[<bibref bibrefs="mikolov2013distributed" separator="," show="Refnum" yyseparator=","/>]</cite> is referred to as a <emph>skip-gram</emph> model. Skip-gram
based approaches are shown to be robust and efficient to train
<cite>[<bibref bibrefs="mikolov2013distributed,pennington2014glove" separator="," show="Refnum" yyseparator=","/>]</cite>, and often produce state of the art results.</p>
        </para>
        <paragraph xml:id="S5.SS5.SSS1.Px1">
          <title>Effect of Window Size</title>
          <para xml:id="S5.SS5.SSS1.Px1.p1">
            <p>The size of the sliding window has a strong
effect on the resulting vector similarities. Larger windows tend to produce more
topical similarities (i.e. “dog”, “bark” and “leash” will be grouped
together, as well as “walked”, “run” and “walking”), while smaller windows
tend to produce more functional and syntactic similarities (i.e. “Poodle”,
“Pitbull”, “Rottweiler”, or “walking”,“running”,“approaching”).</p>
          </para>
        </paragraph>
        <paragraph xml:id="S5.SS5.SSS1.Px2">
          <title>Positional Windows</title>
          <para xml:id="S5.SS5.SSS1.Px2.p1">
            <p>When using the CBOW or skip-gram context
representations, all the different context words within the window are treated
equally. There is no distinction between context words that are close to the
focus words and those that are farther from it, and likewise there is no
distinction between context words that appear before the focus words to context
words that appear after it. Such information can easily be factored in by using
<emph>positional contexts</emph>: indicating for each context word also its relative
<!-- %**** root.tex Line 1275 **** -->position to the focus words (i.e. instead of the context word being “the” it
becomes “the:+2”, indicating the word appears two positions to the right of
the focus word). The use of positional context together with smaller windows
tend to produce similarities that are more syntactic, with a strong tendency of
grouping together words that share a part of speech, as well as being
functionally similar in terms of their semantics. Positional vectors were shown
by <cite>[<bibref bibrefs="ling2015twotoo" separator="," show="Refnum" yyseparator=","/>]</cite> to be more effective than window-based vectors when
used to initialize networks for part-of-speech tagging and syntactic dependency
parsing.</p>
          </para>
        </paragraph>
        <paragraph xml:id="S5.SS5.SSS1.Px3">
          <title>Variants</title>
          <para xml:id="S5.SS5.SSS1.Px3.p1">
            <p>Many variants on the window approach are possible. One may
lemmatize words before learning, apply text normalization, filter too short or
too long sentences, or remove capitalization (see, e.g., the pre-processing
steps described in <cite>[<bibref bibrefs="dossantos2014deep" separator="," show="Refnum" yyseparator=","/>]</cite>. One may sub-sample part of the corpus,
skipping with some probability the creation of tasks from windows that have too common or too rare
focus words. The window size may be dynamic, using a different window size at
each turn. One may weigh the different positions in the window differently,
focusing more on trying to predict correctly close word-context pairs than
further away ones. Each of these choices will effect the resulting vectors.
Some of these hyperparameters (and others) are discussed in <cite>[<bibref bibrefs="levy2015improving" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
          </para>
        </paragraph>
      </subsubsection>
      <subsubsection refnum="5.5.2" xml:id="S5.SS5.SSS2">
        <title><tag close=" ">5.5.2</tag>Sentences, Paragraphs or Documents</title>
        <para xml:id="S5.SS5.SSS2.p1">
          <p>Using a skip-grams (or CBOW)
approach, one can consider the contexts of a word to be all the other words that
appear with it in the same sentence, paragraph or document. This is equivalent
to using very large window sizes, and is expected to result in word vectors that
<!-- %**** root.tex Line 1300 **** -->capture topical similarity (words from the same topic, i.e. words that one would
expect to appear in the same document, are likely to receive similar vectors).</p>
        </para>
      </subsubsection>
      <subsubsection refnum="5.5.3" xml:id="S5.SS5.SSS3">
        <title><tag close=" ">5.5.3</tag>Syntactic Window</title>
        <para xml:id="S5.SS5.SSS3.p1">
          <p>Some work replace the linear context within a
sentence with a syntactic one <cite>[<bibref bibrefs="levy2014dependencybased,bansal2014tailoring" separator="," show="Refnum" yyseparator=","/>]</cite>.
The text is automatically parsed using a
dependency parser, and the context of a word is taken to be the words that are
in its proximity in the parse tree, together with the syntactic relation by
which they are connected. Such approaches produce highly <emph>functional</emph>
similarities, grouping together words than can fill the same role in a sentence
(e.g. colors, names of schools, verbs of movement). The grouping is also
syntactic, grouping together words that share an inflection <cite>[<bibref bibrefs="levy2014dependencybased" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
      </subsubsection>
      <subsubsection refnum="5.5.4" xml:id="S5.SS5.SSS4">
        <title><tag close=" ">5.5.4</tag>Multilingual</title>
        <para xml:id="S5.SS5.SSS4.p1">
          <p>Another option is using multilingual,
translation based contexts <cite>[<bibref bibrefs="hermann2014multilingual,faruqui2014improving" separator="," show="Refnum" yyseparator=","/>]</cite>.
For example, given a large amount of
sentence-aligned parallel text, one can run a bilingual alignment model such as
the IBM model 1 or model 2 (i.e. using the GIZA++ software), and then use the
produced alignments to derive word contexts. Here, the context of a word
instance are the foreign language words that are aligned to it. Such alignments
tend to result in synonym words receiving similar vectors. Some authors work instead on
the sentence alignment level, without relying on word alignments. An appealing method
is to mix a monolingual window-based approach with a multilingual approach,
creating both kinds of auxiliary tasks. This is likely to produce vectors that
<!-- %**** root.tex Line 1325 **** -->are similar to the window-based approach, but reducing the somewhat undesired
effect of the window-based approach in which antonyms (e.g. hot and cold, high
and low) tend to receive similar vectors <cite>[<bibref bibrefs="faruqui2014improving" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
      </subsubsection>
      <subsubsection refnum="5.5.5" xml:id="S5.SS5.SSS5">
        <title><tag close=" ">5.5.5</tag>Character-based and Sub-word Representations</title>
        <para xml:id="S5.SS5.SSS5.p1">
          <p>An interesting line of work attempts to derive the vector representation of a
word from the characters that compose it. Such approaches are likely to be
particularly useful for tasks which are syntactic in nature, as the character
patterns within words are strongly related to their syntactic function. These
approaches also have the benefit of producing very small model sizes (only
one vector for each character in the alphabet together with a handful of small
matrices needs to be stored), and being able to provide an embedding vector for
every word that may be encountered.
dos Santos and Gatti <ERROR class="undefined">\citeyear</ERROR>dossantos2014deep and dos Santos and Zadrozny
<ERROR class="undefined">\citeyear</ERROR>santos2014learning model the embedding of a word using a
convolutional network (see Section <ref labelref="LABEL:sec:convnet"/>) over the characters.
Ling et al <ERROR class="undefined">\citeyear</ERROR>ling2015finding model the embedding of a word using the
concatenation of the final states of two RNN (LSTM) encoders (Section <ref labelref="LABEL:sec:rnn"/>), one
reading the characters from left to right, and the other from right to left.
Both produce very strong results for part-of-speech tagging. The work of
Ballesteros et al <ERROR class="undefined">\citeyear</ERROR>ballesteros2015improved show that the two-LSTMs encoding of
<cite>[<bibref bibrefs="ling2015finding" separator="," show="Refnum" yyseparator=","/>]</cite> is beneficial also for representing words in dependency
parsing of morphologically rich languages.</p>
        </para>
        <para xml:id="S5.SS5.SSS5.p2">
          <p>Deriving representations of words from the representations of their characters
<!-- %**** root.tex Line 1350 **** -->is motivated by the <emph>unknown words problem</emph> – what do you do when you
encounter a word for which you do not have an embedding vector? Working on the
level of characters alleviates this problem to a large extent, as the vocabulary
of possible characters is much smaller than the vocabulary of possible words.
However, working on the character level is very challenging, as the relationship
between form (characters) and function (syntax, semantics) in language is quite
loose. Restricting oneself to stay on the character level may be an
unnecessarily hard constraint.
Some researchers propose a middle-ground, in which a word is represented as a
combination of a vector for the word itself with vectors of sub-word units that
comprise it. The sub-word embeddings then help in sharing information between
different words with similar forms, as well as allowing back-off to the subword
level when the word is not observed. At the same time, the models are not
forced to rely solely on form when enough observations of the word are available.
Botha and Blunsom <ERROR class="undefined">\citeyear</ERROR>botha2014compositional suggest to
model the embedding vector of a word as a sum of the word-specific vector if such vector
is available, with vectors
for the different morphological components that comprise it (the components are
derived using Morfessor <cite>[<bibref bibrefs="creutz2007unsupervised" separator="," show="Refnum" yyseparator=","/>]</cite>, an unsupervised morphological
segmentation method). Gao et al <cite>[<bibref bibrefs="gao2014modeling" separator="," show="Refnum" yyseparator=","/>]</cite> suggest using as core
features not only the word form itself but also a unique feature (hence a unique
embedding vector) for each of the letter-trigrams in the word.</p>
        </para>
        <pagination role="newpage"/>
        <!-- %**** root.tex Line 1375 **** -->
      </subsubsection>
    </subsection>
  </section>
  <section refnum="6" xml:id="S6" labels="LABEL:sec:training">
    <title><tag close=" ">6</tag>Neural Network Training</title>
    <para xml:id="S6.p1">
      <p>Neural network training is done by trying to minimize a loss function over a
training set, using a gradient-based method. Roughly speaking, all training
methods work by repeatedly computing an estimate of the error over the dataset, computing
the gradient with respect to the error, and then moving the parameters in the direction
of the gradient. Models differ in how the error estimate is computed, and how
“moving in the direction of the gradient” is defined. We describe the
basic algorithm, <emph>stochastic gradient descent</emph> (SGD),
and then briefly mention the other approaches with pointers for further reading.
Gradient calculation is central to the approach. Gradients can be efficiently
and automatically computed using reverse mode differentiation on a computation
graph – a general
algorithmic framework for automatically computing the gradient of any network
and loss function.</p>
    </para>
    <subsection refnum="6.1" xml:id="S6.SS1" labels="LABEL:alg:minibatch-sgd LABEL:alg:online-sgd LABEL:line:grad LABEL:line:grad1 LABEL:line:loopend LABEL:line:loopstart LABEL:line:loss1 LABEL:line:update1">
      <title><tag close=" ">6.1</tag>Stochastic Gradient Training</title>
      <para xml:id="S6.SS1.p1" class="ltx_noindent">
        <p>The common approach for training neural networks is using the stochastic gradient
descent (SGD) algorithm <cite>[<bibref bibrefs="bottou2012stochastic,lecun1998efficient" separator="," show="Refnum" yyseparator=","/>]</cite> or a
variant of it.
SGD is a general optimization algorithm. It receives a function <Math mode="inline" xml:id="S6.SS1.p1.m1" tex="f" text="f"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math>
parameterized by <Math mode="inline" xml:id="S6.SS1.p1.m2" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>,
a loss function, and desired input and output pairs. It then attempts
<!-- %**** root.tex Line 1400 **** -->to set the parameters <Math mode="inline" xml:id="S6.SS1.p1.m3" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> such that the loss of <Math mode="inline" xml:id="S6.SS1.p1.m4" tex="f" text="f"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> with respect to the training examples is small.
The algorithm works as follows:</p>
      </para>
      <ERROR class="undefined">{algorithm}</ERROR>
      <para xml:id="S6.SS1.p2">
        <p>[h]
<text class="ltx_caption">Online Stochastic Gradient Descent Training</text>

<ERROR class="undefined">{algorithmic}</ERROR>[1]
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Function <Math mode="inline" xml:id="S6.SS1.p2.m1" tex="f(\mathbf{x};\theta)" text="f * list@(x, theta)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM526"/><XMRef idref="XM527"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM526" font="bold">x</XMTok><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM527" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> parameterized with parameters
<Math mode="inline" xml:id="S6.SS1.p2.m2" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>.
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Training set of inputs <Math mode="inline" xml:id="S6.SS1.p2.m3" tex="\mathbf{x_{1}},\ldots,\mathbf{x_{n}}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM528"/><XMRef idref="XM529"/><XMRef idref="XM530"/></XMApp><XMWrap><XMApp xml:id="XM528"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM529">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM530"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math> and outputs <Math mode="inline" xml:id="S6.SS1.p2.m4" tex="\mathbf{y_{1}},\ldots,\mathbf{y_{n}}" text="list@(y _ 1, ldots, y _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM531"/><XMRef idref="XM532"/><XMRef idref="XM533"/></XMApp><XMWrap><XMApp xml:id="XM531"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM532">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM533"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Loss function <Math mode="inline" xml:id="S6.SS1.p2.m5" tex="L" text="L"><XMath><XMTok role="UNKNOWN" font="italic">L</XMTok></XMath></Math>.
<ERROR class="undefined">\While</ERROR>stopping criteria not met 
<ERROR class="undefined">\State</ERROR>Sample a training example <Math mode="inline" xml:id="S6.SS1.p2.m6" tex="\mathbf{x_{i}},\mathbf{y_{i}}" text="list@(x _ i, y _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM534"/><XMRef idref="XM535"/></XMApp><XMWrap><XMApp xml:id="XM534"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM535"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math>
<ERROR class="undefined">\State</ERROR>Compute the loss <Math mode="inline" xml:id="S6.SS1.p2.m7" tex="L(f(\mathbf{x_{i}};\theta),\mathbf{y_{i}})" text="L * open-interval@(f * list@(x _ i, theta), y _ i)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM540"/><XMRef idref="XM541"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM540"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM539"/><XMRef idref="XM537"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM539"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM537" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM541"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> 
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS1.p2.m8" tex="\mathbf{\hat{g}}\leftarrow\text{ gradients of }L(f(\mathbf{x_{i}};\theta),%&#10;\mathbf{y_{i}})\text{ w.r.t }\theta" text="hat@(g) leftarrow [ gradients of ] * L * open-interval@(f * list@(x _ i, theta), y _ i) * [ w.r.t ] * theta"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMText> gradients of </XMText><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM546"/><XMRef idref="XM547"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM546"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM545"/><XMRef idref="XM543"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM545"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM543" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM547"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMText> w.r.t </XMText><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMApp></XMApp></XMath></Math> 
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS1.p2.m9" tex="\theta\leftarrow\theta+\eta_{k}\mathbf{\hat{g}}" text="theta leftarrow theta + eta _ k * hat@(g)"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math> 
<ERROR class="undefined">\EndWhile</ERROR><ERROR class="undefined">\State</ERROR><ERROR class="undefined">\Return</ERROR><Math mode="inline" xml:id="S6.SS1.p2.m10" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math></p>
      </para>
      <para xml:id="S6.SS1.p3">
        <p>The goal of the algorithm is to set the parameters <Math mode="inline" xml:id="S6.SS1.p3.m1" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> so as to minimize the
total loss <Math mode="inline" xml:id="S6.SS1.p3.m2" tex="\sum_{i=1}^{n}L(f(\mathbf{x_{i}};\theta),\mathbf{y_{i}})" text="((sum _ (i = 1)) ^ n)@(L * open-interval@(f * list@(x _ i, theta), y _ i))"><XMath><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM552"/><XMRef idref="XM553"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM552"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM551"/><XMRef idref="XM549"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM551"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM549" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM553"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> over the training set.
It works by repeatedly sampling a training example and computing the gradient
<!-- %**** root.tex Line 1425 **** -->of the error on the example with respect to the parameters <Math mode="inline" xml:id="S6.SS1.p3.m3" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> (line
<ref labelref="LABEL:line:grad1"/>) – the input and expected output are assumed to be
fixed, and the loss is treated as a function of the parameters <Math mode="inline" xml:id="S6.SS1.p3.m4" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>.
The parameters <Math mode="inline" xml:id="S6.SS1.p3.m5" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> are then updated in the direction of the gradient, scaled by
a learning rate <Math mode="inline" xml:id="S6.SS1.p3.m6" tex="\eta_{k}" text="eta _ k"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMath></Math> (line <ref labelref="LABEL:line:update1"/>). For further discussion on setting the learning rate, see Section <ref labelref="LABEL:sec:learning-rate"/>.</p>
      </para>
      <para xml:id="S6.SS1.p4">
        <p>Note that the error calculated in line <ref labelref="LABEL:line:loss1"/> is based on a single
training example, and is thus just a rough estimate of the corpus-wide loss that
we are aiming to minimize. The noise in the loss computation may result in
inaccurate gradients.
A common way of reducing this noise is to estimate the error and the gradients
based on a sample of <Math mode="inline" xml:id="S6.SS1.p4.m1" tex="m" text="m"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math> examples. This gives rise to the <emph>minibatch SGD</emph> algorithm:</p>
      </para>
      <ERROR class="undefined">{algorithm}</ERROR>
      <para xml:id="S6.SS1.p5">
        <p>[h]
<text class="ltx_caption">Minibatch Stochastic Gradient Descent Training</text>

<ERROR class="undefined">{algorithmic}</ERROR>[1]
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Function <Math mode="inline" xml:id="S6.SS1.p5.m1" tex="f(\mathbf{x};\theta)" text="f * list@(x, theta)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM554"/><XMRef idref="XM555"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM554" font="bold">x</XMTok><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM555" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> parameterized with parameters
<Math mode="inline" xml:id="S6.SS1.p5.m2" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>.
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Training set of inputs <Math mode="inline" xml:id="S6.SS1.p5.m3" tex="\mathbf{x_{1}},\ldots,\mathbf{x_{n}}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM556"/><XMRef idref="XM557"/><XMRef idref="XM558"/></XMApp><XMWrap><XMApp xml:id="XM556"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM557">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM558"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math> and outputs <Math mode="inline" xml:id="S6.SS1.p5.m4" tex="\mathbf{y_{1}},\ldots,\mathbf{y_{n}}" text="list@(y _ 1, ldots, y _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM559"/><XMRef idref="XM560"/><XMRef idref="XM561"/></XMApp><XMWrap><XMApp xml:id="XM559"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM560">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM561"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Loss function <Math mode="inline" xml:id="S6.SS1.p5.m5" tex="L" text="L"><XMath><XMTok role="UNKNOWN" font="italic">L</XMTok></XMath></Math>.
<ERROR class="undefined">\While</ERROR>stopping criteria not met 
<ERROR class="undefined">\State</ERROR>Sample a minibatch of <Math mode="inline" xml:id="S6.SS1.p5.m6" tex="m" text="m"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math> examples <Math mode="inline" xml:id="S6.SS1.p5.m7" tex="\{(\mathbf{x_{1}},\mathbf{y_{1}}),\ldots,(\mathbf{x_{m}},\mathbf{y_{m}})\}" text="set@(open-interval@(x _ 1, y _ 1), ldots, open-interval@(x _ m, y _ m))"><XMath><XMDual><XMApp><XMTok meaning="set"/><XMRef idref="XM575"/><XMRef idref="XM567"/><XMRef idref="XM576"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMDual xml:id="XM575"><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM571"/><XMRef idref="XM572"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM571"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM572"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM567">…</XMTok><XMTok role="PUNCT">,</XMTok><XMDual xml:id="XM576"><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM573"/><XMRef idref="XM574"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM573"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">m</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM574"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">m</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMath></Math>
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS1.p5.m8" tex="\hat{\mathbf{g}}\leftarrow 0" text="hat@(g) leftarrow 0"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math> 
<ERROR class="undefined">\For</ERROR><Math mode="inline" xml:id="S6.SS1.p5.m9" tex="i=1\text{ to }m" text="i = 1 * [ to ] * m"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMText> to </XMText><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMApp></XMath></Math>
<!-- %**** root.tex Line 1450 **** --><ERROR class="undefined">\State</ERROR>Compute the loss <Math mode="inline" xml:id="S6.SS1.p5.m10" tex="L(f(\mathbf{x_{i}};\theta),\mathbf{y_{i}})" text="L * open-interval@(f * list@(x _ i, theta), y _ i)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM581"/><XMRef idref="XM582"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM581"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM580"/><XMRef idref="XM578"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM580"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM578" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM582"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS1.p5.m11" tex="\mathbf{\hat{g}}\leftarrow\mathbf{\hat{g}}+\text{ gradients of }\frac{1}{m}L(f%&#10;(\mathbf{x_{i}};\theta),\mathbf{y_{i}})\text{ w.r.t }\theta" text="hat@(g) leftarrow hat@(g) + [ gradients of ] * (1 / m) * L * open-interval@(f * list@(x _ i, theta), y _ i) * [ w.r.t ] * theta"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMText> gradients of </XMText><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM587"/><XMRef idref="XM588"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM587"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM586"/><XMRef idref="XM584"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM586"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM584" font="italic">θ</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM588"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMText> w.r.t </XMText><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMApp></XMApp></XMApp></XMath></Math> 
<ERROR class="undefined">\EndFor</ERROR>
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS1.p5.m12" tex="\theta\leftarrow\theta+\eta_{k}\mathbf{\hat{g}}" text="theta leftarrow theta + eta _ k * hat@(g)"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>
<ERROR class="undefined">\EndWhile</ERROR><ERROR class="undefined">\State</ERROR><ERROR class="undefined">\Return</ERROR><Math mode="inline" xml:id="S6.SS1.p5.m13" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math></p>
      </para>
      <para xml:id="S6.SS1.p6">
        <p>In lines <ref labelref="LABEL:line:loopstart"/> – <ref labelref="LABEL:line:loopend"/> the algorithm estimates the
gradient of the corpus loss based on the minibatch.
After the loop, <Math mode="inline" xml:id="S6.SS1.p6.m1" tex="\mathbf{\hat{g}}" text="hat@(g)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMath></Math> contains the gradient estimate, and the parameters
<Math mode="inline" xml:id="S6.SS1.p6.m2" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> are updated toward <Math mode="inline" xml:id="S6.SS1.p6.m3" tex="\mathbf{\hat{g}}" text="hat@(g)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMath></Math>.
The minibatch size can vary in size from <Math mode="inline" xml:id="S6.SS1.p6.m4" tex="m=1" text="m = 1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> to <Math mode="inline" xml:id="S6.SS1.p6.m5" tex="m=n" text="m = n"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMath></Math>. Higher values provide
better estimates of the corpus-wide gradients, while smaller values allow more
updates and in turn faster convergence.
Besides the improved accuracy of the gradients estimation,
the minibatch algorithm provides opportunities for improved training efficiency. For modest
sizes of <Math mode="inline" xml:id="S6.SS1.p6.m6" tex="m" text="m"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math>, some computing architectures (i.e. GPUs) allow an efficient parallel implementation
of the computation in lines <ref labelref="LABEL:line:loopstart"/>–<ref labelref="LABEL:line:loopend"/>.
With a small enough learning rate, SGD is guaranteed to converge to a global optimum
if the function is convex. However, it can also be used to optimize non-convex
functions such as neural-network. While there are no longer guarantees of finding a global optimum, the algorithm
proved to be robust and performs well in practice.
<!-- %**** root.tex Line 1475 **** --></p>
      </para>
      <para xml:id="S6.SS1.p7">
        <p>When training a neural network, the parameterized function <Math mode="inline" xml:id="S6.SS1.p7.m1" tex="f" text="f"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> is the neural
network, and the parameters <Math mode="inline" xml:id="S6.SS1.p7.m2" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> are the layer-transfer matrices, bias terms, embedding
matrices and so on. The gradient computation is a key step in the SGD
algorithm, as well as in all other neural network training algorithms.
The question is, then, how to compute the gradients of the network’s error with
respect to the parameters.
Fortunately, there is an easy solution in the form of the <emph>backpropagation
algorithm</emph> <cite>[<bibref bibrefs="rumelhart1986learning,lecun1998gradient" separator="," show="Refnum" yyseparator=","/>]</cite>. The backpropagation algorithm is a fancy name for
methodologically computing the derivatives of a complex expression using the chain-rule,
while caching intermediary results.
More generally, the backpropagation algorithm is a special case of the
reverse-mode automatic differentiation algorithm <cite>[<bibref bibrefs="neidinger2010introduction" separator="," show="Refnum" yyseparator=","/>, Section
7]</cite>, <cite>[<bibref bibrefs="baydin2015automatic,bengio2012practical" separator="," show="Refnum" yyseparator=","/>]</cite>.<!-- %,@@siam-book˝. -->The following section
describes reverse mode automatic differentiation in the context of the
<emph>computation graph</emph> abstraction.</p>
      </para>
      <paragraph xml:id="S6.SS1.SSS5.Px1">
        <title>Beyond SGD</title>
        <para xml:id="S6.SS1.SSS5.Px1.p1">
          <p>While the SGD algorithm can and often does
produce good results, more advanced algorithms are also available.
The <emph>SGD+Momentum</emph> <cite>[<bibref bibrefs="polyak1964methods" separator="," show="Refnum" yyseparator=","/>]</cite> and <emph>Nesterov Momentum</emph> <cite>[<bibref bibrefs="sutskever2013importance" separator="," show="Refnum" yyseparator=","/>]</cite>
algorithms are variants of SGD in which previous gradients are accumulated and
affect the current update. Adaptive learning rate algorithms including AdaGrad
<cite>[<bibref bibrefs="duchi2011adaptive" separator="," show="Refnum" yyseparator=","/>]</cite>, AdaDelta <cite>[<bibref bibrefs="zeiler2012adadelta" separator="," show="Refnum" yyseparator=","/>]</cite>, RMSProp
<!-- %**** root.tex Line 1500 **** --><cite>[<bibref bibrefs="tieleman2012lecture" separator="," show="Refnum" yyseparator=","/>]</cite> and Adam <cite>[<bibref bibrefs="kingma2014adam" separator="," show="Refnum" yyseparator=","/>]</cite> are designed
to select the learning rate for each minibatch, sometimes on a per-coordinate
basis, potentially alleviating the need of fiddling with learning rate
scheduling. For details of these algorithms, see the original papers or
<cite>[<bibref bibrefs="bengio2015deep" separator="," show="Refnum" yyseparator=","/>, Sections 8.3, 8.4]</cite>. As many neural-network software
frameworks provide implementations of these algorithms, it is easy and sometimes
worthwhile to try out different variants.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="6.2" xml:id="S6.SS2">
      <title><tag close=" ">6.2</tag>The Computation Graph Abstraction</title>
      <para xml:id="S6.SS2.p1">
        <p>While one can compute the gradients of the various parameters of a network by
hand and implement them in code, this procedure is cumbersome and error prone.
For most purposes, it is preferable to use automatic tools for gradient
computation <cite>[<bibref bibrefs="bengio2012practical" separator="," show="Refnum" yyseparator=","/>]</cite>. The computation-graph abstraction allows
us to easily construct arbitrary networks, evaluate their predictions for given
inputs (forward pass), and compute gradients for their parameters with respect
to arbitrary scalar losses (backward pass).</p>
      </para>
      <para xml:id="S6.SS2.p2">
        <p>A computation graph is a representation of an arbitrary mathematical computation as
a graph. It is a directed acyclic graph (DAG) in which nodes correspond to
mathematical operations or (bound) variables and edges correspond to the flow of
intermediary values between the nodes. The graph structure defines the order of
the computation in terms of the dependencies between the different components.
The graph is a DAG and not a tree, as the result of one operation can be the
input of several continuations. Consider for example a
<!-- %**** root.tex Line 1525 **** -->graph for the computation of <Math mode="inline" xml:id="S6.SS2.p2.m1" tex="(a*b+1)*(a*b+2)" text="(a * b + 1) * (a * b + 2)"><XMath><XMApp><XMTok meaning="times" role="MULOP">*</XMTok><XMDual><XMRef idref="XM589"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM589"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">*</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMDual><XMRef idref="XM590"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM590"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">*</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>:</p>
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.2]ab1ab2.pdf</p>
      </para>
      <para xml:id="S6.SS2.p3" class="ltx_noindent">
        <p>The computation of <Math mode="inline" xml:id="S6.SS2.p3.m1" tex="a*b" text="a * b"><XMath><XMApp><XMTok meaning="times" role="MULOP">*</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMath></Math> is shared.
We restrict ourselves to the case where the computation graph is
connected.</p>
      </para>
      <figure frefnum="Figure 3" placement="ht" refnum="3" xml:id="S6.F3" labels="LABEL:fig:mlp-cg">
        <ERROR class="undefined">\includegraphics</ERROR>
        <p>[width=]cg-composed.pdf</p>
        <toccaption><tag close=" ">3</tag><text font="bold">Computation Graph for MLP1.</text> (a) Graph with unbound input. (b) Graph with concrete input. (c) Graph with concrete input, expected output, and loss node.</toccaption>
        <caption><tag close=": ">Figure 3</tag><text font="bold">Computation Graph for MLP1.</text> (a) Graph with unbound input. (b) Graph with concrete input. (c) Graph with concrete input, expected output, and loss node.</caption>
      </figure>
      <para xml:id="S6.SS2.p4">
        <p>Since a neural network is essentially a mathematical expression, it can be
represented as a computation graph.</p>
      </para>
      <para xml:id="S6.SS2.p5">
        <p>For example, Figure <ref labelref="LABEL:fig:mlp-cg"/>a presents the computation graph for a 1-layer MLP with a softmax output transformation.
In our notation, oval nodes represent mathematical operations or functions, and shaded rectangle nodes
represent parameters (bound variables). Network inputs are treated as constants, and drawn without a surrounding node.
Input and parameter nodes have no incoming arcs, and output nodes
have no outgoing arcs.
The output of each node is a matrix, the dimensionality of which is indicated
above the node.
<!-- %**** root.tex Line 1550 **** --></p>
      </para>
      <para xml:id="S6.SS2.p6">
        <p>This graph is incomplete: without specifying the inputs, we cannot compute an
output. Figure <ref labelref="LABEL:fig:mlp-cg"/>b shows a complete graph for an MLP that takes
three words as inputs, and predicts the distribution over part-of-speech tags
for the third word. This graph can be used for prediction, but not for
training, as the output is a vector (not a scalar) and the graph does not take
into account the correct answer or the loss term. Finally, the graph in
<ref labelref="LABEL:fig:mlp-cg"/>c shows the computation graph for a specific training example,
in which the inputs are the (embeddings of) the words “the”, “black”,
“dog”, and the expected output is “NOUN” (whose index is 5).</p>
      </para>
      <para xml:id="S6.SS2.p7">
        <p>Once the graph is built, it is straightforward to run either a forward
computation (compute the result of the computation) or a backward computation
(computing the gradients), as we show below. Constructing the graphs may look
daunting, but is actually very easy using dedicated software libraries and APIs.</p>
      </para>
      <paragraph xml:id="S6.SS2.SSS5.Px1" labels="LABEL:alg:forward">
        <title>Forward Computation</title>
        <para xml:id="S6.SS2.SSS5.Px1.p1">
          <p>The forward pass computes the outputs of the
nodes in the graph. Since each node’s output depends only on itself and on its
incoming edges, it is trivial to compute the outputs of all nodes by traversing
the nodes in a topological order and computing the output of each node given the
already computed outputs of its predecessors.</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px1.p2">
          <p>More formally, in a graph of <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m1" tex="N" text="N"><XMath><XMTok role="UNKNOWN" font="italic">N</XMTok></XMath></Math> nodes, we associate each node with an index <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m2" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> according to their topological
ordering. Let <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m3" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> be the function computed by node <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m4" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> (e.g.
<emph>multiplication</emph>. <emph>addition</emph>, …). Let <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m5" tex="\pi(i)" text="pi * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMDual><XMRef idref="XM591"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM591" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> be the
<!-- %**** root.tex Line 1575 **** -->parent nodes of node <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m6" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>, and <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m7" tex="\pi^{-1}(i)=\{j\mid i\in\pi(j)\}" text="pi ^ (- 1) * i = conditional-set@(j, i element-of pi * j)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM592"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM592" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMDual><XMApp><XMTok meaning="conditional-set"/><XMRef idref="XM594"/><XMRef idref="XM595"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">{</XMTok><XMTok role="UNKNOWN" xml:id="XM594" font="italic">j</XMTok><XMTok name="mid" role="VERTBAR">∣</XMTok><XMApp xml:id="XM595"><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMDual><XMRef idref="XM593"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM593" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">}</XMTok></XMWrap></XMDual></XMApp></XMath></Math> the children nodes
of node <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m8" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> (these are the arguments of <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m9" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>).
Denote by <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m10" tex="v(i)" text="v * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM596"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM596" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> the output of node <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m11" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>, that is, the application of <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m12" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> to
the output values of its arguments <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m13" tex="\pi^{-1}(i)" text="pi ^ (- 1) * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM597"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM597" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>. For variable and input nodes,
<Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m14" tex="f_{i}" text="f _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> is a constant function and <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m15" tex="\pi^{-1}(i)" text="pi ^ (- 1) * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM598"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM598" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is empty.
The Forward algorithm computes the values <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m16" tex="v(i)" text="v * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM599"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM599" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> for all <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m17" tex="i\in[1,N]" text="i element-of closed-interval@(1, N)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM600"/><XMRef idref="XM601"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM600">1</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM601" font="italic">N</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math>.
<ERROR class="undefined">{algorithm}</ERROR>[h]
<text class="ltx_caption">Computation Graph Forward Pass</text>

<ERROR class="undefined">{algorithmic}</ERROR>[1]
<ERROR class="undefined">\For</ERROR>i = 1 to N
<ERROR class="undefined">\State</ERROR>Let <Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m18" tex="a_{1},\ldots,a_{m}=\pi^{-1}(i)" text="list@(a _ 1, ldots, a _ m) = pi ^ (- 1) * i"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM603"/><XMRef idref="XM604"/><XMRef idref="XM605"/></XMApp><XMWrap><XMApp xml:id="XM603"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM604">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM605"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMWrap></XMDual><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM602"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM602" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS2.SSS5.Px1.p2.m19" tex="v(i)\leftarrow f_{i}(v(a_{1}),\ldots,v(a_{m}))" text="v * i leftarrow f _ i * vector@(v * a _ 1, ldots, v * a _ m)"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM606"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM606" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="XM612"/><XMRef idref="XM613"/><XMRef idref="XM614"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM612"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM610"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM610"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM613">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM614"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM611"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM611"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>
<ERROR class="undefined">\EndFor</ERROR></p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS2.SSS5.Px2" labels="LABEL:alg:forward">
        <title>Backward Computation (Derivatives, Backprop)</title>
        <para xml:id="S6.SS2.SSS5.Px2.p1">
          <p>The backward pass begins by designating a node <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m1" tex="N" text="N"><XMath><XMTok role="UNKNOWN" font="italic">N</XMTok></XMath></Math> with scalar (<Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m2" tex="1\times 1" text="1 * 1"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>) output as a loss-node, and running forward computation up to that node.
The backward computation will computes the gradients with respect to that node’s value.
Denote by <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m3" tex="d(i)" text="d * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM615"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM615" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> the quantity <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m4" tex="\diffp{N}{i}" text="[\diffp] * N * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><ERROR class="undefined">\diffp</ERROR><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>. The backpropagation algorithm is
used to compute the values <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m5" tex="d(i)" text="d * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM616"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM616" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> for all nodes <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p1.m6" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>.</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px2.p2" class="ltx_noindent">
          <p>The backward pass fills a table <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p2.m1" tex="d(i)" text="d * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM617"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM617" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> as follows:
<ERROR class="undefined">{algorithm}</ERROR>[h]
<!-- %**** root.tex Line 1600 **** --><text class="ltx_caption">Computation Graph Backward Pass (Backpropagation)</text>

<ERROR class="undefined">{algorithmic}</ERROR>[1]
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p2.m2" tex="d(N)\leftarrow 1" text="d * N leftarrow 1"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM618"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM618" font="italic">N</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>
<ERROR class="undefined">\For</ERROR>i = N-1 to 1
<ERROR class="undefined">\State</ERROR><Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p2.m3" tex="d(i)\leftarrow\sum_{j\in\pi(i)}d(j)\cdot\diffp{f_{j}}{i}" text="d * i leftarrow (sum _ (j element-of pi * i))@(((d * j) cdot [\diffp]) * f _ j * i)"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM620"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM620" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMDual><XMRef idref="XM619"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM619" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok name="cdot" role="MULOP">⋅</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">d</XMTok><XMDual><XMRef idref="XM621"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM621" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><ERROR class="undefined">\diffp</ERROR></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMApp></XMath></Math>
<ERROR class="undefined">\EndFor</ERROR></p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px2.p3" class="ltx_noindent">
          <p>The quantity <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m1" tex="\diffp{f_{j}}{i}" text="[\diffp] * f _ j * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><ERROR class="undefined">\diffp</ERROR><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> is the partial derivative of
<Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m2" tex="f_{j}(\pi^{-1}(j))" text="f _ j * pi ^ (- 1) * j"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp><XMDual><XMRef idref="XM623"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM623"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM622"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM622" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> w.r.t the
argument <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m3" tex="i\in\pi^{-1}(j)" text="i element-of pi ^ (- 1) * j"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM624"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM624" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>. This value depends on the function <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m4" tex="f_{j}" text="f _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMath></Math> and the
values <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m5" tex="v(a_{1}),\ldots,v(a_{m})" text="list@(v * a _ 1, ldots, v * a _ m)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM627"/><XMRef idref="XM628"/><XMRef idref="XM629"/></XMApp><XMWrap><XMApp xml:id="XM627"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM625"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM625"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM628">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM629"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM626"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM626"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMWrap></XMDual></XMath></Math> (where <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p3.m6" tex="a_{1},\ldots,a_{m}=\pi^{-1}(j)" text="list@(a _ 1, ldots, a _ m) = pi ^ (- 1) * j"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM631"/><XMRef idref="XM632"/><XMRef idref="XM633"/></XMApp><XMWrap><XMApp xml:id="XM631"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM632">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM633"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok></XMApp></XMWrap></XMDual><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM630"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM630" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>) of its arguments, which were computed in the forward pass.</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px2.p4">
          <p>Thus, in order to define a new kind of node, one need to define two methods: one
for calculating the forward value <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p4.m1" tex="v(i)" text="v * i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM634"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM634" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> based on the nodes inputs, and the
another for calculating <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p4.m2" tex="\diffp{f_{i}}{x}" text="[\diffp] * f _ i * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><ERROR class="undefined">\diffp</ERROR><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">x</XMTok></XMApp></XMath></Math> for each <Math mode="inline" xml:id="S6.SS2.SSS5.Px2.p4.m3" tex="x\in\pi^{-1}(i)" text="x element-of pi ^ (- 1) * i"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok name="pi" possibleFunction="yes" role="UNKNOWN" font="italic">π</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMDual><XMRef idref="XM635"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM635" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px2.p5">
          <p>For further information on automatic differentiation see
<cite>[<bibref bibrefs="neidinger2010introduction" separator="," show="Refnum" yyseparator=","/>, Section 7]</cite>, <cite>[<bibref bibrefs="baydin2015automatic" separator="," show="Refnum" yyseparator=","/>]</cite>.

For more in depth discussion of the backpropagation algorithm and computation
graphs (also called flow graphs) see
<cite>[<bibref bibrefs="bengio2015deep" separator="," show="Refnum" yyseparator=","/>, Section 6.4]</cite>, <cite>[<bibref bibrefs="lecun1998gradient,bengio2012practical" separator="," show="Refnum" yyseparator=","/>]</cite>.
<!-- %**** root.tex Line 1625 **** -->For a popular yet technical presentation,
see Chris Olah’s description at
<ref class="ltx_url" href="http://colah.github.io/posts/2015-08-Backprop/"><text font="typewriter">http://colah.github.io/posts/2015-08-Backprop/</text></ref>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS2.SSS5.Px3">
        <title>Software</title>
        <para xml:id="S6.SS2.SSS5.Px3.p1">
          <p>Several software packages implement the computation-graph model, including
Theano<note mark="18" role="footnote"><ref class="ltx_url" href="http://deeplearning.net/software/theano/"><text font="typewriter">http://deeplearning.net/software/theano/</text></ref></note>,
Chainer<note mark="19" role="footnote"><ref class="ltx_url" href="http://chainer.org"><text font="typewriter">http://chainer.org</text></ref></note>,
penne<note mark="20" role="footnote"><ref class="ltx_url" href="https://bitbucket.org/ndnlp/penne"><text font="typewriter">https://bitbucket.org/ndnlp/penne</text></ref></note> and
CNN/pyCNN<note mark="21" role="footnote"><ref class="ltx_url" href="https://github.com/clab/cnn"><text font="typewriter">https://github.com/clab/cnn</text></ref></note>.
All these packages support all the essential
components (node types) for defining a wide range of neural network
architectures, covering the structures described in this tutorial and more.
Graph creation is made almost transparent by use of operator overloading. The
framework defines a type for representing graph nodes (commonly called
<emph>expression</emph>s), methods for constructing nodes for inputs and parameters,
and a set of functions and mathematical operations that take expressions as
input and result in more complex expressions. For example, the python code for
creating the computation graph from Figure (<ref labelref="LABEL:fig:mlp-cg"/>c) using the pyCNN
framework is:</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px3.p2">
          <listingblock class="ltx_lstlisting ltx_lst_language_python" data="from pycnn import *&#10;# model initialization.&#10;model = Model()&#10;model.add_parameters(&quot;W1&quot;, (20,150))&#10;model.add_parameters(&quot;b1&quot;, 20)&#10;model.add_parameters(&quot;W2&quot;, (17,20))&#10;model.add_parameters(&quot;b2&quot;, 17)&#10;model.add_lookup_parameters(&quot;words&quot;, (100, 50))&#10;&#10;# Building the computation graph:&#10;renew_cg() # create a new graph.&#10;# Wrap the model parameters as graph-nodes.&#10;W1 = parameter(model[&quot;W1&quot;])&#10;b1 = parameter(model[&quot;b1&quot;])&#10;W2 = parameter(model[&quot;W2&quot;])&#10;b2 = parameter(model[&quot;b2&quot;])&#10;def get_index(x): return 1&#10;# Generate the embeddings layer.&#10;vthe   = lookup(model[&quot;words&quot;], get_index(&quot;the&quot;))&#10;vblack = lookup(model[&quot;words&quot;], get_index(&quot;black&quot;))&#10;vdog   = lookup(model[&quot;words&quot;], get_index(&quot;dog&quot;))&#10;&#10;# Connect the leaf nodes into a complete graph.&#10;x = concatenate([vthe, vblack, vdog])&#10;output = softmax(W2*(tanh(W1*x)+b1)+b2)&#10;loss = -log(pick(output, 5))&#10;&#10;loss_value = loss.forward()&#10;loss.backward() # the gradient is computed&#10;                 # and stored in the corresponding&#10;                 # parameters." xml:id="LSTx1">
            <tabular>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">from<text class="ltx_lst_space"> </text>pycnn<text class="ltx_lst_space"> </text>import<text class="ltx_lst_space"> </text>*</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">#<text class="ltx_lst_space"> </text>model<text class="ltx_lst_space"> </text>initialization.</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">model<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>Model()</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">model.add_parameters("W1",<text class="ltx_lst_space"> </text>(20,150))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">model.add_parameters("b1",<text class="ltx_lst_space"> </text>20)</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">model.add_parameters("W2",<text class="ltx_lst_space"> </text>(17,20))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">model.add_parameters("b2",<text class="ltx_lst_space"> </text>17)</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">model.add_lookup_parameters("words",<text class="ltx_lst_space"> </text>(100,<text class="ltx_lst_space"> </text>50))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line"/>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">#<text class="ltx_lst_space"> </text>Building<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>computation<text class="ltx_lst_space"> </text>graph:</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">renew_cg()<text class="ltx_lst_space"> </text>#<text class="ltx_lst_space"> </text>create<text class="ltx_lst_space"> </text>a<text class="ltx_lst_space"> </text>new<text class="ltx_lst_space"> </text>graph.</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">#<text class="ltx_lst_space"> </text>Wrap<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>model<text class="ltx_lst_space"> </text>parameters<text class="ltx_lst_space"> </text>as<text class="ltx_lst_space"> </text>graph-nodes.</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">W1<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>parameter(model["W1"])</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">b1<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>parameter(model["b1"])</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">W2<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>parameter(model["W2"])</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">b2<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>parameter(model["b2"])</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">def<text class="ltx_lst_space"> </text>get_index(x):<text class="ltx_lst_space"> </text>return<text class="ltx_lst_space"> </text>1</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">#<text class="ltx_lst_space"> </text>Generate<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>embeddings<text class="ltx_lst_space"> </text>layer.</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">vthe<text class="ltx_lst_space">   </text>=<text class="ltx_lst_space"> </text>lookup(model["words"],<text class="ltx_lst_space"> </text>get_index("the"))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">vblack<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>lookup(model["words"],<text class="ltx_lst_space"> </text>get_index("black"))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">vdog<text class="ltx_lst_space">   </text>=<text class="ltx_lst_space"> </text>lookup(model["words"],<text class="ltx_lst_space"> </text>get_index("dog"))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line"/>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">#<text class="ltx_lst_space"> </text>Connect<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>leaf<text class="ltx_lst_space"> </text>nodes<text class="ltx_lst_space"> </text>into<text class="ltx_lst_space"> </text>a<text class="ltx_lst_space"> </text>complete<text class="ltx_lst_space"> </text>graph.</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">x<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>concatenate([vthe,<text class="ltx_lst_space"> </text>vblack,<text class="ltx_lst_space"> </text>vdog])</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">output<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>softmax(W2*(tanh(W1*x)+b1)+b2)</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" font="typewriter" fontsize="80%">loss<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>-log(pick(output,<text class="ltx_lst_space"> </text>5))</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line"/>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">loss_value<text class="ltx_lst_space"> </text>=<text class="ltx_lst_space"> </text>loss.forward()</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter">loss.backward()<text class="ltx_lst_space"> </text>#<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>gradient<text class="ltx_lst_space"> </text>is<text class="ltx_lst_space"> </text>computed</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter"><text class="ltx_lst_space">                 </text>#<text class="ltx_lst_space"> </text>and<text class="ltx_lst_space"> </text>stored<text class="ltx_lst_space"> </text>in<text class="ltx_lst_space"> </text>the<text class="ltx_lst_space"> </text>corresponding</text>
                </td>
              </tr>
              <tr>
                <td>
                  <text class="ltx_lst_line" fontsize="80%" font="typewriter"><text class="ltx_lst_space">                 </text>#<text class="ltx_lst_space"> </text>parameters.</text>
                </td>
              </tr>
            </tabular>
          </listingblock>
        </para>
        <para xml:id="S6.SS2.SSS5.Px3.p3" class="ltx_noindent">
          <p>Most of the code involves various initializations: the first block
defines model parameters that are be shared between different computation
graphs (recall that each graph corresponds to a specific training example).
The second block turns the model parameters into the graph-node
(Expression) types. The third block retrieves the Expressions for the
embeddings of the input words. Finally, the fourth block is where the graph
is created. Note how transparent the graph creation is – there is an almost a
one-to-one correspondence between creating the graph and describing it
mathematically. The last block shows a forward and backward pass.
The other software frameworks follow similar patterns.</p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px3.p4">
          <p>Theano involves an optimizing compiler for computation graphs, which is both a
blessing and a curse. On the one hand, once compiled, large graphs can be run
efficiently on either the CPU or a GPU, making it ideal for large graphs with a
fixed structure, where only the inputs change between instances. However, the
compilation step itself can be costly, and it makes the interface a bit
cumbersome to work with. In contrast, the other packages focus on building
large and dynamic computation graphs and executing them “on the fly” without a
compilation step. While the execution speed may suffer with respect to Theano’s
optimized version, these packages are especially convenient when working with
<!-- %**** root.tex Line 1700 **** -->the recurrent and recursive networks described in Sections <ref labelref="LABEL:sec:rnn"/>, <ref labelref="LABEL:sec:recnn"/> as well
as in structured prediction settings as described in Section <ref labelref="LABEL:sec:structured"/>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS2.SSS5.Px4" labels="LABEL:alg:nn-train">
        <title>Implementation Recipe</title>
        <para xml:id="S6.SS2.SSS5.Px4.p1">
          <p>Using the computation graph abstraction, the pseudo-code for a network training
algorithm is given in Algorithm <ref labelref="LABEL:alg:nn-train"/>.</p>
        </para>
        <ERROR class="undefined">{algorithm}</ERROR>
        <para xml:id="S6.SS2.SSS5.Px4.p2">
          <p>[h!]
<text class="ltx_caption">Neural Network Training with Computation Graph Abstraction
(using minibatches of size 1) </text></p>
        </para>
        <ERROR class="undefined">{algorithmic}</ERROR>
        <para xml:id="S6.SS2.SSS5.Px4.p3">
          <p>[1]
<ERROR class="undefined">\State</ERROR>Define network parameters.
<ERROR class="undefined">\For</ERROR>iteration = 1 to N
<ERROR class="undefined">\For</ERROR>Training example <Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m1" tex="\mathbf{x_{i}},\mathbf{y_{i}}" text="list@(x _ i, y _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM636"/><XMRef idref="XM637"/></XMApp><XMWrap><XMApp xml:id="XM636"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM637"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math> in dataset
<ERROR class="undefined">\State</ERROR>loss_node <Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m2" tex="\leftarrow" text="leftarrow"><XMath><XMTok name="leftarrow" role="ARROW">←</XMTok></XMath></Math> build_computation_graph(<Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m3" tex="\mathbf{x_{i}}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>, <Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m4" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>, parameters)
<ERROR class="undefined">\State</ERROR>loss_node.forward()
<ERROR class="undefined">\State</ERROR>gradients <Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m5" tex="\leftarrow" text="leftarrow"><XMath><XMTok name="leftarrow" role="ARROW">←</XMTok></XMath></Math> loss_node().backward()
<ERROR class="undefined">\State</ERROR>parameters <Math mode="inline" xml:id="S6.SS2.SSS5.Px4.p3.m6" tex="\leftarrow" text="leftarrow"><XMath><XMTok name="leftarrow" role="ARROW">←</XMTok></XMath></Math> update_parameters(parameters, gradients)
<ERROR class="undefined">\EndFor</ERROR><ERROR class="undefined">\EndFor</ERROR><ERROR class="undefined">\State</ERROR><ERROR class="undefined">\Return</ERROR>parameters.


<!-- %**** root.tex Line 1725 **** --></p>
        </para>
        <para xml:id="S6.SS2.SSS5.Px4.p4">
          <p>Here, build_computation_graph is a user-defined function that builds the
computation graph for the given input, output and network structure, returning a
single loss node. update_parameters is an optimizer specific update rule.
The recipe specifies that a new graph is created for each training example. This
accommodates cases in which the network structure varies between training
example, such as recurrent and recursive neural networks, to be discussed in
Sections <ref labelref="LABEL:sec:rnn"/> – <ref labelref="LABEL:sec:recnn"/>. For networks with fixed
structures, such as an MLPs, it may be more efficient to create one base
computation graph and vary only the
inputs and expected outputs between examples.</p>
        </para>
        <!-- %“begin–figure˝ 
     %“includegraphics[width=“textwidth]–mlp1-box.pdf˝
     %“caption–Composing computation graphs. (a) The MLP1 computation graph from
     %figure “ref–fig:mlp-cg˝ can be abstracted as an MLP1 node. (b) Using the MLP1
     %node makes the graph easier to draw. (c) Composing MLP1 nodes to form MLP2.˝
     %“label–fig:mlp1-box˝
     %“end–figure˝-->
      </paragraph>
      <paragraph xml:id="S6.SS2.SSS5.Px5">
        <title>Network Composition</title>
        <para xml:id="S6.SS2.SSS5.Px5.p1">
          <p>As long as the network’s output is a vector (<Math mode="inline" xml:id="S6.SS2.SSS5.Px5.p1.m1" tex="1\times k" text="1 * k"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMath></Math> matrix), it is trivial to compose networks by making the output of one
network the input of another, creating arbitrary networks. The computation
graph abstractions makes this ability explicit: a node in the computation graph
can itself be a computation graph with a designated output node.
<!-- %**** root.tex Line 1750 **** 
     %For example, as demonstrated in figure “ref–fig:mlp1-box˝, once we built the MLP1 computation graph,
     %we can treat it a black box, and re-use it in larger network structures.-->One can then design arbitrarily deep and complex networks, and be able to easily evaluate and
train them thanks to automatic forward and gradient computation. This makes it
easy to define and train networks for structured outputs and multi-objective
training, as we discuss in Section <ref labelref="LABEL:sec:joint"/>, as well as complex recurrent and recursive
networks, as discussed in Sections <ref labelref="LABEL:sec:rnn"/>–<ref labelref="LABEL:sec:recnn"/>.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="6.3" xml:id="S6.SS3" labels="LABEL:sec:learning-rate">
      <title><tag close=" ">6.3</tag>Optimization Issues</title>
      <para xml:id="S6.SS3.p1">
        <p>Once the gradient computation is taken care of, the network is trained
using SGD or another gradient-based optimization
algorithm. The function being optimized is not
convex, and for a long time training of neural networks was considered a
“black art” which can only be done by selected few. Indeed, many parameters
affect the optimization process, and care has to be taken to tune these parameters.
While this tutorial is not intended as a comprehensive guide to successfully training
neural networks, we do list here a few of the prominent issues. For further discussion
on optimization techniques and algorithms for neural networks, refer to
<cite>[<bibref bibrefs="bengio2015deep" separator="," show="Refnum" yyseparator=","/>, Chapter 8]</cite>. For some theoretical discussion and analysis,
refer to <cite>[<bibref bibrefs="glorot2010understanding" separator="," show="Refnum" yyseparator=","/>]</cite>. For various practical tips and
recommendations, see <cite>[<bibref bibrefs="lecun1998efficient,bottou2012stochastic" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <!-- %**** root.tex Line 1775 **** -->
      <paragraph xml:id="S6.SS3.SSS5.Px1" labels="LABEL:sec:glorot-init">
        <title>Initialization</title>
        <para xml:id="S6.SS3.SSS5.Px1.p1">
          <p>The non-convexity of the loss function means the
optimization procedure may get stuck in a local minimum or a saddle point, and
that starting from different initial points (e.g. different random values for
the parameters) may result in different results. Thus, it is advised to run
several restarts of the training starting at different random initializations,
and choosing the best one based on a development set.<note mark="22" role="footnote">When debugging,
and for reproducibility of results, it is advised to used a fixed random seed.</note>
The amount of variance in the
results is different for different network formulations and datasets, and cannot
be predicted in advance.</p>
        </para>
        <para xml:id="S6.SS3.SSS5.Px1.p2">
          <p>The magnitude of the random values has an important effect on the
success of training. An effective scheme due to Glorot and Bengio
<ERROR class="undefined">\citeyear</ERROR>glorot2010understanding, called <emph>xavier initialization</emph> after
Glorot’s first name, suggests initializing a weight matrix <Math mode="inline" xml:id="S6.SS3.SSS5.Px1.p2.m1" tex="\mathbf{W}\in\mathbb{R}^{d_{in}\times d_{out}}" text="W element-of R ^ (d _ (i * n) * d _ (o * u * t))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">W</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">u</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math> as:</p>
          <equationgroup class="ltx_eqn_align" xml:id="S13.EGx15">
            <equation xml:id="S6.Ex37">
              <MathFork>
                <Math xml:id="S6.Ex37.m2" tex="\displaystyle\mathbf{W}\sim U\left[-\frac{\sqrt{6}}{\sqrt{d_{in}+d_{out}}},+%&#10;\frac{\sqrt{6}}{\sqrt{d_{in}+d_{out}}}\right]" text="W similar-to U * closed-interval@(- square-root@(6) / square-root@(d _ (i * n) + d _ (o * u * t)), + square-root@(6) / square-root@(d _ (i * n) + d _ (o * u * t)))">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMTok role="UNKNOWN" font="bold">W</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">U</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="XM638"/>
                            <XMRef idref="XM639"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN">[</XMTok>
                            <XMApp xml:id="XM638">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                                <XMApp>
                                  <XMTok meaning="square-root"/>
                                  <XMTok meaning="6" role="NUMBER">6</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="square-root"/>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM639">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                                <XMApp>
                                  <XMTok meaning="square-root"/>
                                  <XMTok meaning="6" role="NUMBER">6</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="square-root"/>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right">
                    <Math mode="inline" tex="\displaystyle\mathbf{W}\sim U\left[-\frac{\sqrt{6}}{\sqrt{d_{in}+d_{out}}},+%&#10;\frac{\sqrt{6}}{\sqrt{d_{in}+d_{out}}}\right]" xml:id="S6.Ex37.m1" text="W similar-to U * closed-interval@(- square-root@(6) / square-root@(d _ (i * n) + d _ (o * u * t)), + square-root@(6) / square-root@(d _ (i * n) + d _ (o * u * t)))">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">U</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="closed-interval"/>
                                <XMRef idref="XM640"/>
                                <XMRef idref="XM641"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN">[</XMTok>
                                <XMApp xml:id="XM640">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                                    <XMApp>
                                      <XMTok meaning="square-root"/>
                                      <XMTok meaning="6" role="NUMBER">6</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="square-root"/>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM641">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                                    <XMApp>
                                      <XMTok meaning="square-root"/>
                                      <XMTok meaning="6" role="NUMBER">6</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="square-root"/>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                            <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math>
                  </td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
        <para xml:id="S6.SS3.SSS5.Px1.p3" class="ltx_noindent">
          <p>where <Math mode="inline" xml:id="S6.SS3.SSS5.Px1.p3.m1" tex="U[a,b]" text="U * closed-interval@(a, b)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">U</XMTok><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM642"/><XMRef idref="XM643"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok role="UNKNOWN" xml:id="XM642" font="italic">a</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM643" font="italic">b</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is a uniformly sampled random value in the range <Math mode="inline" xml:id="S6.SS3.SSS5.Px1.p3.m2" tex="[a,b]" text="closed-interval@(a, b)"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM644"/><XMRef idref="XM645"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok role="UNKNOWN" xml:id="XM644" font="italic">a</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM645" font="italic">b</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math>.
This advice works well on many occasions, and is the preferred default
initialization method by many.
<!-- %**** root.tex Line 1800 **** --></p>
        </para>
        <para xml:id="S6.SS3.SSS5.Px1.p4">
          <p>Analysis by He et al <ERROR class="undefined">\citeyear</ERROR>he2015delving
suggests that when using ReLU non-linearities, the weights should be
initialized by sampling from a zero-mean Gaussian distribution whose standard
deviation is <Math mode="inline" xml:id="S6.SS3.SSS5.Px1.p4.m1" tex="\sqrt{\frac{2}{d_{in}}}" text="square-root@(2 / d _ (i * n))"><XMath><XMApp><XMTok meaning="square-root"/><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMTok meaning="2" role="NUMBER">2</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>.
This initialization was found by He et
al to work better than xavier initialization in an image classification task,
especially when deep networks were involved.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS3.SSS5.Px2">
        <title>Vanishing and Exploding Gradients</title>
        <para xml:id="S6.SS3.SSS5.Px2.p1">
          <p>In deep networks, it is common for
the error gradients to either vanish (become exceedingly close to 0) or explode
(become exceedingly high) as they propagate back through the computation graph.
The problem becomes more severe in deeper networks, and especially so in
recursive and recurrent networks <cite>[<bibref bibrefs="pascanu2012difficulty" separator="," show="Refnum" yyseparator=","/>]</cite>. Dealing with the vanishing gradients problem is
still an open research question. Solutions include making the networks shallower,
step-wise training (first train the first layers based on some auxiliary output signal,
then fix them and train the upper layers of the complete network based on the
real task signal), or specialized architectures that are designed to assist in
gradient flow (e.g., the LSTM and GRU architectures for recurrent networks,
discussed in Section <ref labelref="LABEL:sec:rnn-arch"/>).
Dealing with the exploding gradients has a simple but very
effective solution: clipping the gradients if their norm exceeds a given
threshold. Let <Math mode="inline" xml:id="S6.SS3.SSS5.Px2.p1.m1" tex="\mathbf{\hat{g}}" text="hat@(g)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMath></Math> be the gradients of all parameters in the network,
and <Math mode="inline" xml:id="S6.SS3.SSS5.Px2.p1.m2" tex="\|\mathbf{\hat{g}}\|" text="norm@(hat@(g))"><XMath><XMDual><XMApp><XMTok meaning="norm"/><XMRef idref="XM646"/></XMApp><XMWrap><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMApp xml:id="XM646"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok></XMWrap></XMDual></XMath></Math> be their <Math mode="inline" xml:id="S6.SS3.SSS5.Px2.p1.m3" tex="L_{2}" text="L _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> norm. Pascanu et al
<!-- %**** root.tex Line 1825 **** --><ERROR class="undefined">\citeyear</ERROR>pascanu2012difficulty suggest to set: <Math mode="inline" xml:id="S6.SS3.SSS5.Px2.p1.m4" tex="\mathbf{\hat{g}}\leftarrow\frac{threshold}{\|\mathbf{\hat{g}}\|}\mathbf{\hat{g}}" text="hat@(g) leftarrow ((t * h * r * e * s * h * o * l * d) / norm@(hat@(g))) * hat@(g)"><XMath><XMApp><XMTok name="leftarrow" role="ARROW">←</XMTok><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp><XMDual><XMApp><XMTok meaning="norm"/><XMRef idref="XM647"/></XMApp><XMWrap><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMApp xml:id="XM647"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp></XMApp></XMApp></XMath></Math> if <Math mode="inline" xml:id="S6.SS3.SSS5.Px2.p1.m5" tex="\|\mathbf{\hat{g}}\|&gt;threshold" text="norm@(hat@(g)) &gt; t * h * r * e * s * h * o * l * d"><XMath><XMApp><XMTok meaning="greater-than" role="RELOP">&gt;</XMTok><XMDual><XMApp><XMTok meaning="norm"/><XMRef idref="XM648"/></XMApp><XMWrap><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMApp xml:id="XM648"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok></XMApp><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMath></Math>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS3.SSS5.Px3">
        <title>Saturation and Dead Neurons</title>
        <para xml:id="S6.SS3.SSS5.Px3.p1">
          <p>Layers with <Math mode="inline" xml:id="S6.SS3.SSS5.Px3.p1.m1" tex="tanh" text="t * a * n * h"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">h</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S6.SS3.SSS5.Px3.p1.m2" tex="sigmoid" text="s * i * g * m * o * i * d"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">g</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMath></Math> activations can
become saturated – resulting in output values for that layer that are all close to one,
the upper-limit
of the activation function. Saturated neurons have very small gradients, and
should be avoided.
Layers with the ReLU activation cannot be saturated, but can “die” – most or
all values are negative and thus clipped at zero for all inputs, resulting in a
gradient of zero for that layer.
If your network does not train well, it is advisable to monitor the network for
saturated or dead layers. Saturated neurons are caused by
too large values entering the layer. This may be controlled for by changing the
initialization, scaling the range of the input values, or changing the learning
rate.
Dead neurons are caused by all weights entering the layer being
negative (for example this can happen after a large gradient update). Reducing
the learning rate will help in this situation.
For saturated layers, another option is to normalize the values in the saturated
layer after the activation, i.e. instead of <Math mode="inline" xml:id="S6.SS3.SSS5.Px3.p1.m3" tex="g(\mathbf{h})=tanh(\mathbf{h})" text="g * h = t * a * n * h * h"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="XM649"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM649" font="bold">h</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="XM650"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM650" font="bold">h</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math> using
<Math mode="inline" xml:id="S6.SS3.SSS5.Px3.p1.m4" tex="g(\mathbf{h})=\frac{tanh(\mathbf{h})}{\|tanh(\mathbf{h})\|}" text="g * h = (t * a * n * h * h) / norm@(t * a * n * h * h)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok><XMDual><XMRef idref="XM654"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM654" font="bold">h</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="XM651"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM651" font="bold">h</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMDual><XMApp><XMTok meaning="norm"/><XMRef idref="XM653"/></XMApp><XMWrap><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMApp xml:id="XM653"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">h</XMTok><XMDual><XMRef idref="XM652"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM652" font="bold">h</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.
Layer normalization is an effective measure for countering saturation, but is also expensive in
terms of gradient computation.</p>
        </para>
        <!-- %**** root.tex Line 1850 **** -->
      </paragraph>
      <paragraph xml:id="S6.SS3.SSS5.Px4">
        <title>Shuffling</title>
        <para xml:id="S6.SS3.SSS5.Px4.p1">
          <p>The order in which the training examples are presented to
the network is important. The SGD formulation above specifies selecting a random
example in each turn. In practice, most implementations go over the training example
in order.
It is advised to shuffle the training examples before
each pass through the data.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS3.SSS5.Px5">
        <title>Learning Rate</title>
        <para xml:id="S6.SS3.SSS5.Px5.p1">
          <p>Selection of the learning rate is important. Too large
learning rates will prevent the network from converging on an effective
solution. Too small learning rates will take very long time to converge. As a
rule of thumb, one should experiment with a range of initial learning rates in
range <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m1" tex="[0,1]" text="closed-interval@(0, 1)"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM655"/><XMRef idref="XM656"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="0" role="NUMBER" xml:id="XM655">0</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM656">1</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math>, e.g. <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m2" tex="0.001" text="0.001"><XMath><XMTok meaning="0.001" role="NUMBER">0.001</XMTok></XMath></Math>, <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m3" tex="0.01" text="0.01"><XMath><XMTok meaning="0.01" role="NUMBER">0.01</XMTok></XMath></Math>, <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m4" tex="0.1" text="0.1"><XMath><XMTok meaning="0.1" role="NUMBER">0.1</XMTok></XMath></Math>, <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m5" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>. Monitor the network’s loss
over time, and decrease the learning rate once the network seem to be stuck in a
fixed region. <emph>Learning rate scheduling</emph> decrease the rate as a function
of the number of observed minibatches.
A common schedule is dividing the initial learning rate by the iteration
number. Léon Bottou <ERROR class="undefined">\citeyear</ERROR>bottou2012stochastic recommends using a
learning rate of the form <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m6" tex="\eta_{t}=\eta_{0}(1+\eta_{0}\lambda t)^{-1}" text="eta _ t = eta _ 0 * (1 + eta _ 0 * lambda * t) ^ (- 1)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMDual><XMRef idref="XM657"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM657"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp><XMTok name="lambda" role="UNKNOWN" font="italic">λ</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math> where
<Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m7" tex="\eta_{0}" text="eta _ 0"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math> is the initial learning rate, <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m8" tex="\eta_{t}" text="eta _ t"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMath></Math> is the learning rate to use on
the <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m9" tex="t" text="t"><XMath><XMTok role="UNKNOWN" font="italic">t</XMTok></XMath></Math>th training example, and <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m10" tex="\lambda" text="lambda"><XMath><XMTok name="lambda" role="UNKNOWN" font="italic">λ</XMTok></XMath></Math> is an additional hyperparameter. He
further recommends determining a good value of <Math mode="inline" xml:id="S6.SS3.SSS5.Px5.p1.m11" tex="\eta_{0}" text="eta _ 0"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok name="eta" role="UNKNOWN" font="italic">η</XMTok><XMTok meaning="0" role="NUMBER">0</XMTok></XMApp></XMath></Math> based on a small sample of
the data prior to running on the entire dataset.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S6.SS3.SSS5.Px6">
        <title>Minibatches</title>
        <para xml:id="S6.SS3.SSS5.Px6.p1">
          <p>Parameter updates occur either every training
example (minibatches of size 1) or every <Math mode="inline" xml:id="S6.SS3.SSS5.Px6.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> training examples.
<!-- %**** root.tex Line 1875 **** -->Some problems benefit from training with larger minibatch sizes.
In terms of the computation graph abstraction, one can create
a computation graph for each of the <Math mode="inline" xml:id="S6.SS3.SSS5.Px6.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> training examples, and then connecting
the <Math mode="inline" xml:id="S6.SS3.SSS5.Px6.p1.m3" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> loss nodes under an averaging node, whose output will be the loss
of the minibatch.
Large minibatched training can also be beneficial in terms of computation
efficiency on specialized computing architectures such as GPUs. This is beyond
the scope of this tutorial.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="6.4" xml:id="S6.SS4" labels="LABEL:sec:dropout">
      <title><tag close=" ">6.4</tag>Regularization</title>
      <para xml:id="S6.SS4.p1">
        <p>Neural network models have many parameters, and overfitting can easily occur.
Overfitting can be alleviated to some extent by <emph>regularization</emph>.
A common regularization method is <Math mode="inline" xml:id="S6.SS4.p1.m1" tex="L_{2}" text="L _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> regularization, placing a squared
penalty on parameters with large values by adding an additive <Math mode="inline" xml:id="S6.SS4.p1.m2" tex="\frac{\lambda}{2}\|\theta\|^{2}" text="(lambda / 2) * (norm@(theta)) ^ 2"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok mathstyle="text" meaning="divide" role="MULOP"/><XMTok name="lambda" role="UNKNOWN" font="italic">λ</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMDual><XMApp><XMTok meaning="norm"/><XMRef idref="XM658"/></XMApp><XMWrap><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMTok name="theta" role="UNKNOWN" xml:id="XM658" font="italic">θ</XMTok><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok></XMWrap></XMDual><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp></XMath></Math> term
to the objective function to be minimized, where <Math mode="inline" xml:id="S6.SS4.p1.m3" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math> is the set of model
parameters, <Math mode="inline" xml:id="S6.SS4.p1.m4" tex="\|\cdot\|^{2}"><XMath><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMTok name="cdot" role="MULOP">⋅</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok meaning="parallel-to" name="||" role="VERTBAR">∥</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> is the squared <Math mode="inline" xml:id="S6.SS4.p1.m5" tex="L_{2}" text="L _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> norm (sum of squares of the
values), and <Math mode="inline" xml:id="S6.SS4.p1.m6" tex="\lambda" text="lambda"><XMath><XMTok name="lambda" role="UNKNOWN" font="italic">λ</XMTok></XMath></Math> is a hyperparameter controlling the amount of
regularization.</p>
      </para>
      <para xml:id="S6.SS4.p2">
        <p>A recently proposed alternative regularization method is <emph>dropout</emph>
<cite>[<bibref bibrefs="hinton2012improving" separator="," show="Refnum" yyseparator=","/>]</cite>. The dropout method is designed to prevent the
network from learning to rely on specific weights. It works by randomly
dropping (setting to 0) half of the neurons in the network (or in a specific
<!-- %**** root.tex Line 1900 **** -->layer) in each training example.
Work by Wager et al
<ERROR class="undefined">\citeyear</ERROR>wager2013dropout establishes a strong connection between the dropout
method and <Math mode="inline" xml:id="S6.SS4.p2.m1" tex="L_{2}" text="L _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">L</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> regularization. Gal and Gharamani <ERROR class="undefined">\citeyear</ERROR>gal2015dropout
show that a multi-layer perceptron with dropout applied at every layer can be
interpreted as Bayesian model averaging.</p>
      </para>
      <para xml:id="S6.SS4.p3">
        <p>The dropout technique is one of the key factors
contributing to very strong results of neural-network methods on image
classification tasks <cite>[<bibref bibrefs="krizhevsky2012imagenet" separator="," show="Refnum" yyseparator=","/>]</cite>, especially when combined
with ReLU activation units <cite>[<bibref bibrefs="dahl2013improving" separator="," show="Refnum" yyseparator=","/>]</cite>. The dropout technique
is effective also in NLP applications of neural networks.</p>
      </para>
      <pagination role="newpage"/>
    </subsection>
  </section>
  <section refnum="7" xml:id="S7" labels="LABEL:sec:joint">
    <title><tag close=" ">7</tag>Cascading and Multi-task Learning</title>
    <para xml:id="S7.p1">
      <p>The combination of online training methods with automatic gradient computations
using the computation graph abstraction allows for an easy implementation of model
cascading, parameter sharing and multi-task learning.</p>
    </para>
    <paragraph xml:id="S7.SS4.SSS5.Px1">
      <title>Model cascading</title>
      <para xml:id="S7.SS4.SSS5.Px1.p1">
        <p>is a powerful technique in which large networks are built by
composing them out of smaller component networks.
For example, we may have a feed-forward network for predicting the part of
speech of a word based on its neighbouring words and/or the characters that
<!-- %**** root.tex Line 1925 **** -->compose it. In a pipeline approach, we would use this network for predicting
parts of speech, and then feed the predictions as input features to neural
network that does syntactic chunking or parsing.
Instead, we could think of the hidden layers of this network as an encoding
that captures the relevant information for predicting the part of speech. In a
cascading approach, we take the hidden layers of this network and connect them (and
not the part of speech prediction themselves) as the inputs for the syntactic
network. We now have a larger network that takes as input sequences of words and
characters, and outputs a syntactic structure.
The computation graph abstraction allows us to easily propagate the
error gradients from the syntactic task loss all the way back to the characters.</p>
      </para>
      <para xml:id="S7.SS4.SSS5.Px1.p2">
        <p>To combat the vanishing gradient problem of deep networks, as well as to make
better use of available training material, the individual component network’s
parameters can be bootstrapped by training
them separately on a relevant task, before plugging them in to the larger network
for further tuning. For example, the part-of-speech predicting network can be
trained to accurately predict parts-of-speech on a relatively large annotated
corpus, before plugging its hidden layer into the syntactic parsing network
for which less training data is available. In case the training data provide
direct supervision for both tasks, we can make use of it during training by
creating a network with two outputs, one for each task, computing a separate
loss for each output, and then summing the losses into a single node from which
we backpropagate the error gradients.</p>
      </para>
      <!-- %**** root.tex Line 1950 **** -->
      <para xml:id="S7.SS4.SSS5.Px1.p3">
        <p>Model cascading is very common when using convolutional, recursive and recurrent neural
networks, where, for example, a recurrent network is used to encode a sentence
into a fixed sized vector, which is then used as the input of another network.
The supervision signal of the recurrent network comes primarily from the upper
network that consumes the recurrent network’s output as it inputs.</p>
      </para>
    </paragraph>
    <paragraph xml:id="S7.SS4.SSS5.Px2">
      <title>Multi-task learning</title>
      <para xml:id="S7.SS4.SSS5.Px2.p1">
        <p>is used when we have related prediction tasks that do not
necessarily feed into one another, but we do believe that information that is
useful for one type of prediction can be useful also to some of the other tasks.
For example, chunking, named entity recognition (NER) and language modeling are
examples of synergistic tasks. Information for predicting chunk boundaries,
named-entity boundaries and the next word in the sentence all rely on some
shared underlying syntactic-semantic representation. Instead of training a
separate network for each task, we can create a single network with several
outputs. A common approach is to have a multi-layer feed-forward network, whose
final hidden layer (or a concatenation of all hidden layers) is then passed to
different output layers.

This way, most of the parameters of the network are
shared between the different tasks. Useful information learned from one
task can then help to disambiguate other tasks.
Again, the computation graph abstraction makes it very easy to construct such
networks and compute the gradients for them, by computing a separate loss for
each available supervision signal, and then summing the losses into a single
loss that is used for computing the gradients. In case we have several corpora,
<!-- %**** root.tex Line 1975 **** -->each with different kind of supervision signal (e.g. we have one corpus for NER
and another for chunking), the training procedure will shuffle all of the
available training example, performing gradient computation and updates with
respect to a different loss in every turn. Multi-task learning in the context
of language-processing is introduced and discussed in <cite>[<bibref bibrefs="collobert2011natural" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <pagination role="newpage"/>
    </paragraph>
  </section>
  <section refnum="8" xml:id="S8" labels="LABEL:sec:structured">
    <title><tag close=" ">8</tag>Structured Output Prediction</title>
    <para xml:id="S8.p1">
      <p>Many problems in NLP involve structured outputs: cases where the desired output
is not a class label or distribution over class labels, but a structured object
such as a sequence, a tree or a graph. Canonical examples are sequence tagging
(e.g. part-of-speech tagging) sequence segmentation (chunking, NER), and syntactic parsing.
In this section, we discuss how feed-forward neural network models can be used for structured tasks.
In later sections we discuss specialized neural network models for dealing with
sequences (Section <ref labelref="LABEL:sec:rnn"/>) and trees (Section <ref labelref="LABEL:sec:recnn"/>).</p>
    </para>
    <subsection refnum="8.1" xml:id="S8.SS1">
      <title><tag close=" ">8.1</tag>Greedy Structured Prediction</title>
      <para xml:id="S8.SS1.p1">
        <p>The greedy approach to structured prediction is to decompose the structure
prediction problem into a sequence of local prediction problems and training
a classifier to perform each local decision. At test time, the trained
<!-- %**** root.tex Line 2000 **** -->classifier is used in a greedy manner. Examples of this approach are
left-to-right tagging models <cite>[<bibref bibrefs="gimenez2004svmtool" separator="," show="Refnum" yyseparator=","/>]</cite> and greedy transition-based parsing <cite>[<bibref bibrefs="nivre2008algorithms" separator="," show="Refnum" yyseparator=","/>]</cite>.
Such approaches are easily adapted to use neural networks
by simply replacing the local classifier from a linear classifier such as an SVM
or a logistic regression model to a neural network, as demonstrated in <cite>[<bibref bibrefs="chen2014fast,lewis2014improved" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S8.SS1.p2">
        <p>The greedy approaches suffer from error propagation, where mistakes in early
decisions carry over and influence later decisions. The overall higher accuracy
achievable with non-linear neural network classifiers helps in offsetting this
problem to some extent. In addition,
training techniques were proposed for mitigating the error
propagation problem by either attempting to take easier predictions before
harder ones (the easy-first approach <cite>[<bibref bibrefs="goldberg2010efficient" separator="," show="Refnum" yyseparator=","/>]</cite>) or making
training conditions more similar to testing conditions by exposing the
training procedure to inputs that result from likely mistakes
<cite>[<bibref bibrefs="daume09searn,goldberg2013training" separator="," show="Refnum" yyseparator=","/>]</cite>. These are effective also for
training greedy neural network models, as demonstrated by Ma et al
<cite>[<bibref bibrefs="ma2014tagging" separator="," show="Refnum" yyseparator=","/>]</cite> (easy-first tagger) and <cite>[<bibref bibrefs="in-submission" separator="," show="Refnum" yyseparator=","/>]</cite> (dynamic
oracle training for greedy dependency parsing).</p>
      </para>
    </subsection>
    <subsection refnum="8.2" xml:id="S8.SS2">
      <title><tag close=" ">8.2</tag>Search Based Structured Prediction</title>
      <para xml:id="S8.SS2.p1">
        <p>The common approach to predicting natural language structures is search based.
For in-depth discussion of search-based structure prediction in NLP, see the book by Smith
<cite>[<bibref bibrefs="smith2011linguistic" separator="," show="Refnum" yyseparator=","/>]</cite>.
<!-- %**** root.tex Line 2025 **** -->The techniques can easily be
adapted to use a neural-network. In the neural-networks literature, such models
were discussed under the framework of <emph>energy based learning</emph>
<cite>[<bibref bibrefs="lecun2006tutorial" separator="," show="Refnum" yyseparator=","/>, Section 7]</cite>. They are presented here using setup and
terminology familiar to the NLP community.</p>
      </para>
      <para xml:id="S8.SS2.p2">
        <p>Search-based structured prediction is formulated as a search problem over
possible structures:</p>
      </para>
      <para xml:id="S8.SS2.p3">
        <equation xml:id="S8.Ex38">
          <Math mode="display" xml:id="S8.Ex38.m1" tex="predict(x)=\operatorname*{arg\,max}_{y\in\mathcal{Y}(x)}score(x,y)" content-tex="predict(x)=\argmax_{y\in\mathcal{Y}(x)}score(x,y)" text="p * r * e * d * i * c * t * x = (argmax _ (y element-of Y * x))@(s * c * o * r * e) * open-interval@(x, y)">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">p</XMTok>
                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                  <XMTok role="UNKNOWN" font="italic">e</XMTok>
                  <XMTok role="UNKNOWN" font="italic">d</XMTok>
                  <XMTok role="UNKNOWN" font="italic">i</XMTok>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">t</XMTok>
                  <XMDual>
                    <XMRef idref="XM660"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM660" font="italic">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                      <XMDual role="OPFUNCTION">
                        <XMTok name="argmax" role="OPFUNCTION" scriptpos="mid"/>
                        <XMApp role="OPERATOR" scriptpos="mid">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                          <XMTok role="UNKNOWN">max</XMTok>
                        </XMApp>
                      </XMDual>
                      <XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="caligraphic">Y</XMTok>
                          <XMDual>
                            <XMRef idref="XM659"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM659" font="italic">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM661"/>
                      <XMRef idref="XM662"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM661" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM662" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p4" class="ltx_noindent">
        <p>where <Math mode="inline" xml:id="S8.SS2.p4.m1" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> is an input structure, <Math mode="inline" xml:id="S8.SS2.p4.m2" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> is an output over <Math mode="inline" xml:id="S8.SS2.p4.m3" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> (in a
typical example <Math mode="inline" xml:id="S8.SS2.p4.m4" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> is a sentence and <Math mode="inline" xml:id="S8.SS2.p4.m5" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> is a tag-assignment or a parse-tree
over the sentence), <Math mode="inline" xml:id="S8.SS2.p4.m6" tex="\mathcal{Y}(x)" text="Y * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="caligraphic">Y</XMTok><XMDual><XMRef idref="XM663"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM663" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is the set of all valid structures over
<Math mode="inline" xml:id="S8.SS2.p4.m7" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math>, and we are looking for an output <Math mode="inline" xml:id="S8.SS2.p4.m8" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> that will maximize the score of the <Math mode="inline" xml:id="S8.SS2.p4.m9" tex="x,y" text="list@(x, y)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM664"/><XMRef idref="XM665"/></XMApp><XMWrap><XMTok role="UNKNOWN" xml:id="XM664" font="italic">x</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM665" font="italic">y</XMTok></XMWrap></XMDual></XMath></Math> pair.</p>
      </para>
      <para xml:id="S8.SS2.p5" class="ltx_noindent">
        <p>The scoring function is defined as a linear model:</p>
        <equation xml:id="S8.Ex39">
          <Math mode="display" xml:id="S8.Ex39.m1" tex="score(x,y)=\Phi(x,y)\cdot\mathbf{w}" text="s * c * o * r * e * open-interval@(x, y) = (Phi * open-interval@(x, y)) cdot w">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM666"/>
                      <XMRef idref="XM667"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM666" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM667" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok name="Phi" possibleFunction="yes" role="UNKNOWN">Φ</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="XM668"/>
                        <XMRef idref="XM669"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="XM668" font="italic">x</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="XM669" font="italic">y</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="UNKNOWN" font="bold">w</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" xml:id="S8.SS2.p5.m1" tex="\Phi" text="Phi"><XMath><XMTok name="Phi" role="UNKNOWN">Φ</XMTok></XMath></Math> is a feature extraction function and <Math mode="inline" xml:id="S8.SS2.p5.m2" tex="\mathbf{w}" text="w"><XMath><XMTok role="UNKNOWN" font="bold">w</XMTok></XMath></Math> is a weight vector.</p>
      </para>
      <para xml:id="S8.SS2.p6">
        <p>In order to make the search for the optimal <Math mode="inline" xml:id="S8.SS2.p6.m1" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> tractable, the structure <Math mode="inline" xml:id="S8.SS2.p6.m2" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> is
<!-- %**** root.tex Line 2050 **** -->decomposed into parts, and the feature function is defined in terms of the
parts, where <Math mode="inline" xml:id="S8.SS2.p6.m3" tex="\phi(p)" text="phi * p"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok><XMDual><XMRef idref="XM670"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM670" font="italic">p</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> is a part-local feature extraction function:</p>
        <equation xml:id="S8.Ex40">
          <Math mode="display" xml:id="S8.Ex40.m1" tex="\Phi(x,y)=\sum_{\mathclap{p\in parts(x,y)}}\phi(p)" text="Phi * open-interval@(x, y) = (sum _ ([\mathclap] * p element-of p * a * r * t * s * open-interval@(x, y)))@(phi * p)">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="Phi" possibleFunction="yes" role="UNKNOWN">Φ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM673"/>
                      <XMRef idref="XM674"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM673" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM674" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <ERROR class="undefined">\mathclap</ERROR>
                        <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">p</XMTok>
                        <XMTok role="UNKNOWN" font="italic">a</XMTok>
                        <XMTok role="UNKNOWN" font="italic">r</XMTok>
                        <XMTok role="UNKNOWN" font="italic">t</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">s</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM671"/>
                            <XMRef idref="XM672"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM671" font="italic">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM672" font="italic">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok>
                    <XMDual>
                      <XMRef idref="XM675"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="XM675" font="italic">p</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p7">
        <p>Each part is scored separately, and the structure score
is the sum of the component parts scores:</p>
      </para>
      <para xml:id="S8.SS2.p8">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx16">
          <equation xml:id="S8.Ex41">
            <MathFork>
              <Math xml:id="S8.Ex41.m3" tex="\displaystyle score(x,y)=\mathbf{w}\cdot\Phi(x,y)=\mathbf{w}\cdot\sum_{p\in y}%&#10;\phi(p)=\sum_{p\in y}\mathbf{w}\cdot\phi(p)=\sum_{p\in y}score(p)" text="s * c * o * r * e * open-interval@(x, y) = (w cdot Phi) * open-interval@(x, y) = w cdot (sum _ (p element-of y))@(phi * p) = (sum _ (p element-of y))@((w cdot phi) * p) = (sum _ (p element-of y))@(s * c * o * r * e * p)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM676"/>
                          <XMRef idref="XM677"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM676" font="italic">x</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM677" font="italic">y</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok role="UNKNOWN" font="bold">w</XMTok>
                        <XMTok name="Phi" possibleFunction="yes" role="UNKNOWN">Φ</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM678"/>
                          <XMRef idref="XM679"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM678" font="italic">x</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM679" font="italic">y</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                      <XMTok role="UNKNOWN" font="bold">w</XMTok>
                      <XMApp>
                        <XMApp scriptpos="mid">
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok role="UNKNOWN" font="italic">p</XMTok>
                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok>
                          <XMDual>
                            <XMRef idref="XM680"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM680" font="italic">p</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok role="UNKNOWN" font="bold">w</XMTok>
                          <XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="XM681"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM681" font="italic">p</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMApp scriptpos="mid">
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok role="UNKNOWN" font="italic">c</XMTok>
                        <XMTok role="UNKNOWN" font="italic">o</XMTok>
                        <XMTok role="UNKNOWN" font="italic">r</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                        <XMDual>
                          <XMRef idref="XM682"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM682" font="italic">p</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle score(x,y)=" xml:id="S8.Ex41.m1" text="s * c * o * r * e * open-interval@(x, y) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">c</XMTok>
                          <XMTok role="UNKNOWN" font="italic">o</XMTok>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM683"/>
                              <XMRef idref="XM684"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM683" font="italic">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM684" font="italic">y</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{w}\cdot\Phi(x,y)=\mathbf{w}\cdot\sum_{p\in y}\phi(p)=\sum%&#10;_{p\in y}\mathbf{w}\cdot\phi(p)=\sum_{p\in y}score(p)" xml:id="S8.Ex41.m2" text="(w cdot Phi) * open-interval@(x, y) = w cdot (sum _ (p element-of y))@(phi * p) = (sum _ (p element-of y))@((w cdot phi) * p) = (sum _ (p element-of y))@(s * c * o * r * e * p)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok name="cdot" role="MULOP">⋅</XMTok>
                            <XMTok role="UNKNOWN" font="bold">w</XMTok>
                            <XMTok name="Phi" possibleFunction="yes" role="UNKNOWN">Φ</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM685"/>
                              <XMRef idref="XM686"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM685" font="italic">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM686" font="italic">y</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok role="UNKNOWN" font="bold">w</XMTok>
                          <XMApp>
                            <XMApp scriptpos="mid">
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok role="UNKNOWN" font="italic">p</XMTok>
                                <XMTok role="UNKNOWN" font="italic">y</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok>
                              <XMDual>
                                <XMRef idref="XM687"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="XM687" font="italic">p</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok role="UNKNOWN" font="italic">p</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok name="cdot" role="MULOP">⋅</XMTok>
                              <XMTok role="UNKNOWN" font="bold">w</XMTok>
                              <XMTok name="phi" possibleFunction="yes" role="UNKNOWN" font="italic">ϕ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="XM688"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM688" font="italic">p</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid8"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok role="UNKNOWN" font="italic">p</XMTok>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok role="UNKNOWN" font="italic">c</XMTok>
                            <XMTok role="UNKNOWN" font="italic">o</XMTok>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                            <XMDual>
                              <XMRef idref="XM689"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="XM689" font="italic">p</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S8.SS2.p9" class="ltx_noindent">
        <p>where <Math mode="inline" xml:id="S8.SS2.p9.m1" tex="p\in y" text="p element-of y"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMath></Math> is a shorthand for <Math mode="inline" xml:id="S8.SS2.p9.m2" tex="p\in parts(x,y)" text="p element-of p * a * r * t * s * open-interval@(x, y)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">s</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM690"/><XMRef idref="XM691"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM690" font="italic">x</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM691" font="italic">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.
The decomposition of <Math mode="inline" xml:id="S8.SS2.p9.m3" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> into parts is such that there exists an inference
algorithm that allows for efficient search for the best scoring structure given
the scores of the individual parts.</p>
      </para>
      <para xml:id="S8.SS2.p10">
        <p>One can now trivially replace the linear scoring function over parts with a neural-network:</p>
      </para>
      <para xml:id="S8.SS2.p11">
        <equation xml:id="S8.Ex42">
          <Math mode="display" xml:id="S8.Ex42.m1" tex="score(x,y)=\sum_{p\in y}score(p)=\sum_{p\in y}NN(c(p))" text="s * c * o * r * e * open-interval@(x, y) = (sum _ (p element-of y))@(s * c * o * r * e * p) = (sum _ (p element-of y))@(N * N * c * p)">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM692"/>
                      <XMRef idref="XM693"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM692" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM693" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                    <XMTok role="UNKNOWN" font="italic">c</XMTok>
                    <XMTok role="UNKNOWN" font="italic">o</XMTok>
                    <XMTok role="UNKNOWN" font="italic">r</XMTok>
                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                    <XMDual>
                      <XMRef idref="XM694"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="XM694" font="italic">p</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" font="italic">N</XMTok>
                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                    <XMDual>
                      <XMRef idref="XM696"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="XM696">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                          <XMDual>
                            <XMRef idref="XM695"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM695" font="italic">p</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p12" class="ltx_noindent">
        <p>where <Math mode="inline" xml:id="S8.SS2.p12.m1" tex="c(p)" text="c * p"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM697"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM697" font="italic">p</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> maps the part <Math mode="inline" xml:id="S8.SS2.p12.m2" tex="p" text="p"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math> into a <Math mode="inline" xml:id="S8.SS2.p12.m3" tex="d_{in}" text="d _ (i * n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> dimensional vector.
<!-- %**** root.tex Line 2075 **** --></p>
      </para>
      <para xml:id="S8.SS2.p13">
        <p>In case of a one hidden-layer feed-forward network:</p>
      </para>
      <para xml:id="S8.SS2.p14">
        <equation xml:id="S8.Ex43">
          <Math mode="display" xml:id="S8.Ex43.m1" tex="score(x,y)=\sum_{p\in y}NN_{MLP1}(c(p))=\sum_{p\in y}(g(c(p)\mathbf{W^{1}}+%&#10;\mathbf{b^{1}}))\mathbf{w}" text="s * c * o * r * e * open-interval@(x, y) = (sum _ (p element-of y))@(N * N _ (M * L * P * 1) * c * p) = (sum _ (p element-of y))@(g * (c * p * W ^ 1 + b ^ 1) * w)">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM698"/>
                      <XMRef idref="XM699"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM698" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM699" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" font="italic">N</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        <XMTok role="UNKNOWN" font="italic">L</XMTok>
                        <XMTok role="UNKNOWN" font="italic">P</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="XM701"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="XM701">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                          <XMDual>
                            <XMRef idref="XM700"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM700" font="italic">p</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp scriptpos="mid">
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok role="UNKNOWN" font="italic">p</XMTok>
                      <XMTok role="UNKNOWN" font="italic">y</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMDual>
                      <XMRef idref="XM704"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="XM704">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMDual>
                            <XMRef idref="XM703"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM703">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                                  <XMDual>
                                    <XMRef idref="XM702"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="XM702" font="italic">p</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                    <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="UNKNOWN" font="bold">w</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p15" class="ltx_noindent">
        <p><Math mode="inline" xml:id="S8.SS2.p15.m1" tex="c(p)\in\mathbb{R}^{d_{in}}" text="c * p element-of R ^ (d _ (i * n))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM705"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM705" font="italic">p</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>,
<Math mode="inline" xml:id="S8.SS2.p15.m2" tex="\mathbf{W^{1}}\in\mathbb{R}^{d_{in}\times d_{1}}" text="W ^ 1 element-of R ^ (d _ (i * n) * d _ 1)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>,
<Math mode="inline" xml:id="S8.SS2.p15.m3" tex="\mathbf{b^{1}}\in\mathbb{R}^{d_{1}}" text="b ^ 1 element-of R ^ (d _ 1)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMath></Math>,
<Math mode="inline" xml:id="S8.SS2.p15.m4" tex="\mathbf{w}\in\mathbb{R}^{d_{1}}" text="w element-of R ^ (d _ 1)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">w</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMApp></XMath></Math>.
A common objective in structured prediction is making the gold structure <Math mode="inline" xml:id="S8.SS2.p15.m5" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math>
score higher than any other structure <Math mode="inline" xml:id="S8.SS2.p15.m6" tex="y^{\prime}" text="y ^ prime"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMath></Math>, leading to the following
(generalized perceptron) loss:</p>
      </para>
      <para xml:id="S8.SS2.p16">
        <equation xml:id="S8.Ex44">
          <Math mode="display" xml:id="S8.Ex44.m1" tex="\max_{y^{\prime}}score(x,y^{\prime})-score(x,y)" text="(maximum _ (y ^ prime))@(s * c * o * r * e) * open-interval@(x, y ^ prime) - s * c * o * r * e * open-interval@(x, y)">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                      <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        <XMTok name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                      <XMTok role="UNKNOWN" font="italic">o</XMTok>
                      <XMTok role="UNKNOWN" font="italic">r</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM706"/>
                      <XMRef idref="XM707"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM706" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM707">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                        <XMTok name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok role="UNKNOWN" font="italic">o</XMTok>
                  <XMTok role="UNKNOWN" font="italic">r</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="XM708"/>
                      <XMRef idref="XM709"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM708" font="italic">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM709" font="italic">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p17">
        <p>In terms of implementation, this means: create a computation graph <Math mode="inline" xml:id="S8.SS2.p17.m1" tex="CG_{p}" text="C * G _ p"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok></XMApp></XMApp></XMath></Math> for
each of the possible parts, and calculate its score. Then, run inference over
the scored parts to find the best scoring structure <Math mode="inline" xml:id="S8.SS2.p17.m2" tex="y^{\prime}" text="y ^ prime"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMath></Math>. Connect the output
nodes of the computation graphs corresponding to parts in the gold (predicted)
structure <Math mode="inline" xml:id="S8.SS2.p17.m3" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> (<Math mode="inline" xml:id="S8.SS2.p17.m4" tex="y^{\prime}" text="y ^ prime"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMath></Math>) into a summing node <Math mode="inline" xml:id="S8.SS2.p17.m5" tex="CG_{y}" text="C * G _ y"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMApp></XMath></Math> (<Math mode="inline" xml:id="S8.SS2.p17.m6" tex="CG_{y}^{\prime}" text="C * (G _ y) ^ prime"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMApp></XMath></Math>). Connect <Math mode="inline" xml:id="S8.SS2.p17.m7" tex="CG_{y}" text="C * G _ y"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp></XMApp></XMath></Math> and
<!-- %**** root.tex Line 2100 **** --><Math mode="inline" xml:id="S8.SS2.p17.m8" tex="CG_{y}^{\prime}" text="C * (G _ y) ^ prime"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok></XMApp><XMTok name="prime" role="SUPOP">′</XMTok></XMApp></XMApp></XMath></Math> using a “minus” node, <Math mode="inline" xml:id="S8.SS2.p17.m9" tex="CG_{l}" text="C * G _ l"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">G</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok></XMApp></XMApp></XMath></Math>, and compute the gradients.</p>
      </para>
      <para xml:id="S8.SS2.p18">
        <p>As argued in <cite>[<bibref bibrefs="lecun2006tutorial" separator="," show="Refnum" yyseparator=","/>, Section 5]</cite>, the generalized perceptron loss may not be
a good loss function when training structured prediction neural networks as it
does not have a margin, and a margin-based hinge loss is preferred:</p>
      </para>
      <para xml:id="S8.SS2.p19">
        <equation xml:id="S8.Ex45">
          <Math mode="display" xml:id="S8.Ex45.m1" tex="max(0,m+score(x,y)-\max_{y^{\prime}\neq y}score(x,y^{\prime}))" text="m * a * x * open-interval@(0, (m + s * c * o * r * e * open-interval@(x, y)) - (maximum _ (y ^ prime not-equals y))@(s * c * o * r * e) * open-interval@(x, y ^ prime))">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" font="italic">m</XMTok>
                <XMTok role="UNKNOWN" font="italic">a</XMTok>
                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">x</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="XM715"/>
                    <XMRef idref="XM716"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="XM715">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="XM716">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok role="UNKNOWN" font="italic">m</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">c</XMTok>
                          <XMTok role="UNKNOWN" font="italic">o</XMTok>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM710"/>
                              <XMRef idref="XM711"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM710" font="italic">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM711" font="italic">y</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMApp scriptpos="mid">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                            <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                            <XMApp>
                              <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">y</XMTok>
                                <XMTok name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" font="italic">s</XMTok>
                            <XMTok role="UNKNOWN" font="italic">c</XMTok>
                            <XMTok role="UNKNOWN" font="italic">o</XMTok>
                            <XMTok role="UNKNOWN" font="italic">r</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM712"/>
                            <XMRef idref="XM714"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM712" font="italic">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM714">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="italic">y</XMTok>
                              <XMTok name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S8.SS2.p20" class="ltx_noindent">
        <p>It is trivial to modify the implementation above to work with the hinge loss.</p>
      </para>
      <para xml:id="S8.SS2.p21">
        <p>Note that in both cases we lose the nice properties of the linear model. In particular,
<!-- %the feature function does not decompose over parts (only the scoring does), and -->the model is no longer convex. This is to be expected, as even the simplest non-linear neural
network is already non-convex. Nonetheless, we could still use standard
neural-network optimization techniques to train the structured model.</p>
      </para>
      <para xml:id="S8.SS2.p22">
        <p>Training and inference is slower, as we have to evaluate the neural network (and
take gradients) <Math mode="inline" xml:id="S8.SS2.p22.m1" tex="|parts(x,y)|" text="absolute-value@(p * a * r * t * s * open-interval@(x, y))"><XMath><XMDual><XMApp><XMTok meaning="absolute-value"/><XMRef idref="XM719"/></XMApp><XMWrap><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp xml:id="XM719"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">p</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">s</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM717"/><XMRef idref="XM718"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM717" font="italic">x</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM718" font="italic">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="VERTBAR" stretchy="false">|</XMTok></XMWrap></XMDual></XMath></Math> times.</p>
      </para>
      <para xml:id="S8.SS2.p23">
        <p>Structured prediction is a vast field and is beyond the scope of this tutorial,
but loss functions, regularizers and methods described in, e.g.,
<cite>[<bibref bibrefs="smith2011linguistic" separator="," show="Refnum" yyseparator=","/>]</cite>, such as cost-augmented decoding, can be easily
<!-- %**** root.tex Line 2125 **** -->applied or adapted to the neural-network framework.<note mark="23" role="footnote">One should keep in
mind that the resulting objectives are no longer convex, and so lack the formal
guarantees and bounds associated with convex optimization problems. Similarly,
the theory, learning bounds and guarantees associated with the algorithms do not
automatically transfer to the neural versions.</note></p>
      </para>
      <paragraph xml:id="S8.SS2.SSS5.Px1">
        <title>Probabilistic objective (CRF)</title>
        <para xml:id="S8.SS2.SSS5.Px1.p1">
          <p>In a probabilistic framework (“CRF”), we treat each of the parts scores as a
<emph>clique potential</emph> (see <cite>[<bibref bibrefs="smith2011linguistic" separator="," show="Refnum" yyseparator=","/>]</cite>) and define the score of each structure <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p1.m1" tex="y" text="y"><XMath><XMTok role="UNKNOWN" font="italic">y</XMTok></XMath></Math> to be:</p>
          <equation xml:id="S8.Ex46">
            <Math mode="display" xml:id="S8.Ex46.m1" tex="score_{CRF}(x,y)=P(y|x)=\frac{\sum_{p\in y}e^{score(p)}}{\sum_{y^{\prime}\in%&#10;\mathcal{Y}(x)}\sum_{p\in y^{\prime}}e^{score(p)}}=\frac{\sum_{p\in y}e^{NN(c(%&#10;p))}}{\sum_{y^{\prime}\in\mathcal{Y}(x)}\sum_{p\in y^{\prime}}e^{NN(c(p))}}">
              <XMath>
                <XMTok role="UNKNOWN" font="italic">s</XMTok>
                <XMTok role="UNKNOWN" font="italic">c</XMTok>
                <XMTok role="UNKNOWN" font="italic">o</XMTok>
                <XMTok role="UNKNOWN" font="italic">r</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN" font="italic">C</XMTok>
                    <XMTok role="UNKNOWN" font="italic">R</XMTok>
                    <XMTok role="UNKNOWN" font="italic">F</XMTok>
                  </XMApp>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok role="UNKNOWN" xml:id="XM728" font="italic">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok role="UNKNOWN" xml:id="XM729" font="italic">y</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok role="UNKNOWN" font="italic">y</XMTok>
                  <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok role="UNKNOWN" font="italic">p</XMTok>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                        <XMTok role="UNKNOWN" font="italic">c</XMTok>
                        <XMTok role="UNKNOWN" font="italic">o</XMTok>
                        <XMTok role="UNKNOWN" font="italic">r</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                        <XMDual>
                          <XMRef idref="XM720"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM720" font="italic">p</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="caligraphic">Y</XMTok>
                          <XMDual>
                            <XMRef idref="XM721"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM721" font="italic">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">e</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">s</XMTok>
                          <XMTok role="UNKNOWN" font="italic">c</XMTok>
                          <XMTok role="UNKNOWN" font="italic">o</XMTok>
                          <XMTok role="UNKNOWN" font="italic">r</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok>
                          <XMDual>
                            <XMRef idref="XM722"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM722" font="italic">p</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="MULOP"/>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok role="UNKNOWN" font="italic">p</XMTok>
                        <XMTok role="UNKNOWN" font="italic">y</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                        <XMDual>
                          <XMRef idref="XM724"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM724">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                              <XMDual>
                                <XMRef idref="XM723"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="XM723" font="italic">p</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                          <XMTok role="UNKNOWN" font="italic">y</XMTok>
                          <XMTok name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="caligraphic">Y</XMTok>
                          <XMDual>
                            <XMRef idref="XM725"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM725" font="italic">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok role="UNKNOWN" font="italic">p</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                            <XMTok role="UNKNOWN" font="italic">y</XMTok>
                            <XMTok name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">e</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMDual>
                            <XMRef idref="XM727"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM727">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok>
                                <XMDual>
                                  <XMRef idref="XM726"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok role="UNKNOWN" xml:id="XM726" font="italic">p</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S8.SS2.SSS5.Px1.p2">
          <p>The scoring function defines a conditional distribution <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p2.m1" tex="P(y|x)"><XMath><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>, and we wish to
set the parameters of the network such that corpus conditional log likelihood
<Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p2.m2" tex="\sum_{(x_{i},y_{i})\in training}\log P(y_{i}|x_{i})"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM730"/><XMRef idref="XM731"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM730"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM731"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">g</XMTok></XMApp></XMApp></XMApp><XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">P</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">y</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math> is maximized.</p>
        </para>
        <para xml:id="S8.SS2.SSS5.Px1.p3">
          <p>The loss for a given training example <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p3.m1" tex="(x,y)" text="open-interval@(x, y)"><XMath><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM732"/><XMRef idref="XM733"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM732" font="italic">x</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM733" font="italic">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> is then: <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p3.m2" tex="-\log score_{CRF}(x,y)" text="- logarithm@(s * c * o * r * e _ (C * R * F)) * open-interval@(x, y)"><XMath><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">r</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">e</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">C</XMTok><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">F</XMTok></XMApp></XMApp></XMApp></XMApp><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM734"/><XMRef idref="XM735"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM734" font="italic">x</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM735" font="italic">y</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.
Taking the gradient with respect to the loss is as involved as building the
associated computation graph. The tricky part is the denominator (the
<emph>partition function</emph>) which requires summing over the potentially
exponentially many structures in <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p3.m3" tex="\mathcal{Y}" text="Y"><XMath><XMTok role="UNKNOWN" font="caligraphic">Y</XMTok></XMath></Math>. However, for some problems, a
dynamic programming algorithm exists for efficiently solving the summation in
polynomial time. When such an algorithm exists, it can be adapted to also create
<!-- %**** root.tex Line 2150 **** -->a polynomial-size computation graph.</p>
        </para>
        <para xml:id="S8.SS2.SSS5.Px1.p4">
          <p>When an efficient enough algorithm for computing the partition function is not
available, approximate methods can be used. For example, one may use beam search
for inference, and for the partition function sum over the structures remaining
in the beam instead of over the exponentially large <Math mode="inline" xml:id="S8.SS2.SSS5.Px1.p4.m1" tex="\mathcal{Y}(x)" text="Y * x"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="caligraphic">Y</XMTok><XMDual><XMRef idref="XM736"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM736" font="italic">x</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>.</p>
        </para>
        <para xml:id="S8.SS2.SSS5.Px1.p5">
          <p>A hinge based approached was used by Pei et al <ERROR class="undefined">\citeyear</ERROR>pei2015effective for
arc-factored dependency parsing, and the probabilistic approach by Durrett and
Klein <cite>[<bibref bibrefs="durrett2015neural" separator="," show="Refnum" yyseparator=","/>]</cite> for a CRF constituency parser.
The approximate beam-based partition function was effectively used by
Zhou et al <ERROR class="undefined">\citeyear</ERROR>zhou2015neural in a transition based parser.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S8.SS2.SSS5.Px2">
        <title>Reranking</title>
        <para xml:id="S8.SS2.SSS5.Px2.p1">
          <p>When searching over all possible structures is
intractable, inefficient or hard to integrate into a model, reranking methods
are often used. In the reranking framework <cite>[<bibref bibrefs="charniak2005coarsetofine,collins2005discriminative" separator="," show="Refnum" yyseparator=","/>]</cite>
a base model is used to produce a list of the <Math mode="inline" xml:id="S8.SS2.SSS5.Px2.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-best scoring structures.
A more complex model is then trained to score the candidates in the <Math mode="inline" xml:id="S8.SS2.SSS5.Px2.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-best
list such that the best structure with respect to the gold one is scored
highest. As the search is now performed over <Math mode="inline" xml:id="S8.SS2.SSS5.Px2.p1.m3" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> items rather than over an
exponential space, the complex model can condition on
(extract features from) arbitrary aspects of the scored structure.
Reranking methods are natural candidates for structured prediction using
neural-network models, as they allow the modeler to focus on the feature
extraction and network structure, while removing the need to integrate the
<!-- %**** root.tex Line 2175 **** -->neural network scoring into a decoder. Indeed, reranking methods are often used
for experimenting with neural models that are not straightforward to integrate
into a decoder, such as convolutional, recurrent and recursive networks, which
will be discussed in later sections. Works using the reranking approach include
<cite>[<bibref bibrefs="socher2013parsing,auli2013joint,le2014insideoutside,zhu2015reranking" separator="," show="Refnum" yyseparator=","/>]</cite></p>
        </para>
      </paragraph>
      <paragraph xml:id="S8.SS2.SSS5.Px3">
        <title>MEMM and hybrid approaches</title>
        <para xml:id="S8.SS2.SSS5.Px3.p1">
          <p>Other formulations are, of course, also possible. For example, an MEMM
<cite>[<bibref bibrefs="mccallum2000maximum" separator="," show="Refnum" yyseparator=","/>]</cite> can be
trivially adapted to the neural network world by replacing the logistic
regression (“Maximum Entropy”) component with an MLP.
<!-- %“cite–@@this-parser-that-is-actually-ratnaparkhi:collobert?˝ --></p>
        </para>
        <para xml:id="S8.SS2.SSS5.Px3.p2">
          <p>Hybrid approaches between neural networks and linear models are also explored.
In particular, Weiss et al <cite>[<bibref bibrefs="weiss2015structured" separator="," show="Refnum" yyseparator=","/>]</cite> report strong results for
transition-based dependency parsing in a two-stage model. In the first stage,
a static feed-forward neural
network (MLP2) is trained to perform well on
each of the individual decisions of the structured problem in isolation.
In the second stage, the neural network model is held fixed, and the
different layers (output as well as hidden layer vectors) for each input are
then concatenated and used as the input features of a linear structured
perceptron model <cite>[<bibref bibrefs="collins2002discriminative" separator="," show="Refnum" yyseparator=","/>]</cite> that is trained to perform
beam-search for the best resulting
structure. While it is not clear that such training regime is more effective than
<!-- %**** root.tex Line 2200 **** -->training a single structured-prediction neural network, the use of two simpler,
isolated models allowed the researchers to perform a much more extensive hyper-parameter
search (e.g. tuning layer sizes, activation functions, learning rates and so on)
for each model than is feasible with more complicated networks.</p>
        </para>
        <pagination role="newpage"/>
      </paragraph>
    </subsection>
  </section>
  <section refnum="9" xml:id="S9" labels="LABEL:sec:convnet">
    <title><tag close=" ">9</tag>Convolutional Layers</title>
    <!-- %“cite–collobert2011natural˝  __ first in NLP? 
     %“cite–kalchbrenner2014convolutional˝  __ first in NLP for doc-classification?
     %“cite–lecun1995convolutional˝ __ source for convnets.
     %“cite–@@@˝ __ great vision results-->
    <para xml:id="S9.p1">
      <p>Sometimes we are interested in making predictions based on ordered sets of items
(e.g. the sequence of words in a sentence, the sequence of sentences in a
document and so on). Consider for example predicting the sentiment (positive,
negative or neutral) of a sentence. Some of the sentence words are very
informative of the sentiment, other words are less informative, and to a good
approximation, an informative clue is informative regardless of its position in
the sentence. We would like to feed all of the sentence words into a learner,
and let the training process figure out the important clues. One possible
solution is feeding a CBOW representation into a fully connected
network such as an MLP. However, a downside of the CBOW approach is that it
<!-- %**** root.tex Line 2225 **** -->ignores the ordering information completely, assigning the sentences “it was
not good, it was actually quite bad” and “it was not bad, it was actually
quite good” the exact same representation. While the global position of the
indicators “not good” and “not bad” does not matter for the classification
task, the local ordering of the words (that the word “not” appears right
before the word “bad”) is very important. A naive approach would suggest
embedding word-pairs (bi-grams) rather than words, and building a CBOW over the
embedded bigrams. While such architecture could be effective, it will result in
huge embedding matrices, will not scale for longer n-grams, and will suffer from
data sparsity problems as it does not share statistical strength between
different n-grams (the embedding of “quite good” and “very good” are
completely independent of one another, so if the learner saw only one of them
during training, it will not be able to deduce anything about the other based on
its component words). The convolution-and-pooling (also called convolutional
neural networks, or CNNs) architecture is an elegant and robust solution to the
this modeling problem. A convolutional neural network is designed to identify
indicative local predictors in a large structure, and combine them to produce a
fixed size vector representation of the structure, capturing these local aspects
that are most informative for the prediction task at hand.</p>
    </para>
    <para xml:id="S9.p2">
      <p>Convolution-and-pooling architectures <cite>[<bibref bibrefs="lecun1995convolutional" separator="," show="Refnum" yyseparator=","/>]</cite> evolved in the neural
networks vision community, where
they showed great success as object detectors – recognizing an object from a
predefined category (“cat”, “bicycles”) regardless of its position in the
image <cite>[<bibref bibrefs="krizhevsky2012imagenet" separator="," show="Refnum" yyseparator=","/>]</cite>. When applied to images, the architecture is using
<!-- %**** root.tex Line 2250 **** -->2-dimensional (grid) convolutions. When applied to text, NLP we are mainly
concerned with 1-d (sequence) convolutions. Convolutional networks were introduced
to the NLP community in the pioneering work of Collobert, Weston and Colleagues <ERROR class="undefined">\citeyear</ERROR>collobert2011natural
who used them for semantic-role labeling, and later by Kalchbrenner et al <ERROR class="undefined">\citeyear</ERROR>kalchbrenner2014convolutional
and Kim <cite>[<bibref bibrefs="kim2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite> who used them for sentiment and question-type classification.</p>
    </para>
    <subsection refnum="9.1" xml:id="S9.SS1">
      <title><tag close=" ">9.1</tag>Basic Convolution + Pooling</title>
      <para xml:id="S9.SS1.p1">
        <p>The main idea behind a convolution and pooling architecture for language tasks
is to apply a non-linear (learned) function over each instantiation of a <Math mode="inline" xml:id="S9.SS1.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>-word sliding
window over the
sentence. This
function (also called “filter”) transforms a window of <Math mode="inline" xml:id="S9.SS1.p1.m2" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> words into a
<Math mode="inline" xml:id="S9.SS1.p1.m3" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> dimensional vector that
captures important properties of the words in the window (each dimension is
sometimes referred to in the literature as a “channel”). Then, a “pooling”
operation is used combine the vectors resulting from the different windows into
a single <Math mode="inline" xml:id="S9.SS1.p1.m4" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector, by taking the max or the average value observed in each of the
<Math mode="inline" xml:id="S9.SS1.p1.m5" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> channels over the different windows. The intention is to focus on the
most important “features” in the sentence, regardless of their location.
The <Math mode="inline" xml:id="S9.SS1.p1.m6" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector is then fed further into a network that is used
for prediction. The gradients that are propagated back from the network’s loss
during the training process are used to tune the parameters of the filter
function to highlight the aspects of the data that are important for the task
the network is trained for. Intuitively, when the sliding window is run over a sequence,
the filter function learns to identify informative k-grams.
<!-- %**** root.tex Line 2275 **** --></p>
      </para>
      <para xml:id="S9.SS1.p2">
        <p>More formally, consider a sequence of words <Math mode="inline" xml:id="S9.SS1.p2.m1" tex="\mathbf{x}=x_{1},\ldots,x_{n}" text="x = list@(x _ 1, ldots, x _ n)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="bold">x</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM737"/><XMRef idref="XM738"/><XMRef idref="XM739"/></XMApp><XMWrap><XMApp xml:id="XM737"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM738">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM739"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMApp></XMath></Math>, each with their
corresponding <Math mode="inline" xml:id="S9.SS1.p2.m2" tex="d_{emb}" text="d _ (e * m * b)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMApp></XMath></Math> dimensional word embedding <Math mode="inline" xml:id="S9.SS1.p2.m3" tex="v(x_{i})" text="v * x _ i"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM740"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM740"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>. A <Math mode="inline" xml:id="S9.SS1.p2.m4" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>d convolution
layer<note mark="24" role="footnote"><Math mode="inline" xml:id="S9.SS1.p2.m5" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>d here refers to a convolution operating over 1-dimensional
inputs such as sequences, as opposed to 2d convolutions which are
applied to images.</note> of width <Math mode="inline" xml:id="S9.SS1.p2.m6" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> works by moving a sliding window of size <Math mode="inline" xml:id="S9.SS1.p2.m7" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> over the
sentence, and applying the same “filter” to each window in the sequence
<Math mode="inline" xml:id="S9.SS1.p2.m8" tex="(v(x_{i});v(x_{i+1}),\ldots;v(x_{i+k-1})"><XMath><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMTok role="PUNCT">;</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM749">…</XMTok><XMTok role="PUNCT">;</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMath></Math>.
The filter function is usually a linear transformation followed by a non-linear activation function.</p>
      </para>
      <para xml:id="S9.SS1.p3">
        <p>Let the concatenated vector of the <Math mode="inline" xml:id="S9.SS1.p3.m1" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th window be <Math mode="inline" xml:id="S9.SS1.p3.m2" tex="\mathbf{w_{i}}=v(x_{i});v(x_{i+1});v(x_{i+k-1})" text="w _ i = list@(v * x _ i, v * x _ (i + 1), v * x _ ((i + k) - 1))"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">w</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM754"/><XMRef idref="XM755"/><XMRef idref="XM756"/></XMApp><XMWrap><XMApp xml:id="XM754"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM751"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM751"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM755"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM752"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM752"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM756"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM753"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM753"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMWrap></XMDual></XMApp></XMath></Math>, <Math mode="inline" xml:id="S9.SS1.p3.m3" tex="\mathbf{w_{i}}\in\mathbb{R}^{kd_{emb}}" text="w _ i element-of R ^ (k * d _ (e * m * b))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">w</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math>.
Depending on whether we pad the sentence with <Math mode="inline" xml:id="S9.SS1.p3.m4" tex="k-1" text="k - 1"><XMath><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> words to each side, we may
get either <Math mode="inline" xml:id="S9.SS1.p3.m5" tex="m=n-k+1" text="m = (n - k) + 1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> (<emph>narrow convolution</emph>) or <Math mode="inline" xml:id="S9.SS1.p3.m6" tex="m=n+k+1" text="m = n + k + 1"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> windows (<emph>wide
convolution</emph>) <cite>[<bibref bibrefs="kalchbrenner2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite>.
The result of the convolution layer is <Math mode="inline" xml:id="S9.SS1.p3.m7" tex="m" text="m"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math> vectors <Math mode="inline" xml:id="S9.SS1.p3.m8" tex="\mathbf{p_{1}},\ldots,\mathbf{p_{m}}" text="list@(p _ 1, ldots, p _ m)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM757"/><XMRef idref="XM758"/><XMRef idref="XM759"/></XMApp><XMWrap><XMApp xml:id="XM757"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM758">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM759"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">m</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, <Math mode="inline" xml:id="S9.SS1.p3.m9" tex="\mathbf{p_{i}}\in\mathbb{R}^{d_{conv}}" text="p _ i element-of R ^ (d _ (c * o * n * v))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math> where:</p>
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx17">
          <equation xml:id="S9.Ex47">
            <MathFork>
              <Math xml:id="S9.Ex47.m2" tex="\displaystyle\mathbf{p_{i}}=g(\mathbf{w_{i}}\mathbf{W}+\mathbf{b})" text="p _ i = g * (w _ i * W + b)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">p</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                      <XMDual>
                        <XMRef idref="XM760"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM760">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">w</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMTok role="UNKNOWN" font="bold">W</XMTok>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="bold">b</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{p_{i}}=g(\mathbf{w_{i}}\mathbf{W}+\mathbf{b})" xml:id="S9.Ex47.m1" text="p _ i = g * (w _ i * W + b)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">p</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMDual>
                            <XMRef idref="XM761"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM761">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">w</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>.</p>
      </para>
      <para xml:id="S9.SS1.p4">
        <p><Math mode="inline" xml:id="S9.SS1.p4.m1" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> is a non-linear activation function that is applied element-wise, <Math mode="inline" xml:id="S9.SS1.p4.m2" tex="\mathbf{W}\in\mathbb{R}^{k\cdot d_{emb}\times d_{conv}}" text="W element-of R ^ ((k cdot d _ (e * m * b)) * d _ (c * o * n * v))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">W</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok name="cdot" role="MULOP">⋅</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMApp></XMApp><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math> and <Math mode="inline" xml:id="S9.SS1.p4.m3" tex="\mathbf{b}\in\mathbb{R}^{d_{conv}}" text="b element-of R ^ (d _ (c * o * n * v))"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math> are parameters of the network. Each <Math mode="inline" xml:id="S9.SS1.p4.m4" tex="\mathbf{p_{i}}" text="p _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is a
<Math mode="inline" xml:id="S9.SS1.p4.m5" tex="d_{conv}" text="d _ (c * o * n * v)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMath></Math> dimensional vector, encoding the information in <Math mode="inline" xml:id="S9.SS1.p4.m6" tex="\mathbf{w_{i}}" text="w _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">w</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>. Ideally,
<!-- %**** root.tex Line 2300 **** -->each dimension captures a different kind of indicative information. The <Math mode="inline" xml:id="S9.SS1.p4.m7" tex="m" text="m"><XMath><XMTok role="UNKNOWN" font="italic">m</XMTok></XMath></Math>
vectors are then combined using a <emph>max pooling layer</emph>, resulting in a
single <Math mode="inline" xml:id="S9.SS1.p4.m8" tex="d_{conv}" text="d _ (c * o * n * v)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMath></Math> dimensional vector <Math mode="inline" xml:id="S9.SS1.p4.m9" tex="\mathbf{c}" text="c"><XMath><XMTok role="UNKNOWN" font="bold">c</XMTok></XMath></Math>.</p>
      </para>
      <para xml:id="S9.SS1.p5">
        <equation xml:id="S9.Ex48">
          <Math mode="display" xml:id="S9.Ex48.m1" tex="c_{j}=\max_{1&lt;i\leq m}\mathbf{p_{i}}[j]" text="c _ j = (maximum _ (1 less i less= m))@(p _ i) * delimited-[]@(j)">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                  <XMTok role="UNKNOWN" font="italic">c</XMTok>
                  <XMTok role="UNKNOWN" font="italic">j</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp scriptpos="mid">
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid3"/>
                      <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                        <XMTok role="UNKNOWN" font="italic">i</XMTok>
                        <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                        <XMTok role="UNKNOWN" font="italic">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="bold">p</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="XM762"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM762" font="italic">j</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S9.SS1.p6" class="ltx_noindent">
        <p><Math mode="inline" xml:id="S9.SS1.p6.m1" tex="\mathbf{p_{i}}[j]" text="p _ i * delimited-[]@(j)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok possibleFunction="yes" role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="delimited-[]"/><XMRef idref="XM763"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok role="UNKNOWN" xml:id="XM763" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math> denotes the <Math mode="inline" xml:id="S9.SS1.p6.m2" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math>th component of <Math mode="inline" xml:id="S9.SS1.p6.m3" tex="\mathbf{p_{i}}" text="p _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>.
The effect of the max-pooling operation is to get the most salient information across
window positions. Ideally, each dimension will “specialize” in a particular
sort of predictors, and max operation will pick on the most important
predictor of each type.</p>
      </para>
      <para xml:id="S9.SS1.p7">
        <p>Figure <ref labelref="LABEL:fig:cnn"/> provides an illustration of the process.</p>
      </para>
      <figure frefnum="Figure 4" placement="t" refnum="4" xml:id="S9.F4" labels="LABEL:fig:cnn">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.9]cnn.pdf</p>
        <toccaption><tag close=" ">4</tag><Math mode="inline" xml:id="S9.F4.m1" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>d convolution+pooling over the sentence “the quick brown fox
jumped over the lazy dog”. This is a narrow convolution (no padding is added to
the sentence) with a window size of 3. Each word is translated to a <Math mode="inline" xml:id="S9.F4.m2" tex="2" text="2"><XMath><XMTok meaning="2" role="NUMBER">2</XMTok></XMath></Math>-dim
embedding vector (not shown). The embedding vectors are then concatenated,
resulting in <Math mode="inline" xml:id="S9.F4.m3" tex="6" text="6"><XMath><XMTok meaning="6" role="NUMBER">6</XMTok></XMath></Math>-dim window representations.
Each of the seven windows is transfered through a <Math mode="inline" xml:id="S9.F4.m4" tex="6\times 3" text="6 * 3"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="6" role="NUMBER">6</XMTok><XMTok meaning="3" role="NUMBER">3</XMTok></XMApp></XMath></Math> filter (linear transformation followed by element-wise tanh),
resulting in seven <Math mode="inline" xml:id="S9.F4.m5" tex="3" text="3"><XMath><XMTok meaning="3" role="NUMBER">3</XMTok></XMath></Math>-dimensional filtered representations. Then, a max-pooling
operation is applied, taking the max over each dimension, resulting in a final
<Math mode="inline" xml:id="S9.F4.m6" tex="3" text="3"><XMath><XMTok meaning="3" role="NUMBER">3</XMTok></XMath></Math>-dimensional pooled vector.</toccaption>
        <caption><tag close=": ">Figure 4</tag><Math mode="inline" xml:id="S9.F4.m7" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>d convolution+pooling over the sentence “the quick brown fox
jumped over the lazy dog”. This is a narrow convolution (no padding is added to
the sentence) with a window size of 3. Each word is translated to a <Math mode="inline" xml:id="S9.F4.m8" tex="2" text="2"><XMath><XMTok meaning="2" role="NUMBER">2</XMTok></XMath></Math>-dim
embedding vector (not shown). The embedding vectors are then concatenated,
resulting in <Math mode="inline" xml:id="S9.F4.m9" tex="6" text="6"><XMath><XMTok meaning="6" role="NUMBER">6</XMTok></XMath></Math>-dim window representations.
Each of the seven windows is transfered through a <Math mode="inline" xml:id="S9.F4.m10" tex="6\times 3" text="6 * 3"><XMath><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMTok meaning="6" role="NUMBER">6</XMTok><XMTok meaning="3" role="NUMBER">3</XMTok></XMApp></XMath></Math> filter (linear transformation followed by element-wise tanh),
resulting in seven <Math mode="inline" xml:id="S9.F4.m11" tex="3" text="3"><XMath><XMTok meaning="3" role="NUMBER">3</XMTok></XMath></Math>-dimensional filtered representations. Then, a max-pooling
operation is applied, taking the max over each dimension, resulting in a final
<Math mode="inline" xml:id="S9.F4.m12" tex="3" text="3"><XMath><XMTok meaning="3" role="NUMBER">3</XMTok></XMath></Math>-dimensional pooled vector.</caption>
      </figure>
      <para xml:id="S9.SS1.p8">
        <p>The resulting vector <Math mode="inline" xml:id="S9.SS1.p8.m1" tex="\mathbf{c}" text="c"><XMath><XMTok role="UNKNOWN" font="bold">c</XMTok></XMath></Math> is a representation of the sentence in which each dimension
reflects the most salient information with respect to some prediction task.
<Math mode="inline" xml:id="S9.SS1.p8.m2" tex="\mathbf{c}" text="c"><XMath><XMTok role="UNKNOWN" font="bold">c</XMTok></XMath></Math> is then fed into a downstream network layers, perhaps in parallel to
other vectors, culminating in an output layer which is used for prediction. The
training procedure of the network calculates the loss with respect to the
prediction task, and the error gradients are propagated all the way back through
the pooling and convolution layers, as well as the embedding layers.
<note mark="25" role="footnote">Besides being useful for prediction, a by-product of the training
procedure is a set of parameters <Math mode="inline" xml:id="S9.SS1.p8.m3" tex="\mathbf{W}" text="W"><XMath><XMTok role="UNKNOWN" font="bold">W</XMTok></XMath></Math>, <Math mode="inline" xml:id="S9.SS1.p8.m4" tex="\mathbf{B}" text="B"><XMath><XMTok role="UNKNOWN" font="bold">B</XMTok></XMath></Math> and embeddings <Math mode="inline" xml:id="S9.SS1.p8.m5" tex="v()" text="v * list@()"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok><XMDual><XMApp><XMTok meaning="list"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> that can
be used in a convolution and pooling architecture to encode arbitrary length
sentences into fixed-size vectors, such that sentences that share the same kind
of predictive information will be close to each other.</note></p>
      </para>
      <para xml:id="S9.SS1.p9">
        <p>While max-pooling is the most common pooling operation in text applications,
other pooling operations are also possible, the second most common operation
being <emph>average pooling</emph>, taking the average value of each index instead of
the max.</p>
      </para>
    </subsection>
    <subsection refnum="9.2" xml:id="S9.SS2">
      <title><tag close=" ">9.2</tag>Dynamic, Hierarchical and k-max Pooling</title>
      <!-- %**** root.tex Line 2350 **** -->
      <para xml:id="S9.SS2.p1">
        <p>Rather than performing a single pooling operation over the entire sequence, we
may want to retain some positional information based on our domain understanding
of the prediction problem at hand. To this end, we can split the vectors
<Math mode="inline" xml:id="S9.SS2.p1.m1" tex="\mathbf{p_{i}}" text="p _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> into <Math mode="inline" xml:id="S9.SS2.p1.m2" tex="\ell" text="ell"><XMath><XMTok name="ell" role="UNKNOWN">ℓ</XMTok></XMath></Math> distinct groups, apply the pooling separately on each group,
and then concatenate the <Math mode="inline" xml:id="S9.SS2.p1.m3" tex="\ell" text="ell"><XMath><XMTok name="ell" role="UNKNOWN">ℓ</XMTok></XMath></Math> resulting <Math mode="inline" xml:id="S9.SS2.p1.m4" tex="d_{conv}" text="d _ (c * o * n * v)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok></XMApp></XMApp></XMath></Math> vectors <Math mode="inline" xml:id="S9.SS2.p1.m5" tex="\mathbf{c_{1}},\ldots,\mathbf{c_{\ell}}" text="list@(c _ 1, ldots, c _ ell)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM764"/><XMRef idref="XM765"/><XMRef idref="XM766"/></XMApp><XMWrap><XMApp xml:id="XM764"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM765">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM766"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok name="ell" role="UNKNOWN">ℓ</XMTok></XMApp></XMWrap></XMDual></XMath></Math>. The division of the <Math mode="inline" xml:id="S9.SS2.p1.m6" tex="\mathbf{p_{i}}" text="p _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>s into groups is performed
based on domain knowledge. For example, we may conjecture that words appearing
early in the sentence are more indicative than words appearing late. We
can then split the sequence into <Math mode="inline" xml:id="S9.SS2.p1.m7" tex="\ell" text="ell"><XMath><XMTok name="ell" role="UNKNOWN">ℓ</XMTok></XMath></Math> equally sized regions, applying a separate
max-pooling to each region. For example, Johnson and Zhang
<cite>[<bibref bibrefs="johnson2014effective" separator="," show="Refnum" yyseparator=","/>]</cite> found
that when classifying documents into topics, it is useful to have 20
average-pooling regions, clearly separating the initial sentences (where
the topic is usually introduced) from later ones, while for a sentiment
classification task a single max-pooling operation over the entire sentence was
optimal (suggesting that one or two very strong signals are enough to determine
the sentiment, regardless of the position in the sentence).</p>
      </para>
      <para xml:id="S9.SS2.p2">
        <p>Similarly, in a relation extraction kind of task we may be given two words and
asked to determine the relation between them. We could argue that the words
before the first word, the words after the second word, and the words between
them provide three different kinds of information <cite>[<bibref bibrefs="chen2015event" separator="," show="Refnum" yyseparator=","/>]</cite>. We can thus
split the <Math mode="inline" xml:id="S9.SS2.p2.m1" tex="\mathbf{p_{i}}" text="p _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">p</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> vectors accordingly, pooling separately the windows
resulting from each group.
<!-- %**** root.tex Line 2375 **** --></p>
      </para>
      <para xml:id="S9.SS2.p3">
        <p>Another variation is performing <emph>hierarchical pooling</emph>, in which we have a
succession of convolution and pooling layers, where each stage applies a
convolution to a sequence, pools every <Math mode="inline" xml:id="S9.SS2.p3.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> neighboring vectors, performs a
convolution on the resulting pooled sequence, applies another convolution and so
on. This architecture allows sensitivity to increasingly larger structures.</p>
      </para>
      <para xml:id="S9.SS2.p4">
        <p>Finally, <cite>[<bibref bibrefs="kalchbrenner2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite> introduced a <emph>k-max pooling</emph>
operation, in which the top <Math mode="inline" xml:id="S9.SS2.p4.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> values in each dimension are retained instead of
only the best one, while preserving the order in which they appeared in the
text.
For example a, consider the following matrix:</p>
      </para>
      <para xml:id="S9.SS2.p5" class="ltx_noindent">
        <equation xml:id="S9.Ex49">
          <Math mode="display" xml:id="S9.Ex49.m1" tex="\begin{bmatrix}1&amp;2&amp;3\\&#10;9&amp;6&amp;5\\&#10;2&amp;3&amp;1\\&#10;7&amp;8&amp;1\\&#10;3&amp;4&amp;1\\&#10;\end{bmatrix}" text="matrix[[1, 2, 3], [9, 6, 5], [2, 3, 1], [7, 8, 1], [3, 4, 1]]">
            <XMath>
              <XMDual>
                <XMRef idref="S9.Ex49.m1.xm1"/>
                <XMWrap>
                  <XMTok role="OPEN">[</XMTok>
                  <XMArray meaning="matrix" xml:id="S9.Ex49.m1.xm1">
                    <XMRow>
                      <XMCell align="center">
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMCell>
                    </XMRow>
                    <XMRow>
                      <XMCell align="center">
                        <XMTok meaning="9" role="NUMBER">9</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="6" role="NUMBER">6</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="5" role="NUMBER">5</XMTok>
                      </XMCell>
                    </XMRow>
                    <XMRow>
                      <XMCell align="center">
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMCell>
                    </XMRow>
                    <XMRow>
                      <XMCell align="center">
                        <XMTok meaning="7" role="NUMBER">7</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="8" role="NUMBER">8</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMCell>
                    </XMRow>
                    <XMRow>
                      <XMCell align="center">
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="4" role="NUMBER">4</XMTok>
                      </XMCell>
                      <XMCell align="center">
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMCell>
                    </XMRow>
                  </XMArray>
                  <XMTok role="CLOSE">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>A 1-max pooling over the column vectors will result in
<Math mode="inline" xml:id="S9.SS2.p5.m1" tex="\begin{bmatrix}9&amp;8&amp;5\\&#10;\end{bmatrix}" text="matrix[[9, 8, 5]]"><XMath><!-- %**** root.tex Line 2400 **** --><XMDual><XMRef idref="S9.SS2.p5.m1.xm1"/><XMWrap><XMTok role="OPEN">[</XMTok><XMArray meaning="matrix" xml:id="S9.SS2.p5.m1.xm1"><XMRow><XMCell align="center"><XMTok meaning="9" role="NUMBER">9</XMTok></XMCell><XMCell align="center"><XMTok meaning="8" role="NUMBER">8</XMTok></XMCell><XMCell align="center"><XMTok meaning="5" role="NUMBER">5</XMTok></XMCell></XMRow></XMArray><XMTok role="CLOSE">]</XMTok></XMWrap></XMDual></XMath></Math>, while a 2-max pooling will result in
the following matrix:
<Math mode="inline" xml:id="S9.SS2.p5.m2" tex="\begin{bmatrix}9&amp;6&amp;3\\&#10;7&amp;8&amp;5\\&#10;\end{bmatrix}" text="matrix[[9, 6, 3], [7, 8, 5]]"><XMath><XMDual><XMRef idref="S9.SS2.p5.m2.xm1"/><XMWrap><XMTok role="OPEN">[</XMTok><XMArray meaning="matrix" xml:id="S9.SS2.p5.m2.xm1"><XMRow><XMCell align="center"><XMTok meaning="9" role="NUMBER">9</XMTok></XMCell><XMCell align="center"><XMTok meaning="6" role="NUMBER">6</XMTok></XMCell><XMCell align="center"><XMTok meaning="3" role="NUMBER">3</XMTok></XMCell></XMRow><XMRow><XMCell align="center"><XMTok meaning="7" role="NUMBER">7</XMTok></XMCell><XMCell align="center"><XMTok meaning="8" role="NUMBER">8</XMTok></XMCell><XMCell align="center"><XMTok meaning="5" role="NUMBER">5</XMTok></XMCell></XMRow></XMArray><XMTok role="CLOSE">]</XMTok></XMWrap></XMDual></XMath></Math> whose rows will then be concatenated to <Math mode="inline" xml:id="S9.SS2.p5.m3" tex="\begin{bmatrix}9&amp;6&amp;3&amp;7&amp;8&amp;5\\&#10;\end{bmatrix}" text="matrix[[9, 6, 3, 7, 8, 5]]"><XMath><XMDual><XMRef idref="S9.SS2.p5.m3.xm1"/><XMWrap><XMTok role="OPEN">[</XMTok><XMArray meaning="matrix" xml:id="S9.SS2.p5.m3.xm1"><XMRow><XMCell align="center"><XMTok meaning="9" role="NUMBER">9</XMTok></XMCell><XMCell align="center"><XMTok meaning="6" role="NUMBER">6</XMTok></XMCell><XMCell align="center"><XMTok meaning="3" role="NUMBER">3</XMTok></XMCell><XMCell align="center"><XMTok meaning="7" role="NUMBER">7</XMTok></XMCell><XMCell align="center"><XMTok meaning="8" role="NUMBER">8</XMTok></XMCell><XMCell align="center"><XMTok meaning="5" role="NUMBER">5</XMTok></XMCell></XMRow></XMArray><XMTok role="CLOSE">]</XMTok></XMWrap></XMDual></XMath></Math></p>
      </para>
      <para xml:id="S9.SS2.p6">
        <p>The k-max pooling operation makes it possible
to pool the <Math mode="inline" xml:id="S9.SS2.p6.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> most active indicators that may be
a number of positions apart; it preserves the order
of the features, but is insensitive to their specific
positions. It can also discern more finely the number
of times the feature is highly activated <cite>[<bibref bibrefs="kalchbrenner2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
    </subsection>
    <subsection refnum="9.3" xml:id="S9.SS3">
      <title><tag close=" ">9.3</tag>Variations</title>
      <para xml:id="S9.SS3.p1">
        <p>Rather than a single convolutional layer, several convolutional layers may be
<!-- %**** root.tex Line 2425 **** -->applied in parallel. For example, we may have four different convolutional
layers, each with a different window size in the range 2–5, capturing n-gram
sequences of varying lengths.
The result of each convolutional layer will then
be pooled, and the resulting vectors concatenated and fed to further processing
<cite>[<bibref bibrefs="kim2014convolutional" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S9.SS3.p2">
        <p>The convolutional architecture need not be restricted into the linear ordering
of a sentence. For example, Ma et al <ERROR class="undefined">\citeyear</ERROR>ma2015dependencybased generalize the
convolution operation to work over syntactic dependency trees. There, each
window is around a node in the syntactic tree, and the pooling is performed over the different nodes.
Similarly, Liu et al <ERROR class="undefined">\citeyear</ERROR>liu2015dependencybased apply a convolutional
architecture on top of dependency paths extracted from dependency trees.
Le and Zuidema <ERROR class="undefined">\citeyear</ERROR>le2015forest propose to perform max pooling
over vectors representing the different derivations leading to the same chart
item in a chart parser.</p>
      </para>
      <pagination role="newpage"/>
    </subsection>
  </section>
  <section refnum="10" xml:id="S10" labels="LABEL:sec:rnn">
    <title><tag close=" ">10</tag>Recurrent Neural Networks – Modeling Sequences and Stacks</title>
    <para xml:id="S10.p1">
      <p>When dealing with language data, it is very common to work with sequences, such
as words (sequences of letters), sentences (sequences of words) and documents.
We saw how feed-forward networks can accommodate arbitrary feature functions over
<!-- %**** root.tex Line 2450 **** -->sequences through the use of vector concatenation and vector addition (CBOW).
In particular, the CBOW representations allows to encode arbitrary length
sequences as fixed sized vectors.
However, the
CBOW representation is quite limited, and forces one to disregard the order of
features. The convolutional networks also allow encoding a sequence into a
fixed size vector. While representations derived from convolutional networks
are an improvement above the CBOW representation as they offer some sensitivity
to word order, their order sensitivity is restricted to mostly local patterns,
and disregards the order of patterns that are far apart in the sequence.</p>
    </para>
    <para xml:id="S10.p2">
      <p>Recurrent neural networks (RNNs) <cite>[<bibref bibrefs="elman1990finding" separator="," show="Refnum" yyseparator=","/>]</cite> allow representing
arbitrarily sized structured
inputs in a fixed-size vector, while paying attention to the structured
properties of the input.</p>
    </para>
    <subsection refnum="10.1" xml:id="S10.SS1">
      <title><tag close=" ">10.1</tag>The RNN Abstraction</title>
      <para xml:id="S10.SS1.p1">
        <p>We use <Math mode="inline" xml:id="S10.SS1.p1.m1" tex="\mathbf{x_{i:j}}" text="x _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMApp></XMath></Math> to denote the sequence of vectors <Math mode="inline" xml:id="S10.SS1.p1.m2" tex="\mathbf{x_{i}},\ldots,\mathbf{x_{j}}" text="list@(x _ i, ldots, x _ j)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM767"/><XMRef idref="XM768"/><XMRef idref="XM769"/></XMApp><XMWrap><XMApp xml:id="XM767"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM768">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM769"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
The RNN abstraction takes as input an ordered list of input vectors
<Math mode="inline" xml:id="S10.SS1.p1.m3" tex="\mathbf{x_{1}},...,\mathbf{x_{n}}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM770"/><XMRef idref="XM771"/><XMRef idref="XM772"/></XMApp><XMWrap><XMApp xml:id="XM770"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM771">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM772"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math> together with an initial <emph>state vector</emph> <Math mode="inline" xml:id="S10.SS1.p1.m4" tex="\mathbf{s_{0}}" text="s _ 0"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok meaning="0" role="NUMBER" font="bold">0</XMTok></XMApp></XMath></Math>,
and returns an ordered list of state vectors <Math mode="inline" xml:id="S10.SS1.p1.m5" tex="\mathbf{s_{1}},...,\mathbf{s_{n}}" text="list@(s _ 1, ldots, s _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM773"/><XMRef idref="XM774"/><XMRef idref="XM775"/></XMApp><XMWrap><XMApp xml:id="XM773"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM774">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM775"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, as well as
an ordered list of <emph>output vectors</emph> <Math mode="inline" xml:id="S10.SS1.p1.m6" tex="\mathbf{y_{1}},...,\mathbf{y_{n}}" text="list@(y _ 1, ldots, y _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM776"/><XMRef idref="XM777"/><XMRef idref="XM778"/></XMApp><XMWrap><XMApp xml:id="XM776"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM777">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM778"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>. An output vector
<Math mode="inline" xml:id="S10.SS1.p1.m7" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is a function of the corresponding state vector <Math mode="inline" xml:id="S10.SS1.p1.m8" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>.
The input vectors <Math mode="inline" xml:id="S10.SS1.p1.m9" tex="\mathbf{x_{i}}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> are presented to the RNN in a sequential fashion, and
the state vector <Math mode="inline" xml:id="S10.SS1.p1.m10" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> and output vector <Math mode="inline" xml:id="S10.SS1.p1.m11" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> represent the state of the RNN after observing the
<!-- %**** root.tex Line 2475 **** -->inputs <Math mode="inline" xml:id="S10.SS1.p1.m12" tex="\mathbf{x_{1:i}}" text="x _ (1 colon i)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp></XMath></Math>. The output vector <Math mode="inline" xml:id="S10.SS1.p1.m13" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is then used for further
prediction. For example, a model for predicting the conditional
probability of an event <Math mode="inline" xml:id="S10.SS1.p1.m14" tex="e" text="e"><XMath><XMTok role="UNKNOWN" font="italic">e</XMTok></XMath></Math> given the sequence <Math mode="inline" xml:id="S10.SS1.p1.m15" tex="\mathbf{m_{1:i}}" text="m _ (1 colon i)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">m</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp></XMath></Math> can be defined as
<Math mode="inline" xml:id="S10.SS1.p1.m16" tex="p(e=j|\mathbf{x_{1:i}})=softmax(\mathbf{y_{i}}\mathbf{W}+\mathbf{b})[j]"><XMath><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">p</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok role="VERTBAR" stretchy="false">|</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">s</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">m</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">x</XMTok><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMath></Math>. The RNN model provides
a framework for conditioning on the entire history <Math mode="inline" xml:id="S10.SS1.p1.m17" tex="\mathbf{x_{1}},\ldots,\mathbf{x_{i}}" text="list@(x _ 1, ldots, x _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM779"/><XMRef idref="XM780"/><XMRef idref="XM781"/></XMApp><XMWrap><XMApp xml:id="XM779"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM780">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM781"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math>
without resorting to the Markov assumption which is traditionally used for modeling
sequences. Indeed, RNN-based language models result in very good perplexity
scores when compared to n-gram based models.</p>
      </para>
      <para xml:id="S10.SS1.p2">
        <p>Mathematically, we have a recursively defined function <Math mode="inline" xml:id="S10.SS1.p2.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> that takes as input a
state vector <Math mode="inline" xml:id="S10.SS1.p2.m2" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> and an input vector <Math mode="inline" xml:id="S10.SS1.p2.m3" tex="\mathbf{x_{i+1}}" text="x _ (i + 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>, and results in a new
state vector <Math mode="inline" xml:id="S10.SS1.p2.m4" tex="\mathbf{s_{i+1}}" text="s _ (i + 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>. An additional function <Math mode="inline" xml:id="S10.SS1.p2.m5" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math> is used to map a state
vector <Math mode="inline" xml:id="S10.SS1.p2.m6" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> to an output vector <Math mode="inline" xml:id="S10.SS1.p2.m7" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>.
When constructing an RNN, much like when constructing a feed-forward network,
one has to specify the dimension of the inputs <Math mode="inline" xml:id="S10.SS1.p2.m8" tex="\mathbf{x_{i}}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> as well as the
dimensions of the outputs <Math mode="inline" xml:id="S10.SS1.p2.m9" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>. The dimensions of the states <Math mode="inline" xml:id="S10.SS1.p2.m10" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> are
a function of the output dimension.<note mark="26" role="footnote">While RNN architectures in which the state dimension
is independent of the output dimension are possible, the current popular
architectures, including the Simple RNN, the LSTM and the GRU do not follow this
flexibility.</note></p>
      </para>
      <para xml:id="S10.SS1.p3">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx18">
          <equation xml:id="S10.Ex50">
            <MathFork>
              <Math xml:id="S10.Ex50.m3" tex="\displaystyle RNN(\mathbf{s_{0}},\mathbf{x_{1:n}})=\mathbf{s_{1:n}},\;\mathbf{%&#10;y_{1:n}}" text="R * N * N * open-interval@(s _ 0, x _ (1 colon n)) = list@(s _ (1 colon n), y _ (1 colon n))">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">R</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM782"/>
                          <XMRef idref="XM783"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM782">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok meaning="0" role="NUMBER" font="bold">0</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM783">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              <XMTok role="UNKNOWN" font="bold">n</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="XM784"/>
                        <XMRef idref="XM785"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="XM784">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            <XMTok role="UNKNOWN" font="bold">n</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                        <XMApp xml:id="XM785">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            <XMTok role="UNKNOWN" font="bold">n</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle RNN(\mathbf{s_{0}},\mathbf{x_{1:n}})=" xml:id="S10.Ex50.m1" text="R * N * N * open-interval@(s _ 0, x _ (1 colon n)) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">R</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM786"/>
                              <XMRef idref="XM787"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM786">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok meaning="0" role="NUMBER" font="bold">0</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM787">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMApp>
                                  <XMTok name="colon" role="METARELOP">:</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">n</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{1:n}},\;\mathbf{y_{1:n}}" xml:id="S10.Ex50.m2" text="list@(s _ (1 colon n), y _ (1 colon n))">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="XM788"/>
                          <XMRef idref="XM789"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM788">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              <XMTok role="UNKNOWN" font="bold">n</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                          <XMApp xml:id="XM789">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">y</XMTok>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              <XMTok role="UNKNOWN" font="bold">n</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S10.Ex51">
            <MathFork>
              <Math xml:id="S10.Ex51.m3" tex="\displaystyle\mathbf{s_{i}}=R(\mathbf{s_{i-1}},\mathbf{x_{i}})" text="s _ i = R * open-interval@(s _ (i - 1), x _ i)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM790"/>
                          <XMRef idref="XM791"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM790">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM791">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{i}}" xml:id="S10.Ex51.m1" text="s _ i">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">s</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=R(\mathbf{s_{i-1}},\mathbf{x_{i}})" xml:id="S10.Ex51.m2" text="absent = R * open-interval@(s _ (i - 1), x _ i)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM792"/>
                              <XMRef idref="XM793"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM792">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM793">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S10.Ex52">
            <MathFork>
              <Math xml:id="S10.Ex52.m3" tex="\displaystyle\mathbf{y_{i}}=O(\mathbf{s_{i}})" text="y _ i = O * s _ i">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">y</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                      <XMDual>
                        <XMRef idref="XM794"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM794">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{y_{i}}" xml:id="S10.Ex52.m1" text="y _ i">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">y</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle=O(\mathbf{s_{i}})" xml:id="S10.Ex52.m2" text="absent = O * s _ i">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                          <XMDual>
                            <XMRef idref="XM795"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM795">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equation xml:id="S10.Ex54">
          <Math mode="display" xml:id="S10.Ex54.m1" tex="\mathbf{x_{i}}\in\mathbb{R}^{d_{in}},\;\;\mathbf{y_{i}}\in\mathbb{R}^{d_{out}}%&#10;,\;\;\mathbf{s_{i}}\in\mathbb{R}^{f(d_{out})}" text="formulae@(x _ i element-of R ^ (d _ (i * n)), formulae@(y _ i element-of R ^ (d _ (o * u * t)), s _ i element-of R ^ (f * d _ (o * u * t))))">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM799"/>
                  <XMRef idref="XM800"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM799">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="bold">x</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          <XMTok role="UNKNOWN" font="italic">n</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                  <XMDual xml:id="XM800">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM797"/>
                      <XMRef idref="XM798"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM797">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">o</XMTok>
                              <XMTok role="UNKNOWN" font="italic">u</XMTok>
                              <XMTok role="UNKNOWN" font="italic">t</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                      <XMApp xml:id="XM798">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok>
                            <XMDual>
                              <XMRef idref="XM796"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM796">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">o</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">u</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">t</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S10.SS1.p4">
        <p>The functions <Math mode="inline" xml:id="S10.SS1.p4.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> and <Math mode="inline" xml:id="S10.SS1.p4.m2" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math> are the same across the sequence positions, but the
RNN keeps track of the states of computation through the state vector that is
kept and being passed between invocations of <Math mode="inline" xml:id="S10.SS1.p4.m3" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math>.</p>
      </para>
      <para xml:id="S10.SS1.p5">
        <p>Graphically, the RNN has been traditionally presented as in Figure
<ref labelref="LABEL:fig:rnn-rec"/>.</p>
      </para>
      <figure frefnum="Figure 5" placement="h!" refnum="5" xml:id="S10.F5" labels="LABEL:fig:rnn-rec">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.3]rnn-cycle.pdf</p>
        <toccaption><tag close=" ">5</tag>Graphical representation of an RNN (recursive).</toccaption>
        <caption><tag close=": ">Figure 5</tag>Graphical representation of an RNN (recursive).</caption>
      </figure>
      <para xml:id="S10.SS1.p6" class="ltx_noindent">
        <p>This presentation follows the recursive definition, and is correct for
arbitrary long sequences. However, for a finite sized input sequence (and all
<!-- %**** root.tex Line 2525 **** -->input sequences we deal with are finite) one can <emph>unroll</emph> the recursion,
resulting in the structure in Figure <ref labelref="LABEL:fig:unrolled-rnn"/>.</p>
      </para>
      <figure frefnum="Figure 6" placement="h!" refnum="6" xml:id="S10.F6" labels="LABEL:fig:unrolled-rnn">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.8]rnn-unrolled.pdf</p>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Graphical representation of an RNN (unrolled).</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 6</tag>Graphical representation of an RNN (unrolled).</caption>
      </figure>
      <para xml:id="S10.SS1.p7" class="ltx_noindent">
        <p>While not usually shown in the visualization, we include here the parameters <Math mode="inline" xml:id="S10.SS1.p7.m1" tex="\theta" text="theta"><XMath><XMTok name="theta" role="UNKNOWN" font="italic">θ</XMTok></XMath></Math>
in order to highlight the fact that the same parameters are shared across all time steps.
Different instantiations of <Math mode="inline" xml:id="S10.SS1.p7.m2" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> and <Math mode="inline" xml:id="S10.SS1.p7.m3" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math> will result in different network
structures, and will exhibit different properties in terms of their running
times and their ability to be trained effectively using gradient-based methods.
However, they all adhere to the same abstract interface. We will provide details
of concrete instantiations of <Math mode="inline" xml:id="S10.SS1.p7.m4" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> and <Math mode="inline" xml:id="S10.SS1.p7.m5" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math> – the Simple RNN, the LSTM and the
GRU – in Section <ref labelref="LABEL:sec:rnn-arch"/>.
Before that, let’s consider modeling with the RNN abstraction.</p>
      </para>
      <para xml:id="S10.SS1.p8">
        <p>First, we note that the value of <Math mode="inline" xml:id="S10.SS1.p8.m1" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is based on the entire input <Math mode="inline" xml:id="S10.SS1.p8.m2" tex="\mathbf{x_{1}},...,\mathbf{x_{i}}" text="list@(x _ 1, ldots, x _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM801"/><XMRef idref="XM802"/><XMRef idref="XM803"/></XMApp><XMWrap><XMApp xml:id="XM801"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM802">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM803"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
For example, by expanding the recursion for <Math mode="inline" xml:id="S10.SS1.p8.m3" tex="i=4" text="i = 4"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="4" role="NUMBER">4</XMTok></XMApp></XMath></Math> we get:
<!-- %“[ 
     %“m–s˙–4˝˝ = R(R(R(R(“m–s˙0˝,“m–x˙1˝),“m–x˙2˝),“m–x˙3˝),“m–x˙4˝)
     %**** root.tex Line 2550 ****
     %“]--></p>
      </para>
      <!-- %“begin–align*˝ 
     %“m–s˙–4˝˝   =& R(“m–s˙3˝,“m–x˙4˝) ““
     %=& R(R(“m–s˙2˝,“m–x˙3˝),“m–x˙4˝) ““
     %=& R(R(R(“m–s˙1˝,“m–x˙2˝),“m–x˙3˝),“m–x˙4˝) ““
     %=& R(R(R(R(“m–s˙0˝,“m–x˙1˝),“m–x˙2˝),“m–x˙3˝),“m–x˙4˝)
     %“end–align*˝-->
      <para xml:id="S10.SS1.p9">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx19">
          <equation xml:id="S10.Ex55">
            <MathFork>
              <Math xml:id="S10.Ex55.m3" tex="\displaystyle\mathbf{s_{4}}=R(\mathbf{s_{3}},\mathbf{x_{4}})" text="s _ 4 = R * open-interval@(s _ 3, x _ 4)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM804"/>
                          <XMRef idref="XM805"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM804">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM805">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{4}}=" xml:id="S10.Ex55.m1" text="s _ 4 = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R(\mathbf{s_{3}},\mathbf{x_{4}})" xml:id="S10.Ex55.m2" text="R * open-interval@(s _ 3, x _ 4)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM806"/>
                            <XMRef idref="XM807"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM806">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">s</XMTok>
                              <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM807">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S10.Ex56">
            <MathFork>
              <Math xml:id="S10.Ex56.m3" tex="\displaystyle=R(\overbrace{R(\mathbf{s_{2}},\mathbf{x_{3}})}^{\mathbf{s_{3}}},%&#10;\mathbf{x_{4}})" text="absent = R * open-interval@((overbrace@(R * open-interval@(s _ 2, x _ 3))) ^ (s _ 3), x _ 4)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM810"/>
                          <XMRef idref="XM811"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp scriptpos="mid" xml:id="XM810">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                            <XMApp scriptpos="mid">
                              <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="XM808"/>
                                    <XMRef idref="XM809"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM808">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                      <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="XM809">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                      <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                      <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                              <XMTok role="UNKNOWN" font="bold">s</XMTok>
                              <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM811">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S10.Ex56.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R(\overbrace{R(\mathbf{s_{2}},\mathbf{x_{3}})}^{\mathbf{s_{3}}},%&#10;\mathbf{x_{4}})" xml:id="S10.Ex56.m2" text="R * open-interval@((overbrace@(R * open-interval@(s _ 2, x _ 3))) ^ (s _ 3), x _ 4)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM814"/>
                            <XMRef idref="XM815"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp scriptpos="mid" xml:id="XM814">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                              <XMApp scriptpos="mid">
                                <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="XM812"/>
                                      <XMRef idref="XM813"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="XM812">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                        <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                        <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="XM813">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                        <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM815">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S10.Ex57">
            <MathFork>
              <Math xml:id="S10.Ex57.m3" tex="\displaystyle=R(R(\overbrace{R(\mathbf{s_{1}},\mathbf{x_{2}})}^{\mathbf{s_{2}}%&#10;},\mathbf{x_{3}}),\mathbf{x_{4}})" text="absent = R * open-interval@(R * open-interval@((overbrace@(R * open-interval@(s _ 1, x _ 2))) ^ (s _ 2), x _ 3), x _ 4)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM824"/>
                          <XMRef idref="XM825"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM824">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM822"/>
                                <XMRef idref="XM823"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp scriptpos="mid" xml:id="XM822">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                  <XMApp scriptpos="mid">
                                    <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="XM816"/>
                                          <XMRef idref="XM817"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="XM816">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="XM817">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                            <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                                    <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                    <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM823">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM825">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S10.Ex57.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R(R(\overbrace{R(\mathbf{s_{1}},\mathbf{x_{2}})}^{\mathbf{s_{2}}%&#10;},\mathbf{x_{3}}),\mathbf{x_{4}})" xml:id="S10.Ex57.m2" text="R * open-interval@(R * open-interval@((overbrace@(R * open-interval@(s _ 1, x _ 2))) ^ (s _ 2), x _ 3), x _ 4)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM834"/>
                            <XMRef idref="XM835"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM834">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="XM832"/>
                                  <XMRef idref="XM833"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp scriptpos="mid" xml:id="XM832">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                    <XMApp scriptpos="mid">
                                      <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="XM826"/>
                                            <XMRef idref="XM827"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="XM826">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                              <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="XM827">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                              <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                      <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM833">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                    <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM835">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S10.Ex58">
            <MathFork>
              <Math xml:id="S10.Ex58.m3" tex="\displaystyle=R(R(R(\overbrace{R(\mathbf{s_{0}},\mathbf{x_{1}})}^{\mathbf{s_{1%&#10;}}},\mathbf{x_{2}}),\mathbf{x_{3}}),\mathbf{x_{4}})" text="absent = R * open-interval@(R * open-interval@(R * open-interval@((overbrace@(R * open-interval@(s _ 0, x _ 1))) ^ (s _ 1), x _ 2), x _ 3), x _ 4)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM866"/>
                          <XMRef idref="XM867"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM866">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="XM864"/>
                                <XMRef idref="XM865"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="XM864">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="XM862"/>
                                      <XMRef idref="XM863"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp scriptpos="mid" xml:id="XM862">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                        <XMApp scriptpos="mid">
                                          <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="XM836"/>
                                                <XMRef idref="XM837"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="XM836">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                                  <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                                  <XMTok meaning="0" role="NUMBER" font="bold">0</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="XM837">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="XM863">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                        <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="XM865">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM867">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle=" xml:id="S10.Ex58.m1" text="=">
                    <XMath>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R(R(R(\overbrace{R(\mathbf{s_{0}},\mathbf{x_{1}})}^{\mathbf{s_{1%&#10;}}},\mathbf{x_{2}}),\mathbf{x_{3}}),\mathbf{x_{4}})" xml:id="S10.Ex58.m2" text="R * open-interval@(R * open-interval@(R * open-interval@((overbrace@(R * open-interval@(s _ 0, x _ 1))) ^ (s _ 1), x _ 2), x _ 3), x _ 4)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="XM898"/>
                            <XMRef idref="XM899"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM898">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="XM896"/>
                                  <XMRef idref="XM897"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM896">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="XM894"/>
                                        <XMRef idref="XM895"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp scriptpos="mid" xml:id="XM894">
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid8"/>
                                          <XMApp scriptpos="mid">
                                            <XMTok name="overbrace" role="OVERACCENT">⏞</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="XM868"/>
                                                  <XMRef idref="XM869"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="XM868">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                                    <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                                    <XMTok meaning="0" role="NUMBER" font="bold">0</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="XM869">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post11"/>
                                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post10"/>
                                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="XM895">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                          <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                          <XMTok meaning="2" role="NUMBER" font="bold">2</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="XM897">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                    <XMTok meaning="3" role="NUMBER" font="bold">3</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM899">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              <XMTok meaning="4" role="NUMBER" font="bold">4</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <!-- %“[ 
     %“vec–s˙–4˝˝ = R(“underbrace–R(“underbrace–R(“underbrace–R(s˙0,x˙1)˝˙–s˙1˝,x˙2)˝˙–s˙2˝,x˙3)˝˙–s˙3˝,x˙4)
     %“]-->
      <para xml:id="S10.SS1.p10">
        <p>Thus, <Math mode="inline" xml:id="S10.SS1.p10.m1" tex="\mathbf{s_{n}}" text="s _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math> (as well as <Math mode="inline" xml:id="S10.SS1.p10.m2" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>) could be thought of as <emph>encoding</emph> the entire input
sequence.<note mark="27" role="footnote"><!-- %**** root.tex Line 2575 **** -->Note that, unless <Math mode="inline" xml:id="S10.SS1.p10.m3" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> is specifically designed against this,
it is likely that the later elements of the input sequence have stronger effect
on <Math mode="inline" xml:id="S10.SS1.p10.m4" tex="\mathbf{s_{n}}" text="s _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math> than earlier ones.</note>
Is the encoding useful? This depends on our definition of usefulness. The job of
the network training is to set the parameters of <Math mode="inline" xml:id="S10.SS1.p10.m5" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> and <Math mode="inline" xml:id="S10.SS1.p10.m6" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math> such that the state
conveys useful information for the task we are tying to solve.</p>
      </para>
    </subsection>
    <subsection refnum="10.2" xml:id="S10.SS2">
      <title><tag close=" ">10.2</tag>RNN Training</title>
      <para xml:id="S10.SS2.p1">
        <p>Viewed as in Figure <ref labelref="LABEL:fig:unrolled-rnn"/> it is easy to see that an unrolled RNN is just a
very deep neural network (or rather, a very large <emph>computation graph</emph> with
somewhat complex nodes), in which the same parameters are shared across many
parts of the computation. To train an RNN network, then, all we need to do is to
create the unrolled computation graph for a given input sequence, add a loss
node to the unrolled graph, and then use the backward (backpropagation)
algorithm to compute the gradients with respect to that loss. This procedure is
referred to in the RNN literature as <emph>backpropagation through time</emph>, or
BPTT <cite>[<bibref bibrefs="werbos1990backpropagation" separator="," show="Refnum" yyseparator=","/>]</cite>.<note mark="28" role="footnote"><!-- %**** root.tex Line 2600 **** -->Variants of the BPTT algorithm include unrolling the RNN
only for a fixed number of input symbols at each time: first unroll the RNN for
inputs <Math mode="inline" xml:id="S10.SS2.p1.m1" tex="\mathbf{x_{1:k}}" text="x _ (1 colon k)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">k</XMTok></XMApp></XMApp></XMath></Math>, resulting in <Math mode="inline" xml:id="S10.SS2.p1.m2" tex="\mathbf{s_{1:k}}" text="s _ (1 colon k)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">k</XMTok></XMApp></XMApp></XMath></Math>. Compute a loss, and
backpropagate the error through the network (<Math mode="inline" xml:id="S10.SS2.p1.m3" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> steps back). Then, unroll the
inputs <Math mode="inline" xml:id="S10.SS2.p1.m4" tex="\mathbf{x_{k+1:2k}}" text="x _ (k + 1 colon 2 * k)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">k</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok><XMTok role="UNKNOWN" font="bold">k</XMTok></XMApp></XMApp></XMApp></XMath></Math>, this time using <Math mode="inline" xml:id="S10.SS2.p1.m5" tex="\mathbf{s_{k}}" text="s _ k"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">k</XMTok></XMApp></XMath></Math> as the initial state, and
again backpropagate the error for <Math mode="inline" xml:id="S10.SS2.p1.m6" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> steps, and so on. This strategy is based
on the observations that for the Simple-RNN variant, the gradients after <Math mode="inline" xml:id="S10.SS2.p1.m7" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>
steps tend to vanish (for large enough <Math mode="inline" xml:id="S10.SS2.p1.m8" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math>), and so omitting them is negligible.
This procedure allows training of arbitrarily long sequences. For RNN variants
such as the LSTM or the GRU that are designed specifically to mitigate the
vanishing gradients problem, this fixed size unrolling is less motivated,
yet it is still being used, for example when doing language modeling over a book
without breaking it into sentences.</note> There are various ways in which the
supervision signal can be applied.</p>
      </para>
      <paragraph xml:id="S10.SS2.SSS5.Px1">
        <title>Acceptor</title>
        <para xml:id="S10.SS2.SSS5.Px1.p1">
          <p>One option is to base the supervision signal only on the
final output vector, <Math mode="inline" xml:id="S10.SS2.SSS5.Px1.p1.m1" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>. Viewed this way, the RNN is an
<emph>acceptor</emph>.
We observe the final state, and then decide on an outcome.<note mark="29" role="footnote">The terminology is borrowed from Finite-State
Acceptors. However, the RNN has a potentially infinite number of states, making
it necessary to rely on a function other than a lookup table for mapping states to
decisions.</note>
For example, consider training an RNN to read the characters of a word one by
one and then use the final state to predict the part-of-speech of that word
(this is inspired by <cite>[<bibref bibrefs="ling2015finding" separator="," show="Refnum" yyseparator=","/>]</cite>), an RNN that reads in a sentence and,
based on the final state decides if it conveys positive or negative sentiment
(this is inspired by <cite>[<bibref bibrefs="wang2015predicting" separator="," show="Refnum" yyseparator=","/>]</cite>) or an RNN that reads in a sequence of words
and decides whether it is a valid noun-phrase.
The loss in such cases is defined in terms of a function of <Math mode="inline" xml:id="S10.SS2.SSS5.Px1.p1.m2" tex="\mathbf{y_{n}}=O(\mathbf{s_{n}})" text="y _ n = O * s _ n"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok><XMDual><XMRef idref="XM900"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM900"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>, and the
error gradients will backpropagate through the rest of the
sequence (see Figure <ref labelref="LABEL:fig:acceptor-rnn"/>).<note mark="30" role="footnote">This kind of supervision signal may be hard to train for long
sequences, especially so with the Simple-RNN, because of the vanishing gradients problem.
It is also a generally hard learning task, as we do not tell the process on which parts of the input to focus.</note>
<!-- %**** root.tex Line 2625 **** -->The loss can take any familiar form – cross entropy, hinge, margin, etc.</p>
        </para>
        <figure frefnum="Figure 7" placement="ht" refnum="7" xml:id="S10.F7" labels="LABEL:fig:acceptor-rnn">
          <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
          <p align="center">[width=0.6]acceptor-rnn.pdf</p>
          <toccaption><tag close=" ">7</tag>Acceptor RNN Training Graph.</toccaption>
          <caption><tag close=": ">Figure 7</tag>Acceptor RNN Training Graph.</caption>
        </figure>
      </paragraph>
      <paragraph xml:id="S10.SS2.SSS5.Px2">
        <title>Encoder</title>
        <para xml:id="S10.SS2.SSS5.Px2.p1">
          <p>Similar to the acceptor case, an encoder supervision uses only the final output
vector, <Math mode="inline" xml:id="S10.SS2.SSS5.Px2.p1.m1" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>. However, unlike the acceptor, where a prediction is made solely on the basis of
the final vector, here the final vector is treated as an encoding of the information in the sequence,
and is used as additional information together with other signals. For example, an extractive document
summarization system may first run over the document with an RNN, resulting in a
vector <Math mode="inline" xml:id="S10.SS2.SSS5.Px2.p1.m2" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math> summarizing the entire document. Then, <Math mode="inline" xml:id="S10.SS2.SSS5.Px2.p1.m3" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math> will be used
together with with other features in order to select the sentences to be included in the summarization.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S10.SS2.SSS5.Px3">
        <title>Transducer</title>
        <para xml:id="S10.SS2.SSS5.Px3.p1">
          <p>Another option is to treat the RNN as a transducer,
producing an output for each input it reads in. Modeled this way, we can compute
a local loss signal <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m1" tex="L_{local}(\mathbf{\hat{y_{i}}},\mathbf{y_{i}})" text="L _ (l * o * c * a * l) * open-interval@(hat@(y _ i), y _ i)"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok></XMApp></XMApp><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM901"/><XMRef idref="XM902"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM901"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM902"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> for each of the outputs
<Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m2" tex="\mathbf{\hat{y_{i}}}" text="hat@(y _ i)"><XMath><XMApp><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp></XMath></Math> based on a true label <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m3" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>. The loss for unrolled sequence
will then be: <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m4" tex="L(\mathbf{\hat{y_{1:n}}},\mathbf{y_{1:n}})=\sum_{i=1}^{n}{L_{local}(\mathbf{%&#10;\hat{y_{i}}},\mathbf{y_{i}})}" text="L * open-interval@(hat@(y _ (1 colon n)), y _ (1 colon n)) = ((sum _ (i = 1)) ^ n)@(L _ (l * o * c * a * l) * open-interval@(hat@(y _ i), y _ i))"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM903"/><XMRef idref="XM904"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM903"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post6"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM904"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">L</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok><XMTok role="UNKNOWN" font="italic">o</XMTok><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok role="UNKNOWN" font="italic">a</XMTok><XMTok role="UNKNOWN" font="italic">l</XMTok></XMApp></XMApp><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM905"/><XMRef idref="XM906"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM905"><XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post7"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM906"><XMTok role="SUBSCRIPTOP" scriptpos="post5"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMApp></XMath></Math>, or using another combination rather
than a sum such as an average or a weighted average (see Figure
<!-- %**** root.tex Line 2650 **** --><ref labelref="LABEL:fig:transducer-rnn"/>). One example for such a
transducer is a sequence tagger, in which we take <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m5" tex="\mathbf{x_{i:n}}" text="x _ (i colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math> to be feature
representations for the <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m6" tex="n" text="n"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math> words of a sentence, and <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m7" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> as an input for
predicting the tag
assignment of word <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m8" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> based on words <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m9" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>:<Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p1.m10" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>.
A CCG super-tagger based on such an
architecture provides state-of-the art CCG super-tagging results
<cite>[<bibref bibrefs="xu2015ccg" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
        <figure frefnum="Figure 8" placement="ht" refnum="8" xml:id="S10.F8" labels="LABEL:fig:transducer-rnn">
          <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
          <p align="center">[width=0.6]transducer-rnn.pdf</p>
          <toccaption><tag close=" ">8</tag>Transducer RNN Training Graph.</toccaption>
          <caption><tag close=": ">Figure 8</tag>Transducer RNN Training Graph.</caption>
        </figure>
        <para xml:id="S10.SS2.SSS5.Px3.p2">
          <p>A very natural use-case of the transduction setup is for
language modeling, in which the sequence of words <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p2.m1" tex="\mathbf{x_{1:i}}" text="x _ (1 colon i)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMApp></XMath></Math> is used to
predict a distribution over the <Math mode="inline" xml:id="S10.SS2.SSS5.Px3.p2.m2" tex="i+1" text="i + 1"><XMath><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math>th word. RNN based language models are shown to
provide much better perplexities than traditional language models
<cite>[<bibref bibrefs="mikolov2010recurrent,sundermeyer2012lstm,mikolov2012statistical" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
        <para xml:id="S10.SS2.SSS5.Px3.p3">
          <p>Using RNNs as transducers allows us to relax the Markov assumption that is
<!-- %**** root.tex Line 2675 **** -->traditionally taken in language models and HMM taggers, and condition on the
entire prediction history. The power of the ability to condition on arbitrarily long
histories is demonstrated in generative character-level RNN models, in which
a text is generated character by character, each character conditioning on the
previous ones <cite>[<bibref bibrefs="sutskever2011generating" separator="," show="Refnum" yyseparator=","/>]</cite>. The generated texts show sensitivity to properties that are not
captured by n-gram language models, including line lengths and nested
parenthesis balancing. For a good demonstration and analysis of the properties of
RNN-based character level
language models, see <cite>[<bibref bibrefs="karpathy2015visualizing" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
        </para>
      </paragraph>
      <paragraph xml:id="S10.SS2.SSS5.Px4">
        <title>Encoder - Decoder</title>
        <para xml:id="S10.SS2.SSS5.Px4.p1">
          <p>Finally, an important special case of the encoder scenario
is the Encoder-Decoder framework <cite>[<bibref bibrefs="cho2014properties,sutskever2014sequence" separator="," show="Refnum" yyseparator=","/>]</cite>.
The RNN is used to encode the sequence
into a vector representation <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p1.m1" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>, and this vector representation is then used
as auxiliary input to another RNN that is used as a decoder. For example, in a machine-translation
setup the first RNN encodes the source sentence
into a vector representation <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p1.m2" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>, and then this state vector is fed into a separate
(decoder) RNN that is trained to predict (using a transducer-like language modeling objective)
the words of the target language sentence based on the previously predicted
words as well as <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p1.m3" tex="\mathbf{y_{n}}" text="y _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math>.
The supervision happens only for the decoder RNN,
but the gradients are propagated all the way back to the encoder RNN (see Figure
<ref labelref="LABEL:fig:encdec-rnn"/>).</p>
        </para>
        <figure frefnum="Figure 9" placement="h!" refnum="9" xml:id="S10.F9" labels="LABEL:fig:encdec-rnn">
          <!-- %**** root.tex Line 2700 **** -->
          <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
          <p align="center">[width=0.8]encdec-rnn2.pdf</p>
          <toccaption><tag close=" ">9</tag>Encoder-Decoder RNN Training Graph.</toccaption>
          <caption><tag close=": ">Figure 9</tag>Encoder-Decoder RNN Training Graph.</caption>
        </figure>
        <para xml:id="S10.SS2.SSS5.Px4.p2">
          <p>Such an
approach was shown to be surprisingly effective for Machine Translation
<cite>[<bibref bibrefs="sutskever2014sequence" separator="," show="Refnum" yyseparator=","/>]</cite> using LSTM RNNs. In order for this technique to work,
Sutskever et al found it effective to input the source sentence in reverse,
such that <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m1" tex="\mathbf{x_{n}}" text="x _ n"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMath></Math> corresponds to the first word of the sentence. In this way,
it is easier for the second RNN to establish the relation between the first word
of the source sentence to the first word of the target sentence.
Another use-case of the encoder-decoder framework is for sequence transduction.
Here, in order to generate tags <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m2" tex="t_{1},\ldots,t_{n}" text="list@(t _ 1, ldots, t _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM907"/><XMRef idref="XM908"/><XMRef idref="XM909"/></XMApp><XMWrap><XMApp xml:id="XM907"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM908">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM909"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, an encoder RNN is first used
to encode the sentence <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m3" tex="\mathbf{x_{1:n}}" text="x _ (1 colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math> into fixed sized vector. This vector is then fed as the
initial state vector of another (transducer) RNN, which is used together with <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m4" tex="\mathbf{x_{1:n}}" text="x _ (1 colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math>
to predict the label <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m5" tex="t_{i}" text="t _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">t</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> at each position <Math mode="inline" xml:id="S10.SS2.SSS5.Px4.p2.m6" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>. This approach was used in
<cite>[<bibref bibrefs="filippova2015sentence" separator="," show="Refnum" yyseparator=","/>]</cite> to model sentence compression by deletion.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="10.3" xml:id="S10.SS3">
      <title><tag close=" ">10.3</tag>Multi-layer (stacked) RNNs</title>
      <para xml:id="S10.SS3.p1">
        <p>RNNs can be stacked in layers, forming a
grid <cite>[<bibref bibrefs="hihi1996hierarchical" separator="," show="Refnum" yyseparator=","/>]</cite>. Consider <Math mode="inline" xml:id="S10.SS3.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> RNNs, <Math mode="inline" xml:id="S10.SS3.p1.m2" tex="RNN_{1},\ldots,RNN_{k}" text="list@(R * N * N _ 1, ldots, R * N * N _ k)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM910"/><XMRef idref="XM911"/><XMRef idref="XM912"/></XMApp><XMWrap><XMApp xml:id="XM910"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM911">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM912"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMWrap></XMDual></XMath></Math>,
<!-- %**** root.tex Line 2725 **** -->where the <Math mode="inline" xml:id="S10.SS3.p1.m3" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math>th RNN has states <Math mode="inline" xml:id="S10.SS3.p1.m4" tex="\mathbf{s_{1:n}^{j}}" text="(s _ (1 colon n)) ^ j"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> and outputs <Math mode="inline" xml:id="S10.SS3.p1.m5" tex="\mathbf{y_{1:n}^{j}}" text="(y _ (1 colon n)) ^ j"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math>.
The input for the first RNN are <Math mode="inline" xml:id="S10.SS3.p1.m6" tex="\mathbf{x_{1:n}}" text="x _ (1 colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math>, while the input of the
<Math mode="inline" xml:id="S10.SS3.p1.m7" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math>th RNN (<Math mode="inline" xml:id="S10.SS3.p1.m8" tex="j\geq 2" text="j &gt;= 2"><XMath><XMApp><XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math>) are the outputs of the RNN below it, <Math mode="inline" xml:id="S10.SS3.p1.m9" tex="\mathbf{y_{1:n}^{j-1}}" text="(y _ (1 colon n)) ^ (j - 1)"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>.
The output of the entire formation is the output of the last RNN,
<Math mode="inline" xml:id="S10.SS3.p1.m10" tex="\mathbf{y_{1:n}^{k}}" text="(y _ (1 colon n)) ^ k"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="bold">k</XMTok></XMApp></XMath></Math>.
Such layered architectures are often called <emph>deep RNNs</emph>. A visual
representation of a 3-layer RNN is given in Figure <ref labelref="LABEL:fig:stacked-rnn"/>.</p>
      </para>
      <figure frefnum="Figure 10" placement="h!t" refnum="10" xml:id="S10.F10" labels="LABEL:fig:stacked-rnn">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.6]stacked-rnn.pdf</p>
        <toccaption><tag close=" ">10</tag>A 3-layer (“deep”) RNN architecture.</toccaption>
        <caption><tag close=": ">Figure 10</tag>A 3-layer (“deep”) RNN architecture.</caption>
      </figure>
      <para xml:id="S10.SS3.p2">
        <p>While it is not theoretically clear what is
the additional power gained by the deeper architecture, it was observed
empirically that deep RNNs work better than shallower ones on some tasks.
In particular, Sutskever et al <ERROR class="undefined">\citeyear</ERROR>sutskever2014sequence report that a
4-layers deep architecture was crucial in achieving good machine-translation
performance in an encoder-decoder framework. Irsoy and Cardie
<ERROR class="undefined">\citeyear</ERROR>irsoy2014opinion also report improved results from moving from a
one-layer BI-RNN to an architecture with several layers.
<!-- %**** root.tex Line 2750 **** -->Many other works report result
using layered RNN architectures, but do not explicitly compare to
1-layer RNNs.</p>
      </para>
    </subsection>
    <subsection refnum="10.4" xml:id="S10.SS4">
      <title><tag close=" ">10.4</tag>BI-RNN</title>
      <para xml:id="S10.SS4.p1">
        <p>A useful elaboration of an RNN is a <emph>bidirectional-RNN</emph> (BI-RNN)
<cite>[<bibref bibrefs="schuster1997bidirectional,graves2008supervised" separator="," show="Refnum" yyseparator=","/>]</cite>.<note mark="31" role="footnote">When used with a
specific RNN architecture such as an LSTM, the model is called BI-LSTM.</note>
Consider the task of sequence tagging over a sentence <Math mode="inline" xml:id="S10.SS4.p1.m1" tex="x_{1},\ldots,x_{n}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM913"/><XMRef idref="XM914"/><XMRef idref="XM915"/></XMApp><XMWrap><XMApp xml:id="XM913"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM914">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM915"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
An RNN allows us to compute a function
of the <Math mode="inline" xml:id="S10.SS4.p1.m2" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>th word <Math mode="inline" xml:id="S10.SS4.p1.m3" tex="x_{i}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math> based on the past – the words <Math mode="inline" xml:id="S10.SS4.p1.m4" tex="x_{1:i}" text="x _ (1 colon i)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMApp></XMath></Math> up to and including it.
However, the following words <Math mode="inline" xml:id="S10.SS4.p1.m5" tex="x_{i:n}" text="x _ (i colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> may also be useful for prediction, as is
evident by the common sliding-window approach in which the focus word is
categorized based on a window of <Math mode="inline" xml:id="S10.SS4.p1.m6" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> words surrounding it.
Much like the RNN relaxes the Markov assumption and allows looking
arbitrarily back into the past, the BI-RNN relaxes the fixed
window size assumption, allowing to look arbitrarily far at both the past and
the future.</p>
      </para>
      <para xml:id="S10.SS4.p2">
        <p>Consider an input sequence <Math mode="inline" xml:id="S10.SS4.p2.m1" tex="\mathbf{x_{1:n}}" text="x _ (1 colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math>.
The BI-RNN works by maintaining two separate states, <Math mode="inline" xml:id="S10.SS4.p2.m2" tex="\mathbf{s^{f}_{i}}" text="(s ^ f) _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">f</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S10.SS4.p2.m3" tex="\mathbf{s^{b}_{i}}" text="(s ^ b) _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> for each input position <Math mode="inline" xml:id="S10.SS4.p2.m4" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>.
The <emph>forward state</emph> <Math mode="inline" xml:id="S10.SS4.p2.m5" tex="\mathbf{s^{f}_{i}}" text="(s ^ f) _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">f</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is based on <Math mode="inline" xml:id="S10.SS4.p2.m6" tex="\mathbf{x_{1}},\mathbf{x_{2}},\ldots,\mathbf{x_{i}}" text="list@(x _ 1, x _ 2, ldots, x _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM916"/><XMRef idref="XM917"/><XMRef idref="XM918"/><XMRef idref="XM919"/></XMApp><XMWrap><XMApp xml:id="XM916"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM917"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="2" role="NUMBER" font="bold">2</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM918">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM919"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math>, while the
<emph>backward state</emph> <Math mode="inline" xml:id="S10.SS4.p2.m7" tex="\mathbf{s^{b}_{i}}" text="(s ^ b) _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is based on <Math mode="inline" xml:id="S10.SS4.p2.m8" tex="\mathbf{x_{n}},\mathbf{x_{n-1}},\ldots,\mathbf{x_{i}}" text="list@(x _ n, x _ (n - 1), ldots, x _ i)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM920"/><XMRef idref="XM921"/><XMRef idref="XM922"/><XMRef idref="XM923"/></XMApp><XMWrap><XMApp xml:id="XM920"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM921"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM922">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM923"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMWrap></XMDual></XMath></Math>.
The forward and backward states are generated by two different RNNs. The first
<!-- %**** root.tex Line 2775 **** -->RNN (<Math mode="inline" xml:id="S10.SS4.p2.m9" tex="R^{f}" text="R ^ f"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok></XMApp></XMath></Math>, <Math mode="inline" xml:id="S10.SS4.p2.m10" tex="O^{f}" text="O ^ f"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok></XMApp></XMath></Math>)
is fed the input sequence <Math mode="inline" xml:id="S10.SS4.p2.m11" tex="\mathbf{x_{1:n}}" text="x _ (1 colon n)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok><XMTok role="UNKNOWN" font="bold">n</XMTok></XMApp></XMApp></XMath></Math> as is, while the second RNN (<Math mode="inline" xml:id="S10.SS4.p2.m12" tex="R^{b}" text="R ^ b"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMath></Math>, <Math mode="inline" xml:id="S10.SS4.p2.m13" tex="O^{b}" text="O ^ b"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp></XMath></Math>) is fed the
input sequence in reverse.
The state representation <Math mode="inline" xml:id="S10.SS4.p2.m14" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is then composed of both the forward and
backward states.</p>
      </para>
      <para xml:id="S10.SS4.p3">
        <p>The output at position <Math mode="inline" xml:id="S10.SS4.p3.m1" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> is based on the concatenation of the two output
vectors <Math mode="inline" xml:id="S10.SS4.p3.m2" tex="\mathbf{y_{i}}=[\mathbf{y^{f}_{i}};\mathbf{y^{b}_{i}}]=[O^{f}(\mathbf{s^{f}_{i%&#10;}});O^{b}(\mathbf{s^{b}_{i}})]" text="y _ i = list@((y ^ f) _ i, (y ^ b) _ i) = list@(O ^ f * (s ^ f) _ i, O ^ b * (s ^ b) _ i)"><XMath><XMApp><XMTok meaning="multirelation"/><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM924"/><XMRef idref="XM925"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM924"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">f</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM925"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok meaning="equals" role="RELOP">=</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM928"/><XMRef idref="XM929"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM928"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">f</XMTok></XMApp><XMDual><XMRef idref="XM926"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM926"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">f</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM929"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok><XMTok role="UNKNOWN" font="italic">b</XMTok></XMApp><XMDual><XMRef idref="XM927"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM927"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">b</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math>,
taking into account both the past and the future.
The vector <Math mode="inline" xml:id="S10.SS4.p3.m3" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> can then be used directly for prediction, or fed as part of the
input to a more complex network.
While the two RNNs are run independently of each other, the error gradients at
position <Math mode="inline" xml:id="S10.SS4.p3.m4" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> will flow both forward and backward through the two RNNs. A
visual
representation of the BI-RNN architecture is given in Figure <ref labelref="LABEL:fig:bi-rnn"/>.</p>
      </para>
      <figure frefnum="Figure 11" placement="ht" refnum="11" xml:id="S10.F11" labels="LABEL:fig:bi-rnn">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.8]bi-rnn.pdf</p>
        <toccaption><tag close=" ">11</tag>BI-RNN over the sentence “the brown fox jumped .”.</toccaption>
        <caption><tag close=": ">Figure 11</tag>BI-RNN over the sentence “the brown fox jumped .”.</caption>
      </figure>
      <para xml:id="S10.SS4.p4">
        <p>The use of BI-RNNs for sequence tagging was introduced to the NLP community by
<!-- %**** root.tex Line 2800 **** -->Irsoy and Cardie <ERROR class="undefined">\citeyear</ERROR>irsoy2014opinion.</p>
      </para>
    </subsection>
    <subsection refnum="10.5" xml:id="S10.SS5">
      <title><tag close=" ">10.5</tag>RNNs for Representing Stacks</title>
      <para xml:id="S10.SS5.p1">
        <p>Some algorithms in language processing, including those for transition-based
parsing <cite>[<bibref bibrefs="nivre2008algorithms" separator="," show="Refnum" yyseparator=","/>]</cite>, require performing feature extraction over a
stack. Instead of being confined to looking at the <Math mode="inline" xml:id="S10.SS5.p1.m1" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> top-most elements of the
stack, the RNN framework can be used to provide a fixed-sized vector encoding of
the entire stack.</p>
      </para>
      <para xml:id="S10.SS5.p2">
        <p>The main intuition is that a stack is essentially a sequence, and so the stack
state can be represented by taking the stack elements and feeding them in order
into an RNN, resulting in a final encoding of the entire stack. In order to do
this computation efficiently (without performing an <Math mode="inline" xml:id="S10.SS5.p2.m1" tex="O(n)" text="O * n"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok><XMDual><XMRef idref="XM930"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM930" font="italic">n</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> stack encoding
operation each time the stack changes), the RNN state is maintained together
with the stack state. If the stack was push-only, this would be trivial:
whenever a new element <Math mode="inline" xml:id="S10.SS5.p2.m2" tex="x" text="x"><XMath><XMTok role="UNKNOWN" font="italic">x</XMTok></XMath></Math> is pushed into the stack, the corresponding vector
<Math mode="inline" xml:id="S10.SS5.p2.m3" tex="\mathbf{x}" text="x"><XMath><XMTok role="UNKNOWN" font="bold">x</XMTok></XMath></Math> will be used together with the RNN state <Math mode="inline" xml:id="S10.SS5.p2.m4" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> in order to obtain a
new state <Math mode="inline" xml:id="S10.SS5.p2.m5" tex="\mathbf{s_{i+1}}" text="s _ (i + 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>. Dealing with pop operation is more challenging, but
can be solved by using the persistent-stack data-structure
<cite>[<bibref bibrefs="okasaki1999purely,goldberg2013efficient" separator="," show="Refnum" yyseparator=","/>]</cite>. Persistent, or immutable,
data-structures keep old versions of themselves intact when modified.
The persistent stack construction represents a stack as a pointer
to the head of a linked list. An empty stack is the empty list.
<!-- %**** root.tex Line 2825 **** -->The push operation appends an element to the list, returning the new head.
The pop operation then returns the parent of the head, but keeping the original
list intact. From the point of view of someone who held a pointer to the
previous head, the stack did not change. A subsequent push operation will add a
new child to the same node. Applying this procedure throughout the lifetime of
the stack results in a tree, where the root is an empty stack and each path from
a node to the root represents an intermediary stack state. Figure
<ref labelref="LABEL:fig:immutable-stack"/> provides an example of such a tree.
The same process can be applied in the computation graph construction, creating
an RNN with a tree structure instead of a chain structure. Backpropagating the
error from a given node will then affect all the elements that participated in
the stack when the node was created, in order. Figure <ref labelref="LABEL:fig:stack-rnn"/> shows
the computation graph for the stack-RNN corresponding to the last state in
Figure <ref labelref="LABEL:fig:immutable-stack"/>.
This modeling approach was proposed independently by Dyer et al and Watanabe et
al <cite>[<bibref bibrefs="dyer2015transitionbased,watanabe2015transitionbased" separator="," show="Refnum" yyseparator=","/>]</cite> for
transition-based dependency parsing.</p>
      </para>
      <figure frefnum="Figure 12" placement="ht" refnum="12" xml:id="S10.F12" labels="LABEL:fig:immutable-stack">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.9]stack.pdf</p>
        <toccaption><tag close=" ">12</tag>An immutable stack construction for the sequence of operations
<emph>push a; push b; push c; pop; push d; pop; pop; push e; push f</emph>.</toccaption>
        <caption><tag close=": ">Figure 12</tag>An immutable stack construction for the sequence of operations
<emph>push a; push b; push c; pop; push d; pop; pop; push e; push f</emph>.</caption>
        <!-- %**** root.tex Line 2850 **** -->
      </figure>
      <figure frefnum="Figure 13" placement="ht" refnum="13" xml:id="S10.F13" labels="LABEL:fig:stack-rnn">
        <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
        <p align="center">[width=0.7]stack-rnn.pdf</p>
        <toccaption><tag close=" ">13</tag>The stack-RNN corresponding to the final state in Figure
<ref labelref="LABEL:fig:immutable-stack"/>.</toccaption>
        <caption><tag close=": ">Figure 13</tag>The stack-RNN corresponding to the final state in Figure
<ref labelref="LABEL:fig:immutable-stack"/>.</caption>
      </figure>
      <pagination role="newpage"/>
    </subsection>
  </section>
  <section refnum="11" xml:id="S11" labels="LABEL:sec:rnn-arch">
    <title><tag close=" ">11</tag>Concrete RNN Architectures</title>
    <para xml:id="S11.p1">
      <p>We now turn to present three different instantiations of the abstract <Math mode="inline" xml:id="S11.p1.m1" tex="RNN" text="R * N * N"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">R</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok><XMTok role="UNKNOWN" font="italic">N</XMTok></XMApp></XMath></Math>
architecture discussed in the previous section, providing concrete definitions
of the functions <Math mode="inline" xml:id="S11.p1.m2" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> and <Math mode="inline" xml:id="S11.p1.m3" tex="O" text="O"><XMath><XMTok role="UNKNOWN" font="italic">O</XMTok></XMath></Math>. These are the <emph>Simple RNN</emph> (SRNN), the
<emph>Long Short-Term Memory</emph> (LSTM) and the <emph>Gated Recurrent Unit</emph> (GRU).</p>
    </para>
    <subsection refnum="11.1" xml:id="S11.SS1">
      <title><tag close=" ">11.1</tag>Simple RNN</title>
      <para xml:id="S11.SS1.p1">
        <p>The simplest RNN formulation, known as an Elman Network or Simple-RNN (S-RNN),
was proposed by Elman <ERROR class="undefined">\citeyear</ERROR>elman1990finding and explored for use in language
<!-- %**** root.tex Line 2875 **** -->modeling by Mikolov <ERROR class="undefined">\citeyear</ERROR>mikolov2012statistical. The S-RNN takes the following form:</p>
      </para>
      <para xml:id="S11.SS1.p2">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx20">
          <equation xml:id="S11.Ex59">
            <MathFork>
              <Math xml:id="S11.Ex59.m3" tex="\displaystyle\mathbf{s_{i}}=R_{SRNN}(\mathbf{s_{i-1}},\mathbf{x_{i}})=g(%&#10;\mathbf{x_{i}}\mathbf{W^{x}}+\mathbf{s_{i-1}}\mathbf{W^{s}}+\mathbf{b})" text="s _ i = R _ (S * R * N * N) * open-interval@(s _ (i - 1), x _ i) = g * (x _ i * W ^ x + s _ (i - 1) * W ^ s + b)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">S</XMTok>
                          <XMTok role="UNKNOWN" font="italic">R</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM931"/>
                          <XMRef idref="XM932"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM931">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM932">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">g</XMTok>
                      <XMDual>
                        <XMRef idref="XM933"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM933">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="bold">b</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{i}}=" xml:id="S11.Ex59.m1" text="s _ i = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R_{SRNN}(\mathbf{s_{i-1}},\mathbf{x_{i}})=g(\mathbf{x_{i}}%&#10;\mathbf{W^{x}}+\mathbf{s_{i-1}}\mathbf{W^{s}}+\mathbf{b})" xml:id="S11.Ex59.m2" text="R _ (S * R * N * N) * open-interval@(s _ (i - 1), x _ i) = g * (x _ i * W ^ x + s _ (i - 1) * W ^ s + b)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">S</XMTok>
                              <XMTok role="UNKNOWN" font="italic">R</XMTok>
                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM934"/>
                              <XMRef idref="XM935"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM934">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM935">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">g</XMTok>
                          <XMDual>
                            <XMRef idref="XM936"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM936">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                    <XMApp>
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                      <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                    <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex60">
            <MathFork>
              <Math xml:id="S11.Ex60.m3" tex="\displaystyle\mathbf{y_{i}}=O_{SRNN}(\mathbf{s_{i}})=\mathbf{s_{i}}" text="y _ i = O _ (S * R * N * N) * s _ i = s _ i">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">y</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">S</XMTok>
                          <XMTok role="UNKNOWN" font="italic">R</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM937"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM937">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{y_{i}}=" xml:id="S11.Ex60.m1" text="y _ i = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle O_{SRNN}(\mathbf{s_{i}})=\mathbf{s_{i}}" xml:id="S11.Ex60.m2" text="O _ (S * R * N * N) * s _ i = s _ i">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">S</XMTok>
                              <XMTok role="UNKNOWN" font="italic">R</XMTok>
                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                              <XMTok role="UNKNOWN" font="italic">N</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM938"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM938">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <equation xml:id="S11.Ex61">
          <Math mode="display" xml:id="S11.Ex61.m1" tex="\mathbf{s_{i}},\mathbf{y_{i}}\in\mathbb{R}^{d_{s}},\,\;\mathbf{x_{i}}\in%&#10;\mathbb{R}^{d_{x}},\,\;\mathbf{W^{x}}\in\mathbb{R}^{d_{x}\times d_{s}},\,\;%&#10;\mathbf{W^{s}}\in\mathbb{R}^{d_{s}\times d_{s}},\,\;\mathbf{b}\in\mathbb{R}^{d%&#10;_{s}}" text="formulae@(list@(s _ i, y _ i) element-of R ^ (d _ s), formulae@(x _ i element-of R ^ (d _ x), formulae@(W ^ x element-of R ^ (d _ x * d _ s), formulae@(W ^ s element-of R ^ (d _ s * d _ s), b element-of R ^ (d _ s)))))">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM947"/>
                  <XMRef idref="XM948"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM947">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="XM939"/>
                        <XMRef idref="XM940"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="XM939">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="XM940">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="UNKNOWN" font="italic">s</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                  <XMDual xml:id="XM948">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM945"/>
                      <XMRef idref="XM946"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM945">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">x</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                          <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                      <XMDual xml:id="XM946">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM943"/>
                          <XMRef idref="XM944"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM943">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="bold">W</XMTok>
                              <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">×</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                          <XMDual xml:id="XM944">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="XM941"/>
                              <XMRef idref="XM942"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="XM941">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                              <XMApp xml:id="XM942">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok role="UNKNOWN" font="bold">b</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                    <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">s</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S11.SS1.p3">
        <p>That is, the state at position <Math mode="inline" xml:id="S11.SS1.p3.m1" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> is a linear combination of the input at
position <Math mode="inline" xml:id="S11.SS1.p3.m2" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> and the previous state, passed through a non-linear activation
(commonly <Math mode="inline" xml:id="S11.SS1.p3.m3" tex="\tanh" text="hyperbolic-tangent"><XMath><XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION">tanh</XMTok></XMath></Math> or ReLU).
The output at position <Math mode="inline" xml:id="S11.SS1.p3.m4" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> is the same as
the hidden state in that position.<note mark="32" role="footnote">Some authors treat the output at
position <Math mode="inline" xml:id="S11.SS1.p3.m5" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math> as a more complicated function of the state. In our presentation,
such further transformation of the output are not considered part of the RNN,
but as separate computations that are applied to the RNNs output.
The distinction between the state and the output are needed for the LSTM
architecture, in which not all of the state is observed outside of the RNN.</note></p>
      </para>
      <!-- %**** root.tex Line 2900 **** -->
      <para xml:id="S11.SS1.p4">
        <p>In spite of its simplicity, the Simple RNN provides strong results for sequence
tagging <cite>[<bibref bibrefs="xu2015ccg" separator="," show="Refnum" yyseparator=","/>]</cite> as well as language modeling.
For comprehensive discussion on using Simple RNNs for language modeling, see
the PhD thesis by Mikolov <ERROR class="undefined">\citeyear</ERROR>mikolov2012statistical.</p>
      </para>
    </subsection>
    <subsection refnum="11.2" xml:id="S11.SS2">
      <title><tag close=" ">11.2</tag>LSTM</title>
      <para xml:id="S11.SS2.p1">
        <p>The S-RNN is hard to train effectively because of the vanishing gradients problem.
Error signals (gradients) in later steps in the sequence diminish in quickly in the back-propagation
process, and do not reach earlier input signals, making it hard for the S-RNN to capture
long-range dependencies. The Long Short-Term Memory (LSTM) architecture <cite>[<bibref bibrefs="hochreiter1997long" separator="," show="Refnum" yyseparator=","/>]</cite>
was designed to solve the vanishing gradients problem. The main idea behind the LSTM is
to introduce as part of the state representation also “memory cells” (a vector) that can preserve
gradients across time. Access to the memory cells is controlled by <emph>gating components</emph> – smooth
mathematical functions that simulate logical gates. At each input state, a gate is used to decide how
much of the new input should be written to the memory cell, and how much of the current content of the memory
cell should be forgotten.
Concretely, a gate <Math mode="inline" xml:id="S11.SS2.p1.m1" tex="\mathbf{g}\in[0,1]^{n}" text="g element-of (closed-interval@(0, 1)) ^ n"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM949"/><XMRef idref="XM950"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="0" role="NUMBER" xml:id="XM949">0</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM950">1</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math> is a vector of values in the range <Math mode="inline" xml:id="S11.SS2.p1.m2" tex="[0,1]" text="closed-interval@(0, 1)"><XMath><XMDual><XMApp><XMTok meaning="closed-interval"/><XMRef idref="XM951"/><XMRef idref="XM952"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMTok meaning="0" role="NUMBER" xml:id="XM951">0</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM952">1</XMTok><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMath></Math> that is multiplied
component-wise with another vector <Math mode="inline" xml:id="S11.SS2.p1.m3" tex="\mathbf{v}\in\mathbb{R}^{n}" text="v element-of R ^ n"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">v</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMApp></XMath></Math>, and the result is then added to another vector.
The values of <Math mode="inline" xml:id="S11.SS2.p1.m4" tex="\mathbf{g}" text="g"><XMath><XMTok role="UNKNOWN" font="bold">g</XMTok></XMath></Math> are designed to be close to either <Math mode="inline" xml:id="S11.SS2.p1.m5" tex="0" text="0"><XMath><XMTok meaning="0" role="NUMBER">0</XMTok></XMath></Math> or <Math mode="inline" xml:id="S11.SS2.p1.m6" tex="1" text="1"><XMath><XMTok meaning="1" role="NUMBER">1</XMTok></XMath></Math>, i.e. by using a sigmoid function.
Indices in <Math mode="inline" xml:id="S11.SS2.p1.m7" tex="\mathbf{v}" text="v"><XMath><XMTok role="UNKNOWN" font="bold">v</XMTok></XMath></Math> corresponding to near-one values in <Math mode="inline" xml:id="S11.SS2.p1.m8" tex="\mathbf{g}" text="g"><XMath><XMTok role="UNKNOWN" font="bold">g</XMTok></XMath></Math> are allowed
to pass, while those corresponding to near-zero values are blocked.</p>
      </para>
      <para xml:id="S11.SS2.p2">
        <p>Mathematically, the LSTM architecture is defined as:<note mark="33" role="footnote"><!-- %**** root.tex Line 2925 **** -->There are many variants on the LSTM architecture presented here.
For example, forget gates were not part of the original proposal in <cite>[<bibref bibrefs="hochreiter1997long" separator="," show="Refnum" yyseparator=","/>]</cite>, but are shown
to be an important part of the architecture. Other variants include peephole connections and gate-tying.
For an overview and comprehensive empirical comparison of various LSTM architectures see <cite>[<bibref bibrefs="greff2015lstm" separator="," show="Refnum" yyseparator=","/>]</cite>.</note></p>
      </para>
      <para xml:id="S11.SS2.p3">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx21">
          <equation xml:id="S11.Ex62">
            <MathFork>
              <Math xml:id="S11.Ex62.m3" tex="\displaystyle\mathbf{s_{j}}=R_{LSTM}(\mathbf{s_{j-1}},\mathbf{x_{j}})=[\mathbf%&#10;{c_{j}};\mathbf{h_{j}}]" text="s _ j = R _ (L * S * T * M) * open-interval@(s _ (j - 1), x _ j) = list@(c _ j, h _ j)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">S</XMTok>
                          <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM953"/>
                          <XMRef idref="XM954"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM953">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM954">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="XM955"/>
                        <XMRef idref="XM956"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="XM955">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">c</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">;</XMTok>
                        <XMApp xml:id="XM956">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{j}}=R_{LSTM}(\mathbf{s_{j-1}},\mathbf{x_{j}})=" xml:id="S11.Ex62.m1" text="s _ j = R _ (L * S * T * M) * open-interval@(s _ (j - 1), x _ j) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">S</XMTok>
                              <XMTok role="UNKNOWN" font="italic">T</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM957"/>
                              <XMRef idref="XM958"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM957">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM958">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle[\mathbf{c_{j}};\mathbf{h_{j}}]" xml:id="S11.Ex62.m2" text="list@(c _ j, h _ j)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="XM959"/>
                          <XMRef idref="XM960"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="XM959">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">c</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="XM960">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">h</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex63">
            <MathFork>
              <Math xml:id="S11.Ex63.m3" tex="\displaystyle\mathbf{c_{j}}=\mathbf{c_{j-1}}\odot\mathbf{f}+\mathbf{g}\odot%&#10;\mathbf{i}" text="c _ j = c _ (j - 1) direct-product f + g direct-product i">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">c</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">c</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="UNKNOWN" font="bold">f</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                        <XMTok role="UNKNOWN" font="bold">g</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{c_{j}}=" xml:id="S11.Ex63.m1" text="c _ j = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">c</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{c_{j-1}}\odot\mathbf{f}+\mathbf{g}\odot\mathbf{i}" xml:id="S11.Ex63.m2" text="c _ (j - 1) direct-product f + g direct-product i">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">c</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="bold">f</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                          <XMTok role="UNKNOWN" font="bold">g</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex64">
            <MathFork>
              <Math xml:id="S11.Ex64.m3" tex="\displaystyle\mathbf{h_{j}}=\tanh(\mathbf{c_{j}})\odot\mathbf{o}" text="h _ j = hyperbolic-tangent@(c _ j) direct-product o">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">h</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM961"/>
                          <XMRef idref="XM962"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM961">tanh</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM962">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">c</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMTok role="UNKNOWN" font="bold">o</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{h_{j}}=" xml:id="S11.Ex64.m1" text="h _ j = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\tanh(\mathbf{c_{j}})\odot\mathbf{o}" xml:id="S11.Ex64.m2" text="hyperbolic-tangent@(c _ j) direct-product o">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="XM963"/>
                            <XMRef idref="XM964"/>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM963">tanh</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM964">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">c</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                        <XMTok role="UNKNOWN" font="bold">o</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex65">
            <MathFork>
              <Math xml:id="S11.Ex65.m3" tex="\displaystyle\mathbf{i}=\sigma(\mathbf{x_{j}}\mathbf{W^{xi}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{hi}})" text="i = sigma * (x _ j * W ^ xi + h _ (j - 1) * W ^ hi)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">i</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMDual>
                        <XMRef idref="XM965"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM965">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xi</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hi</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{i}=" xml:id="S11.Ex65.m1" text="i = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sigma(\mathbf{x_{j}}\mathbf{W^{xi}}+\mathbf{h_{j-1}}\mathbf{W^{%&#10;hi}})" xml:id="S11.Ex65.m2" text="sigma * (x _ j * W ^ xi + h _ (j - 1) * W ^ hi)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                        <XMDual>
                          <XMRef idref="XM966"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM966">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xi</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hi</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex66">
            <MathFork>
              <Math xml:id="S11.Ex66.m3" tex="\displaystyle\mathbf{f}=\sigma(\mathbf{x_{j}}\mathbf{W^{xf}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{hf}})" text="f = sigma * (x _ j * W ^ xf + h _ (j - 1) * W ^ hf)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">f</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMDual>
                        <XMRef idref="XM967"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM967">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xf</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hf</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{f}=" xml:id="S11.Ex66.m1" text="f = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">f</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sigma(\mathbf{x_{j}}\mathbf{W^{xf}}+\mathbf{h_{j-1}}\mathbf{W^{%&#10;hf}})" xml:id="S11.Ex66.m2" text="sigma * (x _ j * W ^ xf + h _ (j - 1) * W ^ hf)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                        <XMDual>
                          <XMRef idref="XM968"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM968">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xf</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hf</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex67">
            <MathFork>
              <Math xml:id="S11.Ex67.m3" tex="\displaystyle\mathbf{o}=\sigma(\mathbf{x_{j}}\mathbf{W^{xo}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{ho}})" text="o = sigma * (x _ j * W ^ xo + h _ (j - 1) * W ^ ho)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">o</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMDual>
                        <XMRef idref="XM969"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM969">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xo</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">ho</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{o}=" xml:id="S11.Ex67.m1" text="o = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">o</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sigma(\mathbf{x_{j}}\mathbf{W^{xo}}+\mathbf{h_{j-1}}\mathbf{W^{%&#10;ho}})" xml:id="S11.Ex67.m2" text="sigma * (x _ j * W ^ xo + h _ (j - 1) * W ^ ho)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                        <XMDual>
                          <XMRef idref="XM970"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM970">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xo</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">ho</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex68">
            <MathFork>
              <Math xml:id="S11.Ex68.m3" tex="\displaystyle\mathbf{g}=\tanh(\mathbf{x_{j}}\mathbf{W^{xg}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{hg}})" text="g = hyperbolic-tangent@(x _ j * W ^ xg + h _ (j - 1) * W ^ hg)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">g</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="XM971"/>
                        <XMRef idref="XM972"/>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM971">tanh</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM972">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xg</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hg</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{g}=" xml:id="S11.Ex68.m1" text="g = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">g</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\tanh(\mathbf{x_{j}}\mathbf{W^{xg}}+\mathbf{h_{j-1}}\mathbf{W^{hg%&#10;}})" xml:id="S11.Ex68.m2" text="hyperbolic-tangent@(x _ j * W ^ xg + h _ (j - 1) * W ^ hg)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM973"/>
                          <XMRef idref="XM974"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM973">tanh</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM974">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xg</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hg</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex70">
            <MathFork>
              <Math xml:id="S11.Ex70.m3" tex="\displaystyle\mathbf{y_{j}}=O_{LSTM}(\mathbf{s_{j}})=\mathbf{h_{j}}" text="y _ j = O _ (L * S * T * M) * s _ j = h _ j">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">y</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">S</XMTok>
                          <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM975"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM975">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">h</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{y_{j}}=O_{LSTM}(\mathbf{s_{j}})=" xml:id="S11.Ex70.m1" text="y _ j = O _ (L * S * T * M) * s _ j = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">S</XMTok>
                              <XMTok role="UNKNOWN" font="italic">T</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM976"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM976">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{h_{j}}" xml:id="S11.Ex70.m2" text="h _ j">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">h</XMTok>
                        <XMTok role="UNKNOWN" font="bold">j</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S11.SS2.p4">
        <equation xml:id="S11.Ex71">
          <Math mode="display" xml:id="S11.Ex71.m1" tex="\mathbf{s_{j}}\in\mathbb{R}^{2\cdot d_{h}},\,\;\mathbf{x_{i}}\in\mathbb{R}^{d_%&#10;{x}},\,\;\mathbf{c_{j}},\mathbf{h_{j}},\mathbf{i},\mathbf{f},\mathbf{o},%&#10;\mathbf{g}\in\mathbb{R}^{d_{h}},\,\;\mathbf{W^{x\circ}}\in\mathbb{R}^{d_{x}%&#10;\times d_{h}},\,\;\mathbf{W^{h\circ}}\in\mathbb{R}^{d_{h}\times d_{h}},\,\;" text="formulae@(s _ j element-of R ^ (2 cdot d _ h), formulae@(x _ i element-of list@(R ^ (d _ x), c _ j, h _ j, i, f, o), formulae@(g element-of R ^ (d _ h), formulae@(W ^ (list@(x, compose)) element-of R ^ (d _ x * d _ h), W ^ (list@(h, compose)) element-of R ^ (d _ h * d _ h)))))">
            <XMath>
              <XMDual punctuation=",">
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM993"/>
                  <XMRef idref="XM994"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM993">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          <XMTok role="UNKNOWN" font="italic">h</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                  <XMDual xml:id="XM994">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM991"/>
                      <XMRef idref="XM992"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM991">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">x</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="XM985"/>
                            <XMRef idref="XM986"/>
                            <XMRef idref="XM987"/>
                            <XMRef idref="XM988"/>
                            <XMRef idref="XM989"/>
                            <XMRef idref="XM990"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="XM985">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                            <XMApp xml:id="XM986">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="bold">c</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="XM987">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMTok role="UNKNOWN" font="bold">h</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM988" font="bold">i</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM989" font="bold">f</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM990" font="bold">o</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMDual xml:id="XM992">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM983"/>
                          <XMRef idref="XM984"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM983">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok role="UNKNOWN" font="bold">g</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                <XMTok role="UNKNOWN" font="italic">h</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                          <XMDual xml:id="XM984">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="XM981"/>
                              <XMRef idref="XM982"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="XM981">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="XM977"/>
                                      <XMRef idref="XM978"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="UNKNOWN" xml:id="XM977" font="bold">x</XMTok>
                                      <XMTok role="PUNCT">⁣</XMTok>
                                      <XMTok meaning="compose" name="circ" role="MULOP" xml:id="XM978">∘</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                              <XMApp xml:id="XM982">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="XM979"/>
                                      <XMRef idref="XM980"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="UNKNOWN" xml:id="XM979" font="bold">h</XMTok>
                                      <XMTok role="PUNCT">⁣</XMTok>
                                      <XMTok meaning="compose" name="circ" role="MULOP" xml:id="XM980">∘</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S11.SS2.p5">
        <p>The symbol <Math mode="inline" xml:id="S11.SS2.p5.m1" tex="\odot" text="direct-product"><XMath><XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok></XMath></Math> is used to denote component-wise product.
<!-- %**** root.tex Line 2950 **** -->The state at time <Math mode="inline" xml:id="S11.SS2.p5.m2" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> is composed of two vectors, <Math mode="inline" xml:id="S11.SS2.p5.m3" tex="\mathbf{c_{j}}" text="c _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S11.SS2.p5.m4" tex="\mathbf{h_{j}}" text="h _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S11.SS2.p5.m5" tex="\mathbf{c_{j}}" text="c _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> is the memory component and <Math mode="inline" xml:id="S11.SS2.p5.m6" tex="\mathbf{h_{j}}" text="h _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> is
the output, or state, component.
There are three gates, <Math mode="inline" xml:id="S11.SS2.p5.m7" tex="\mathbf{i}" text="i"><XMath><XMTok role="UNKNOWN" font="bold">i</XMTok></XMath></Math>, <Math mode="inline" xml:id="S11.SS2.p5.m8" tex="\mathbf{f}" text="f"><XMath><XMTok role="UNKNOWN" font="bold">f</XMTok></XMath></Math> and <Math mode="inline" xml:id="S11.SS2.p5.m9" tex="\mathbf{o}" text="o"><XMath><XMTok role="UNKNOWN" font="bold">o</XMTok></XMath></Math>, controlling for <text font="bold">i</text>nput, <text font="bold">f</text>orget and <text font="bold">o</text>utput.
The gate values are computed based on linear combinations of the current input <Math mode="inline" xml:id="S11.SS2.p5.m10" tex="\mathbf{x_{j}}" text="x _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> and the previous state <Math mode="inline" xml:id="S11.SS2.p5.m11" tex="\mathbf{h_{j-1}}" text="h _ (j - 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>, passed
through a sigmoid activation function. An update candidate <Math mode="inline" xml:id="S11.SS2.p5.m12" tex="\mathbf{g}" text="g"><XMath><XMTok role="UNKNOWN" font="bold">g</XMTok></XMath></Math> is computed
as a linear combination of <Math mode="inline" xml:id="S11.SS2.p5.m13" tex="\mathbf{x_{j}}" text="x _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S11.SS2.p5.m14" tex="\mathbf{h_{j-1}}" text="h _ (j - 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math>, passed through a <Math mode="inline" xml:id="S11.SS2.p5.m15" tex="\tanh" text="hyperbolic-tangent"><XMath><XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION">tanh</XMTok></XMath></Math>
activation function. The memory <Math mode="inline" xml:id="S11.SS2.p5.m16" tex="\mathbf{c_{j}}" text="c _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> is then updated: the forget gate controls how much of the previous memory to keep (<Math mode="inline" xml:id="S11.SS2.p5.m17" tex="\mathbf{c_{j-1}}\odot\mathbf{f}" text="c _ (j - 1) direct-product f"><XMath><XMApp><XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp><XMTok role="UNKNOWN" font="bold">f</XMTok></XMApp></XMath></Math>),
and the input gate controls how much of the proposed update to keep (<Math mode="inline" xml:id="S11.SS2.p5.m18" tex="\mathbf{g}\odot\mathbf{i}" text="g direct-product i"><XMath><XMApp><XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok><XMTok role="UNKNOWN" font="bold">g</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>). Finally, the value of <Math mode="inline" xml:id="S11.SS2.p5.m19" tex="\mathbf{h_{j}}" text="h _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> (which is also the output <Math mode="inline" xml:id="S11.SS2.p5.m20" tex="\mathbf{y_{j}}" text="y _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math>) is
determined based on the content of the memory <Math mode="inline" xml:id="S11.SS2.p5.m21" tex="\mathbf{c_{j}}" text="c _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math>, passed through a <Math mode="inline" xml:id="S11.SS2.p5.m22" tex="\tanh" text="hyperbolic-tangent"><XMath><XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION">tanh</XMTok></XMath></Math> non-linearity and controlled by the output gate.
The gating mechanisms allow for gradients related to the memory part <Math mode="inline" xml:id="S11.SS2.p5.m23" tex="\mathbf{c_{j}}" text="c _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> to stay high across very long time ranges.</p>
      </para>
      <para xml:id="S11.SS2.p6">
        <p>For further discussion on the LSTM architecture see the PhD thesis by Alex
Graves <ERROR class="undefined">\citeyear</ERROR>graves2008supervised, as well as
Chris Olah’s description.<note mark="34" role="footnote"><ref class="ltx_url" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/"><text font="typewriter">http://colah.github.io/posts/2015-08-Understanding-LSTMs/</text></ref></note> For an analysis of the
behavior of an LSTM when used as a character-level language model, see
<cite>[<bibref bibrefs="karpathy2015visualizing" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S11.SS2.p7">
        <p>LSTMs are currently the most successful type of RNN architecture, and they are
responsible for many state-of-the-art sequence modeling results.
The main competitor of the LSTM-RNN is the GRU, to be discussed next.</p>
      </para>
      <paragraph xml:id="S11.SS2.SSS5.Px1">
        <title>Practical Considerations</title>
        <para xml:id="S11.SS2.SSS5.Px1.p1">
          <p>When training LSTM networks, Jozefowicz et al
<ERROR class="undefined">\citeyear</ERROR>jozefowicz2015empirical strongly recommend to always initialize the bias term
of the forget gate to be close to one. When applying dropout to an RNN with an
<!-- %**** root.tex Line 2975 **** -->LSTM, Zaremba et al <ERROR class="undefined">\citeyear</ERROR>zaremba2014recurrent found out that it is
crucial to apply dropout only on the non-recurrent connection, i.e. only to
apply it between layers and not between sequence positions.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection refnum="11.3" xml:id="S11.SS3">
      <title><tag close=" ">11.3</tag>GRU</title>
      <para xml:id="S11.SS3.p1">
        <p>The LSTM architecture is very effective, but also quite complicated. The
complexity of the system makes it hard to analyze,
and also computationally expensive to work with.
The gated recurrent unit (GRU) was recently introduced by Cho et al
<ERROR class="undefined">\citeyear</ERROR>cho2014learning as an alternative to the LSTM. It was subsequently
shown by Chung et al <ERROR class="undefined">\citeyear</ERROR>chung2014empirical to perform comparably to the
LSTM on several (non textual) datasets.</p>
      </para>
      <para xml:id="S11.SS3.p2">
        <p>Like the LSTM, the GRU is also based on a gating mechanism, but with
substantially fewer gates and without a separate memory component.</p>
      </para>
      <para xml:id="S11.SS3.p3">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx22">
          <equation xml:id="S11.Ex72">
            <MathFork>
              <Math xml:id="S11.Ex72.m3" tex="\displaystyle\mathbf{s_{j}}=R_{GRU}(\mathbf{s_{j-1}},\mathbf{x_{j}})=(\mathbf{%&#10;1}-\mathbf{z})\odot\mathbf{s_{j-1}}+\mathbf{z}\odot\mathbf{h}" text="s _ j = R _ (G * R * U) * open-interval@(s _ (j - 1), x _ j) = (1 - z) direct-product s _ (j - 1) + z direct-product h">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">G</XMTok>
                          <XMTok role="UNKNOWN" font="italic">R</XMTok>
                          <XMTok role="UNKNOWN" font="italic">U</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="XM995"/>
                          <XMRef idref="XM996"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM995">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM996">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">x</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                        <XMDual>
                          <XMRef idref="XM997"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM997">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                              <XMTok role="UNKNOWN" font="bold">z</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                        <XMTok role="UNKNOWN" font="bold">z</XMTok>
                        <XMTok role="UNKNOWN" font="bold">h</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{j}}=R_{GRU}(\mathbf{s_{j-1}},\mathbf{x_{j}})=" xml:id="S11.Ex72.m1" text="s _ j = R _ (G * R * U) * open-interval@(s _ (j - 1), x _ j) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">G</XMTok>
                              <XMTok role="UNKNOWN" font="italic">R</XMTok>
                              <XMTok role="UNKNOWN" font="italic">U</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="XM998"/>
                              <XMRef idref="XM999"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM998">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM999">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle(\mathbf{1}-\mathbf{z})\odot\mathbf{s_{j-1}}+\mathbf{z}\odot%&#10;\mathbf{h}" xml:id="S11.Ex72.m2" text="(1 - z) direct-product s _ (j - 1) + z direct-product h">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                          <XMDual>
                            <XMRef idref="XM1000"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM1000">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                <XMTok role="UNKNOWN" font="bold">z</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                          <XMTok role="UNKNOWN" font="bold">z</XMTok>
                          <XMTok role="UNKNOWN" font="bold">h</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex73">
            <MathFork>
              <Math xml:id="S11.Ex73.m3" tex="\displaystyle\mathbf{z}=\sigma(\mathbf{x_{j}}\mathbf{W^{xz}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{hz}})" text="z = sigma * (x _ j * W ^ xz + h _ (j - 1) * W ^ hz)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">z</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMDual>
                        <XMRef idref="XM1001"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1001">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xz</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hz</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{z}=" xml:id="S11.Ex73.m1" text="z = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">z</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sigma(\mathbf{x_{j}}\mathbf{W^{xz}}+\mathbf{h_{j-1}}\mathbf{W^{%&#10;hz}})" xml:id="S11.Ex73.m2" text="sigma * (x _ j * W ^ xz + h _ (j - 1) * W ^ hz)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                        <XMDual>
                          <XMRef idref="XM1002"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM1002">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xz</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hz</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex74">
            <MathFork>
              <Math xml:id="S11.Ex74.m3" tex="\displaystyle\mathbf{r}=\sigma(\mathbf{x_{j}}\mathbf{W^{xr}}+\mathbf{h_{j-1}}%&#10;\mathbf{W^{hr}})" text="r = sigma * (x _ j * W ^ xr + h _ (j - 1) * W ^ hr)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">r</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                      <XMDual>
                        <XMRef idref="XM1003"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1003">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xr</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hr</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{r}=" xml:id="S11.Ex74.m1" text="r = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">r</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\sigma(\mathbf{x_{j}}\mathbf{W^{xr}}+\mathbf{h_{j-1}}\mathbf{W^{%&#10;hr}})" xml:id="S11.Ex74.m2" text="sigma * (x _ j * W ^ xr + h _ (j - 1) * W ^ hr)">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok>
                        <XMDual>
                          <XMRef idref="XM1004"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM1004">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xr</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hr</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex75">
            <MathFork>
              <Math xml:id="S11.Ex75.m3" tex="\displaystyle\mathbf{h}=\tanh(\mathbf{x_{j}}\mathbf{W^{xh}}+(\mathbf{h_{j-1}}%&#10;\odot\mathbf{r})\mathbf{W^{hg}})" text="h = hyperbolic-tangent@(x _ j * W ^ xh + (h _ (j - 1) direct-product r) * W ^ hg)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok role="UNKNOWN" font="bold">h</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="XM1006"/>
                        <XMRef idref="XM1007"/>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM1006">tanh</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1007">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">xh</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMRef idref="XM1005"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="XM1005">
                                    <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                      <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                      <XMApp>
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                        <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="UNKNOWN" font="bold">r</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                <XMTok role="UNKNOWN" font="bold">hg</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{h}=" xml:id="S11.Ex75.m1" text="h = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok role="UNKNOWN" font="bold">h</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\tanh(\mathbf{x_{j}}\mathbf{W^{xh}}+(\mathbf{h_{j-1}}\odot\mathbf%&#10;{r})\mathbf{W^{hg}})" xml:id="S11.Ex75.m2" text="hyperbolic-tangent@(x _ j * W ^ xh + (h _ (j - 1) direct-product r) * W ^ hg)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="XM1009"/>
                          <XMRef idref="XM1010"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="hyperbolic-tangent" role="TRIGFUNCTION" xml:id="XM1009">tanh</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM1010">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">x</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">xh</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMDual>
                                  <XMRef idref="XM1008"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="XM1008">
                                      <XMTok meaning="direct-product" name="odot" role="MULOP">⊙</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                        <XMTok role="UNKNOWN" font="bold">h</XMTok>
                                        <XMApp>
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                          <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="UNKNOWN" font="bold">r</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">hg</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S11.Ex77">
            <MathFork>
              <Math xml:id="S11.Ex77.m3" tex="\displaystyle\mathbf{y_{j}}=O_{LSTM}(\mathbf{s_{j}})=\mathbf{s_{j}}" text="y _ j = O _ (L * S * T * M) * s _ j = s _ j">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">y</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">L</XMTok>
                          <XMTok role="UNKNOWN" font="italic">S</XMTok>
                          <XMTok role="UNKNOWN" font="italic">T</XMTok>
                          <XMTok role="UNKNOWN" font="italic">M</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="XM1011"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1011">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{y_{j}}=O_{LSTM}(\mathbf{s_{j}})=" xml:id="S11.Ex77.m1" text="y _ j = O _ (L * S * T * M) * s _ j = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMTok role="UNKNOWN" font="bold">y</XMTok>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">O</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" font="italic">L</XMTok>
                              <XMTok role="UNKNOWN" font="italic">S</XMTok>
                              <XMTok role="UNKNOWN" font="italic">T</XMTok>
                              <XMTok role="UNKNOWN" font="italic">M</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="XM1012"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM1012">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\mathbf{s_{j}}" xml:id="S11.Ex77.m2" text="s _ j">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">s</XMTok>
                        <XMTok role="UNKNOWN" font="bold">j</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <!-- %**** root.tex Line 3000 **** -->
      <para xml:id="S11.SS3.p4">
        <equation xml:id="S11.Ex78">
          <Math mode="display" xml:id="S11.Ex78.m1" tex="\mathbf{s_{j}}\in\mathbb{R}^{d_{h}},\,\;\mathbf{x_{i}}\in\mathbb{R}^{d_{x}},\,%&#10;\;\mathbf{z},\mathbf{r},\mathbf{h}\in\mathbb{R}^{d_{h}},\,\;\mathbf{W^{x\circ}%&#10;}\in\mathbb{R}^{d_{x}\times d_{h}},\,\;\mathbf{W^{h\circ}}\in\mathbb{R}^{d_{h}%&#10;\times d_{h}},\,\;" text="formulae@(s _ j element-of R ^ (d _ h), formulae@(x _ i element-of list@(R ^ (d _ x), z, r), formulae@(h element-of R ^ (d _ h), formulae@(W ^ (list@(x, compose)) element-of R ^ (d _ x * d _ h), W ^ (list@(h, compose)) element-of R ^ (d _ h * d _ h)))))">
            <XMath>
              <XMDual punctuation=",">
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="XM1026"/>
                  <XMRef idref="XM1027"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="XM1026">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                      <XMTok role="UNKNOWN" font="bold">s</XMTok>
                      <XMTok role="UNKNOWN" font="bold">j</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                      <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMTok role="UNKNOWN" font="italic">d</XMTok>
                        <XMTok role="UNKNOWN" font="italic">h</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                  <XMDual xml:id="XM1027">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM1024"/>
                      <XMRef idref="XM1025"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM1024">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">x</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="XM1021"/>
                            <XMRef idref="XM1022"/>
                            <XMRef idref="XM1023"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="XM1021">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM1022" font="bold">z</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok role="UNKNOWN" xml:id="XM1023" font="bold">r</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMDual xml:id="XM1025">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM1019"/>
                          <XMRef idref="XM1020"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM1019">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok role="UNKNOWN" font="bold">h</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                <XMTok role="UNKNOWN" font="italic">h</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                          <XMDual xml:id="XM1020">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="XM1017"/>
                              <XMRef idref="XM1018"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="XM1017">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="XM1013"/>
                                      <XMRef idref="XM1014"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="UNKNOWN" xml:id="XM1013" font="bold">x</XMTok>
                                      <XMTok role="PUNCT">⁣</XMTok>
                                      <XMTok meaning="compose" name="circ" role="MULOP" xml:id="XM1014">∘</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="4.5pt">,</XMTok>
                              <XMApp xml:id="XM1018">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                  <XMTok role="UNKNOWN" font="bold">W</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="XM1015"/>
                                      <XMRef idref="XM1016"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="UNKNOWN" xml:id="XM1015" font="bold">h</XMTok>
                                      <XMTok role="PUNCT">⁣</XMTok>
                                      <XMTok meaning="compose" name="circ" role="MULOP" xml:id="XM1016">∘</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                                      <XMTok role="UNKNOWN" font="italic">d</XMTok>
                                      <XMTok role="UNKNOWN" font="italic">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S11.SS3.p5" class="ltx_noindent">
        <p>One gate (<Math mode="inline" xml:id="S11.SS3.p5.m1" tex="\mathbf{r}" text="r"><XMath><XMTok role="UNKNOWN" font="bold">r</XMTok></XMath></Math>) is used to control access to the previous state <Math mode="inline" xml:id="S11.SS3.p5.m2" tex="\mathbf{s_{j-1}}" text="s _ (j - 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math> and compute a proposed update <Math mode="inline" xml:id="S11.SS3.p5.m3" tex="\mathbf{h}" text="h"><XMath><XMTok role="UNKNOWN" font="bold">h</XMTok></XMath></Math>. The updated state
<Math mode="inline" xml:id="S11.SS3.p5.m4" tex="\mathbf{s_{j}}" text="s _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math> (which also serves as the output <Math mode="inline" xml:id="S11.SS3.p5.m5" tex="\mathbf{y_{j}}" text="y _ j"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMath></Math>) is then determined based on an interpolation of the previous state <Math mode="inline" xml:id="S11.SS3.p5.m6" tex="\mathbf{s_{j-1}}" text="s _ (j - 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMath></Math> and the proposal <Math mode="inline" xml:id="S11.SS3.p5.m7" tex="\mathbf{h}" text="h"><XMath><XMTok role="UNKNOWN" font="bold">h</XMTok></XMath></Math>,
where the proportions of the interpolation are controlled using the gate <Math mode="inline" xml:id="S11.SS3.p5.m8" tex="\mathbf{z}" text="z"><XMath><XMTok role="UNKNOWN" font="bold">z</XMTok></XMath></Math>.</p>
      </para>
      <para xml:id="S11.SS3.p6">
        <p>The GRU was shown to be effective in language modeling and machine
translation.
However, the jury between the GRU, the LSTM and possible alternative
RNN architectures is still out, and the subject is actively researched.
For an empirical exploration of the GRU and the LSTM architectures, see
<cite>[<bibref bibrefs="jozefowicz2015empirical" separator="," show="Refnum" yyseparator=","/>]</cite>.</p>
      </para>
    </subsection>
    <subsection refnum="11.4" xml:id="S11.SS4">
      <title><tag close=" ">11.4</tag>Other Variants</title>
      <para xml:id="S11.SS4.p1">
        <p>The gated architectures of the LSTM and the GRU help in alleviating the
vanishing gradients problem of the Simple RNN, and allow these RNNs to capture
dependencies that span long time ranges.
Some researchers explore simpler architectures than the LSTM and the GRU for
<!-- %**** root.tex Line 3025 **** -->achieving similar benefits.</p>
      </para>
      <para xml:id="S11.SS4.p2">
        <p>Mikolov et al <ERROR class="undefined">\citeyear</ERROR>mikolov2014learning observed that the matrix
multiplication <Math mode="inline" xml:id="S11.SS4.p2.m1" tex="\mathbf{s_{i-1}}\mathbf{W^{s}}" text="s _ (i - 1) * W ^ s"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">s</XMTok></XMApp></XMApp></XMath></Math> coupled with the nonlinearity <Math mode="inline" xml:id="S11.SS4.p2.m2" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math> in the update rule <Math mode="inline" xml:id="S11.SS4.p2.m3" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math>
of the Simple RNN causes the state vector <Math mode="inline" xml:id="S11.SS4.p2.m4" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> to undergo large changes
at each time step, prohibiting it from remembering information over long time
periods. They propose to split the state vector <Math mode="inline" xml:id="S11.SS4.p2.m5" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> into a slow changing component
<Math mode="inline" xml:id="S11.SS4.p2.m6" tex="\mathbf{c_{i}}" text="c _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> (“context units”) and a fast changing component <Math mode="inline" xml:id="S11.SS4.p2.m7" tex="\mathbf{h_{i}}" text="h _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>.<note mark="35" role="footnote">We
depart from the notation in <cite>[<bibref bibrefs="mikolov2014learning" separator="," show="Refnum" yyseparator=","/>]</cite> and reuse the
symbols used in the LSTM description.</note>
The slow changing component <Math mode="inline" xml:id="S11.SS4.p2.m8" tex="\mathbf{c_{i}}" text="c _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is updated according to a linear interpolation
of the input and the previous component:
<Math mode="inline" xml:id="S11.SS4.p2.m9" tex="\mathbf{c_{i}}=(1-\alpha)\mathbf{x_{i}}\mathbf{W^{x1}}+\alpha\mathbf{c_{i-1}}" text="c _ i = (1 - alpha) * x _ i * W ^ x1 + alpha * c _ (i - 1)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMDual><XMRef idref="XM1028"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1028"><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">x1</XMTok></XMApp></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp></XMApp></XMApp></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S11.SS4.p2.m10" tex="\alpha\in(0,1)" text="alpha element-of open-interval@(0, 1)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok name="alpha" role="UNKNOWN" font="italic">α</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM1029"/><XMRef idref="XM1030"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok meaning="0" role="NUMBER" xml:id="XM1029">0</XMTok><XMTok role="PUNCT">,</XMTok><XMTok meaning="1" role="NUMBER" xml:id="XM1030">1</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math>. This
update allows <Math mode="inline" xml:id="S11.SS4.p2.m11" tex="\mathbf{c_{i}}" text="c _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> to accumulate the previous inputs. The fast changing
component <Math mode="inline" xml:id="S11.SS4.p2.m12" tex="\mathbf{h_{i}}" text="h _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is updated similarly to the Simple RNN update rule,
but changed to take <Math mode="inline" xml:id="S11.SS4.p2.m13" tex="\mathbf{c_{i}}" text="c _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> into account as well:<note mark="36" role="footnote">The update rule
diverges from the S-RNN update rule also by fixing the non-linearity to be
a sigmoid function, and by not using a bias term. However, these changes are
not discussed as central to the proposal.</note>
<Math mode="inline" xml:id="S11.SS4.p2.m14" tex="\mathbf{h_{i}}=\sigma(\mathbf{x_{i}}\mathbf{W^{x2}}+\mathbf{h_{i-1}}\mathbf{W^%&#10;{h}}+\mathbf{c_{i}}\mathbf{W^{c}})" text="h _ i = sigma * (x _ i * W ^ x2 + h _ (i - 1) * W ^ h + c _ i * W ^ c)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok name="sigma" role="UNKNOWN" font="italic">σ</XMTok><XMDual><XMRef idref="XM1031"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1031"><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">x2</XMTok></XMApp></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMApp><XMTok meaning="minus" role="ADDOP">-</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">h</XMTok></XMApp></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">c</XMTok></XMApp></XMApp></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>.
Finally, the output <Math mode="inline" xml:id="S11.SS4.p2.m15" tex="\mathbf{y_{i}}" text="y _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is the concatenation of the slow and the fast
changing parts of the state: <Math mode="inline" xml:id="S11.SS4.p2.m16" tex="\mathbf{y_{i}}=[\mathbf{c_{i}};\mathbf{h_{i}}]" text="y _ i = list@(c _ i, h _ i)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">y</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1032"/><XMRef idref="XM1033"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">[</XMTok><XMApp xml:id="XM1032"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="PUNCT">;</XMTok><XMApp xml:id="XM1033"><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">h</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">]</XMTok></XMWrap></XMDual></XMApp></XMath></Math>. Mikolov et al
demonstrate that this architecture provides competitive perplexities to
the much more complex LSTM on language modeling tasks.
<!-- %**** root.tex Line 3050 **** --></p>
      </para>
      <para xml:id="S11.SS4.p3">
        <p>The approach of Mikolov et al can be interpreted as constraining the block of the
matrix <Math mode="inline" xml:id="S11.SS4.p3.m1" tex="\mathbf{W^{s}}" text="W ^ s"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">s</XMTok></XMApp></XMath></Math> in the S-RNN corresponding to <Math mode="inline" xml:id="S11.SS4.p3.m2" tex="\mathbf{c_{i}}" text="c _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">c</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> to be a multiply of
the identity matrix (see Mikolov et al <ERROR class="undefined">\citeyear</ERROR>mikolov2014learning for the
details). Le et al <cite>[<bibref bibrefs="le2015simple" separator="," show="Refnum" yyseparator=","/>]</cite> propose an even simpler approach: set
the activation function of the S-RNN to a ReLU, and initialize the biases
<Math mode="inline" xml:id="S11.SS4.p3.m3" tex="\mathbf{b}" text="b"><XMath><XMTok role="UNKNOWN" font="bold">b</XMTok></XMath></Math> as zeroes and the matrix
<Math mode="inline" xml:id="S11.SS4.p3.m4" tex="\mathbf{W^{s}}" text="W ^ s"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">s</XMTok></XMApp></XMath></Math> as the identify matrix.
This causes an untrained RNN to copy the previous state to the current state, add
the effect of the current input <Math mode="inline" xml:id="S11.SS4.p3.m5" tex="\mathbf{x_{i}}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> and set the negative values to zero.
After setting this initial bias towards state copying,
the training procedure allows <Math mode="inline" xml:id="S11.SS4.p3.m6" tex="\mathbf{W^{s}}" text="W ^ s"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">W</XMTok><XMTok role="UNKNOWN" font="bold">s</XMTok></XMApp></XMath></Math> to change freely.
Le et al demonstrate that this simple modification makes the S-RNN comparable
to an LSTM with the same number of parameters on several tasks, including
language modeling.</p>
      </para>
      <pagination role="newpage"/>
    </subsection>
  </section>
  <section refnum="12" xml:id="S12" labels="LABEL:sec:recnn">
    <title><tag close=" ">12</tag>Modeling Trees – Recursive Neural Networks</title>
    <para xml:id="S12.p1">
      <p>The RNN is very useful for modeling sequences. In language
processing, it is often natural and desirable to work with tree structures.
The trees can be syntactic trees, discourse trees, or even trees representing
the sentiment expressed by various parts of a sentence <cite>[<bibref bibrefs="socher2013recursive" separator="," show="Refnum" yyseparator=","/>]</cite>.
We may
<!-- %**** root.tex Line 3075 **** -->want to predict values based on specific tree nodes, predict values based on the
root nodes, or assign a quality score to a complete tree or part of a tree.
In other cases, we may not care about the tree structure directly but rather
reason about spans in the sentence. In such cases, the tree is merely used as a
backbone structure which help guide the encoding process of the sequence into a
fixed size vector.</p>
    </para>
    <para xml:id="S12.p2">
      <p>The <emph>recursive neural network</emph> (RecNN) abstraction <cite>[<bibref bibrefs="pollack1990recursive" separator="," show="Refnum" yyseparator=","/>]</cite>,
popularized in NLP by
Richard Socher and colleagues
<cite>[<bibref bibrefs="socher2010learning,socher2011parsing,socher2013parsing,socher2014recursive" separator="," show="Refnum" yyseparator=","/>]</cite> is a generalization
of the RNN from sequences to (binary) trees.<note mark="37" role="footnote">While presented in terms
of binary parse trees, the concepts easily transfer to general recursively-defined data
structures, with the major technical challenge is the definition of an effective
form for <Math mode="inline" xml:id="S12.p2.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math>, the combination function.</note></p>
    </para>
    <para xml:id="S12.p3">
      <p>Much like the RNN encodes each sentence prefix as a state vector, the RecNN encodes
each tree-node as a state vector in <Math mode="inline" xml:id="S12.p3.m1" tex="\mathbb{R}^{d}" text="R ^ d"><XMath><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMath></Math>. We can then use these
state vectors either to predict values of the corresponding nodes, assign
quality values to each node, or as a semantic representation of the spans rooted
at the nodes.</p>
    </para>
    <para xml:id="S12.p4">
      <p>The main intuition behind the recursive neural networks is that each subtree is
represented as a <Math mode="inline" xml:id="S12.p4.m1" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math> dimensional vector, and the representation of a node <Math mode="inline" xml:id="S12.p4.m2" tex="p" text="p"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math>
with children <Math mode="inline" xml:id="S12.p4.m3" tex="c_{1}" text="c _ 1"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> and <Math mode="inline" xml:id="S12.p4.m4" tex="c_{2}" text="c _ 2"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> is a function of the representation of the nodes:
<!-- %**** root.tex Line 3100 **** --><Math mode="inline" xml:id="S12.p4.m5" tex="vec(p)=f(vec(c_{1}),vec(c_{2}))" text="v * e * c * p = f * open-interval@(v * e * c * c _ 1, v * e * c * c _ 2)"><XMath><XMApp><XMTok meaning="equals" role="RELOP">=</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM1034"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM1034" font="italic">p</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">f</XMTok><XMDual><XMApp><XMTok meaning="open-interval"/><XMRef idref="XM1040"/><XMRef idref="XM1041"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1040"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM1038"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1038"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM1041"><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">v</XMTok><XMTok role="UNKNOWN" font="italic">e</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">c</XMTok><XMDual><XMRef idref="XM1039"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1039"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">c</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMApp></XMath></Math>, where <Math mode="inline" xml:id="S12.p4.m6" tex="f" text="f"><XMath><XMTok role="UNKNOWN" font="italic">f</XMTok></XMath></Math> is a composition function taking two
<Math mode="inline" xml:id="S12.p4.m7" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vectors and returning a single <Math mode="inline" xml:id="S12.p4.m8" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector. Much
like the RNN state <Math mode="inline" xml:id="S12.p4.m9" tex="\mathbf{s_{i}}" text="s _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math> is used to encode the entire sequence <Math mode="inline" xml:id="S12.p4.m10" tex="\mathbf{x_{1}:i}" text="x _ 1 colon i"><XMath><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok meaning="1" role="NUMBER" font="bold">1</XMTok></XMApp><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>,
the RecNN state associated with a tree node <Math mode="inline" xml:id="S12.p4.m11" tex="p" text="p"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math> encodes the entire subtree
rooted at <Math mode="inline" xml:id="S12.p4.m12" tex="p" text="p"><XMath><XMTok role="UNKNOWN" font="italic">p</XMTok></XMath></Math>. See Figure <ref labelref="LABEL:fig:rec-nn"/> for an illustration.</p>
    </para>
    <figure frefnum="Figure 14" placement="h!t" refnum="14" xml:id="S12.F14" labels="LABEL:fig:rec-nn">
      <ERROR class="undefined ltx_centering">\includegraphics</ERROR>
      <p align="center">[width=0.4]rec-nn.pdf</p>
      <toccaption><tag close=" ">14</tag>Illustration of a recursive neural network. The representations of
V and NP<Math mode="inline" xml:id="S12.F14.m1" tex="{}_{1}" text="_1"><XMath><XMApp role="FLOATSUBSCRIPT" scriptpos="5"><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> are combined to form the representation of VP. The
representations of VP and NP<Math mode="inline" xml:id="S12.F14.m2" tex="{}_{2}" text="_2"><XMath><XMApp role="FLOATSUBSCRIPT" scriptpos="5"><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> are then combined to form the
representation of S.</toccaption>
      <caption><tag close=": ">Figure 14</tag>Illustration of a recursive neural network. The representations of
V and NP<Math mode="inline" xml:id="S12.F14.m3" tex="{}_{1}" text="_1"><XMath><XMApp role="FLOATSUBSCRIPT" scriptpos="5"><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMath></Math> are combined to form the representation of VP. The
representations of VP and NP<Math mode="inline" xml:id="S12.F14.m4" tex="{}_{2}" text="_2"><XMath><XMApp role="FLOATSUBSCRIPT" scriptpos="5"><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMath></Math> are then combined to form the
representation of S.</caption>
    </figure>
    <subsection refnum="12.1" xml:id="S12.SS1">
      <title><tag close=" ">12.1</tag>Formal Definition</title>
      <para xml:id="S12.SS1.p1">
        <p>Consider a binary parse tree <Math mode="inline" xml:id="S12.SS1.p1.m1" tex="\mathcal{T}" text="T"><XMath><XMTok role="UNKNOWN" font="caligraphic">T</XMTok></XMath></Math> over an <Math mode="inline" xml:id="S12.SS1.p1.m2" tex="n" text="n"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>-word sentence. As a reminder,
an ordered, unlabeled tree over a string <Math mode="inline" xml:id="S12.SS1.p1.m3" tex="x_{1},\ldots,x_{n}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1042"/><XMRef idref="XM1043"/><XMRef idref="XM1044"/></XMApp><XMWrap><XMApp xml:id="XM1042"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM1043">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM1044"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math> can be represented as a unique
set of triplets <Math mode="inline" xml:id="S12.SS1.p1.m4" tex="(i,k,j)" text="vector@(i, k, j)"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="XM1045"/><XMRef idref="XM1046"/><XMRef idref="XM1047"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM1045" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1046" font="italic">k</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1047" font="italic">j</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>, s.t. <Math mode="inline" xml:id="S12.SS1.p1.m5" tex="i\leq k\leq j" text="i less= k less= j"><XMath><XMApp><XMTok meaning="multirelation"/><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMath></Math>. Each such triplet indicates
that a node spanning words <Math mode="inline" xml:id="S12.SS1.p1.m6" tex="x_{i:j}" text="x _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math> is parent of the nodes spanning <Math mode="inline" xml:id="S12.SS1.p1.m7" tex="x_{i:k}" text="x _ (i colon k)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math>
and <Math mode="inline" xml:id="S12.SS1.p1.m8" tex="x_{k+1:j}" text="x _ (k + 1 colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>. Triplets of the form <Math mode="inline" xml:id="S12.SS1.p1.m9" tex="(i,i,i)" text="vector@(i, i, i)"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="XM1048"/><XMRef idref="XM1049"/><XMRef idref="XM1050"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM1048" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1049" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1050" font="italic">i</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> correspond to terminal symbols
at the tree leaves (the words <Math mode="inline" xml:id="S12.SS1.p1.m10" tex="x_{i}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok></XMApp></XMath></Math>). Moving from the unlabeled case to the
<!-- %**** root.tex Line 3125 **** -->labeled one, we can represent a tree as a set of 6-tuples <Math mode="inline" xml:id="S12.SS1.p1.m11" tex="(A\rightarrow B,C,i,k,j)" text="A rightarrow list@(B, C, i, k, j)"><XMath><XMDual><XMRef idref="XM1056"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1056"><XMTok name="rightarrow" role="ARROW">→</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1051"/><XMRef idref="XM1052"/><XMRef idref="XM1053"/><XMRef idref="XM1054"/><XMRef idref="XM1055"/></XMApp><XMWrap><XMTok role="UNKNOWN" xml:id="XM1051" font="italic">B</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1052" font="italic">C</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1053" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1054" font="italic">k</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1055" font="italic">j</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>, whereas <Math mode="inline" xml:id="S12.SS1.p1.m12" tex="i" text="i"><XMath><XMTok role="UNKNOWN" font="italic">i</XMTok></XMath></Math>, <Math mode="inline" xml:id="S12.SS1.p1.m13" tex="k" text="k"><XMath><XMTok role="UNKNOWN" font="italic">k</XMTok></XMath></Math> and <Math mode="inline" xml:id="S12.SS1.p1.m14" tex="j" text="j"><XMath><XMTok role="UNKNOWN" font="italic">j</XMTok></XMath></Math> indicate the spans as before, and <Math mode="inline" xml:id="S12.SS1.p1.m15" tex="A" text="A"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math>, <Math mode="inline" xml:id="S12.SS1.p1.m16" tex="B" text="B"><XMath><XMTok role="UNKNOWN" font="italic">B</XMTok></XMath></Math>
and <Math mode="inline" xml:id="S12.SS1.p1.m17" tex="C" text="C"><XMath><XMTok role="UNKNOWN" font="italic">C</XMTok></XMath></Math> are the node labels of of the nodes spanning <Math mode="inline" xml:id="S12.SS1.p1.m18" tex="x_{i:j}" text="x _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>, <Math mode="inline" xml:id="S12.SS1.p1.m19" tex="x_{i:k}" text="x _ (i colon k)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok></XMApp></XMApp></XMath></Math> and
<Math mode="inline" xml:id="S12.SS1.p1.m20" tex="x_{k+1:j}" text="x _ (k + 1 colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMTok role="UNKNOWN" font="italic">k</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math> respectively. Here, leaf nodes have the form <Math mode="inline" xml:id="S12.SS1.p1.m21" tex="(A\rightarrow A,A,i,i,i)" text="A rightarrow list@(A, A, i, i, i)"><XMath><XMDual><XMRef idref="XM1062"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1062"><XMTok name="rightarrow" role="ARROW">→</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1057"/><XMRef idref="XM1058"/><XMRef idref="XM1059"/><XMRef idref="XM1060"/><XMRef idref="XM1061"/></XMApp><XMWrap><XMTok role="UNKNOWN" xml:id="XM1057" font="italic">A</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1058" font="italic">A</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1059" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1060" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1061" font="italic">i</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>, where <Math mode="inline" xml:id="S12.SS1.p1.m22" tex="A" text="A"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math> is a pre-terminal symbol. We refer to such tuples as
<emph>production rules</emph>.
For an example, consider the syntactic tree for the sentence “the boy saw her
duck”.</p>
        <ERROR class="undefined ltx_centering">\Tree</ERROR>
        <p align="center">[.S [.NP [.Det the ] [.Noun boy ] ] [.VP [.Verb saw ] [.NP [.Det her ]
[.Noun duck ] ] ] ]</p>
        <p>Its corresponding unlabeled and labeled representations are :</p>
      </para>
      <para xml:id="S12.SS1.p2">
        <tabular vattach="middle" class="ltx_centering">
          <thead>
            <tr>
              <td align="center" border="r" thead="true">Unlabeled</td>
              <td align="center" border="r" thead="true">Labeled</td>
              <td align="left" thead="true">Corresponding Span</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" border="r t">(1,1,1)</td>
              <td align="center" border="r t">(Det, Det, Det, 1, 1, 1)</td>
              <td align="left" border="t"><Math mode="inline" xml:id="S12.SS1.p2.m1" tex="x_{1:1}" text="x _ (1 colon 1)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post10"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp></XMApp></XMath></Math> the</td>
            </tr>
            <tr>
              <td align="center" border="r">(2,2,2)</td>
              <td align="center" border="r">(Noun, Noun, Noun, 2, 2, 2)</td>
              <td align="left"><Math mode="inline" xml:id="S12.SS1.p2.m2" tex="x_{2:2}" text="x _ (2 colon 2)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post10"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok></XMApp></XMApp></XMath></Math> boy</td>
            </tr>
            <tr>
              <td align="center" border="r">(3,3,3)</td>
              <td align="center" border="r">(Verb, Verb, Verb, 3, 3, 3)</td>
              <td align="left">saw</td>
            </tr>
            <tr>
              <td align="center" border="r">(4,4,4)</td>
              <td align="center" border="r">(Det, Det, Det, 4, 4, 4)</td>
              <td align="left">her</td>
            </tr>
            <tr>
              <td align="center" border="r">(5,5,5)</td>
              <td align="center" border="r">(Noun, Noun, Noun, 5, 5, 5)</td>
              <td align="left">duck</td>
            </tr>
            <tr>
              <td align="center" border="r">(4,4,5)</td>
              <td align="center" border="r">(NP, Det, Noun, 4, 4, 5)</td>
              <td align="left">her duck</td>
            </tr>
            <tr>
              <td align="center" border="r">(3,3,5)</td>
              <td align="center" border="r">(VP, Verb, NP, 3, 3, 5)</td>
              <td align="left">saw her duck</td>
            </tr>
            <tr>
              <td align="center" border="r">(1,1,2)</td>
              <td align="center" border="r">(NP, Det, Noun, 1, 1, 2)</td>
              <td align="left">the boy</td>
            </tr>
            <tr>
              <td align="center" border="r">(1,2,5)</td>
              <td align="center" border="r">(S, NP, VP, 1, 2, 5)</td>
              <td align="left">the boy saw her duck</td>
            </tr>
          </tbody>
        </tabular>
      </para>
      <para xml:id="S12.SS1.p3">
        <p>The set of production rules above can be uniquely converted to a set tree nodes
<Math mode="inline" xml:id="S12.SS1.p3.m1" tex="q^{A}_{i:j}" text="(q ^ A) _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">q</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math> (indicating a node with symbol <Math mode="inline" xml:id="S12.SS1.p3.m2" tex="A" text="A"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math> over the span <Math mode="inline" xml:id="S12.SS1.p3.m3" tex="x_{i:j}" text="x _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>)
by simply ignoring
the elements <Math mode="inline" xml:id="S12.SS1.p3.m4" tex="(B,C,k)" text="vector@(B, C, k)"><XMath><XMDual><XMApp><XMTok meaning="vector"/><XMRef idref="XM1063"/><XMRef idref="XM1064"/><XMRef idref="XM1065"/></XMApp><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM1063" font="italic">B</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1064" font="italic">C</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1065" font="italic">k</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math> in each production rule. We are now in position to define
the Recursive Neural Network.</p>
      </para>
      <para xml:id="S12.SS1.p4">
        <p>A Recursive Neural Network (RecNN) is a function that takes as input a parse
tree over an <Math mode="inline" xml:id="S12.SS1.p4.m1" tex="n" text="n"><XMath><XMTok role="UNKNOWN" font="italic">n</XMTok></XMath></Math>-word sentence <Math mode="inline" xml:id="S12.SS1.p4.m2" tex="x_{1},\ldots,x_{n}" text="list@(x _ 1, ldots, x _ n)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1066"/><XMRef idref="XM1067"/><XMRef idref="XM1068"/></XMApp><XMWrap><XMApp xml:id="XM1066"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok meaning="1" role="NUMBER">1</XMTok></XMApp><XMTok role="PUNCT">,</XMTok><XMTok name="ldots" role="ID" xml:id="XM1067">…</XMTok><XMTok role="PUNCT">,</XMTok><XMApp xml:id="XM1068"><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">x</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok></XMApp></XMWrap></XMDual></XMath></Math>. Each of the sentence’s
words is represented as a <Math mode="inline" xml:id="S12.SS1.p4.m3" tex="d" text="d"><XMath><XMTok role="UNKNOWN" font="italic">d</XMTok></XMath></Math>-dimensional vector <Math mode="inline" xml:id="S12.SS1.p4.m4" tex="\mathbf{x_{i}}" text="x _ i"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">x</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok></XMApp></XMath></Math>, and the tree is represented as
a set <Math mode="inline" xml:id="S12.SS1.p4.m5" tex="\mathcal{T}" text="T"><XMath><XMTok role="UNKNOWN" font="caligraphic">T</XMTok></XMath></Math> of production rules <Math mode="inline" xml:id="S12.SS1.p4.m6" tex="(A\rightarrow B,C,i,j,k)" text="A rightarrow list@(B, C, i, j, k)"><XMath><XMDual><XMRef idref="XM1074"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMApp xml:id="XM1074"><XMTok name="rightarrow" role="ARROW">→</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1069"/><XMRef idref="XM1070"/><XMRef idref="XM1071"/><XMRef idref="XM1072"/><XMRef idref="XM1073"/></XMApp><XMWrap><XMTok role="UNKNOWN" xml:id="XM1069" font="italic">B</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1070" font="italic">C</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1071" font="italic">i</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1072" font="italic">j</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1073" font="italic">k</XMTok></XMWrap></XMDual></XMApp><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMath></Math>. Denote the nodes of
<Math mode="inline" xml:id="S12.SS1.p4.m7" tex="\mathcal{T}" text="T"><XMath><XMTok role="UNKNOWN" font="caligraphic">T</XMTok></XMath></Math> by <Math mode="inline" xml:id="S12.SS1.p4.m8" tex="q^{A}_{i:j}" text="(q ^ A) _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">q</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>.
The RecNN returns as output a corresponding set of
<emph class="ltx_markedasmath">inside state vectors</emph> <Math mode="inline" xml:id="S12.SS1.p4.m10" tex="\mathbf{s^{A}_{i:j}}" text="(s ^ A) _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">A</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMApp></XMath></Math>, where each inside state vector
<Math mode="inline" xml:id="S12.SS1.p4.m11" tex="\mathbf{s^{A}_{i:j}}\in\mathbb{R}^{d}" text="(s ^ A) _ (i colon j) element-of R ^ d"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="bold">s</XMTok><XMTok role="UNKNOWN" font="bold">A</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="bold">i</XMTok><XMTok role="UNKNOWN" font="bold">j</XMTok></XMApp></XMApp><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMath></Math> represents the
corresponding tree node <Math mode="inline" xml:id="S12.SS1.p4.m12" tex="q^{A}_{i:j}" text="(q ^ A) _ (i colon j)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">q</XMTok><XMTok role="UNKNOWN" font="italic">A</XMTok></XMApp><XMApp><XMTok name="colon" role="METARELOP">:</XMTok><XMTok role="UNKNOWN" font="italic">i</XMTok><XMTok role="UNKNOWN" font="italic">j</XMTok></XMApp></XMApp></XMath></Math>, and encodes the entire structure rooted at that node.
Like the sequence RNN, the tree shaped RecNN is defined recursively using a
function <Math mode="inline" xml:id="S12.SS1.p4.m13" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math>, where the inside vector of a given node is defined as a function of the inside vectors of its
direct children.<note mark="38" role="footnote"><!-- %**** root.tex Line 3175 **** -->Le and Zuidema <ERROR class="undefined">\citeyear</ERROR>le2014insideoutside extend the RecNN
definition such that each node has, in addition to its inside state vector, also an
<emph>outside state vector</emph> representing the entire structure around the
subtree rooted at that node. Their formulation is based on the recursive
computation of the classic inside-outside algorithm, and can be thought of as
the BI-RNN counterpart of the tree RecNN. For details, see
<cite>[<bibref bibrefs="le2014insideoutside" separator="," show="Refnum" yyseparator=","/>]</cite>.</note>
Formally:</p>
      </para>
      <para xml:id="S12.SS1.p5">
        <equationgroup class="ltx_eqn_align" xml:id="S13.EGx23">
          <equation xml:id="S12.Ex79">
            <MathFork>
              <Math xml:id="S12.Ex79.m3" tex="\displaystyle RecNN(x_{1},\ldots,x_{n},\mathcal{T})=\{\mathbf{s^{A}_{i:j}}\in%&#10;\mathbb{R}^{d}\,\mid\,q^{A}_{i:j}\in\mathcal{T}\}" text="R * e * c * N * N * vector@(x _ 1, ldots, x _ n, T) = conditional-set@((s ^ A) _ (i colon j) element-of R ^ d, (q ^ A) _ (i colon j) element-of T)">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" font="italic">R</XMTok>
                      <XMTok role="UNKNOWN" font="italic">e</XMTok>
                      <XMTok role="UNKNOWN" font="italic">c</XMTok>
                      <XMTok role="UNKNOWN" font="italic">N</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="XM1075"/>
                          <XMRef idref="XM1076"/>
                          <XMRef idref="XM1077"/>
                          <XMRef idref="XM1078"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1075">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok name="ldots" role="ID" xml:id="XM1076">…</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="XM1077">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">n</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="XM1078" font="caligraphic">T</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="conditional-set"/>
                        <XMRef idref="XM1079"/>
                        <XMRef idref="XM1080"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="XM1079">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                              <XMTok role="UNKNOWN" font="bold">s</XMTok>
                              <XMTok role="UNKNOWN" font="bold">A</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMTok role="UNKNOWN" font="bold">i</XMTok>
                              <XMTok role="UNKNOWN" font="bold">j</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp rpadding="1.7pt">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                            <XMTok role="UNKNOWN" font="italic">d</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="mid" role="VERTBAR" rpadding="1.7pt">∣</XMTok>
                        <XMApp xml:id="XM1080">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">q</XMTok>
                              <XMTok role="UNKNOWN" font="italic">A</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok name="colon" role="METARELOP">:</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                              <XMTok role="UNKNOWN" font="italic">j</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle RecNN(x_{1},\ldots,x_{n},\mathcal{T})=" xml:id="S12.Ex79.m1" text="R * e * c * N * N * vector@(x _ 1, ldots, x _ n, T) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" font="italic">R</XMTok>
                          <XMTok role="UNKNOWN" font="italic">e</XMTok>
                          <XMTok role="UNKNOWN" font="italic">c</XMTok>
                          <XMTok role="UNKNOWN" font="italic">N</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">N</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="XM1081"/>
                              <XMRef idref="XM1082"/>
                              <XMRef idref="XM1083"/>
                              <XMRef idref="XM1084"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="XM1081">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok name="ldots" role="ID" xml:id="XM1082">…</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM1083">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">x</XMTok>
                                <XMTok role="UNKNOWN" font="italic">n</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM1084" font="caligraphic">T</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle\{\mathbf{s^{A}_{i:j}}\in\mathbb{R}^{d}\,\mid\,q^{A}_{i:j}\in%&#10;\mathcal{T}\}" xml:id="S12.Ex79.m2" text="conditional-set@((s ^ A) _ (i colon j) element-of R ^ d, (q ^ A) _ (i colon j) element-of T)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="conditional-set"/>
                          <XMRef idref="XM1085"/>
                          <XMRef idref="XM1086"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                          <XMApp xml:id="XM1085">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">A</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp rpadding="1.7pt">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="blackboard">R</XMTok>
                              <XMTok role="UNKNOWN" font="italic">d</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok name="mid" role="VERTBAR" rpadding="1.7pt">∣</XMTok>
                          <XMApp xml:id="XM1086">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">q</XMTok>
                                <XMTok role="UNKNOWN" font="italic">A</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S12.Ex80">
            <MathFork>
              <Math xml:id="S12.Ex80.m3" tex="\displaystyle\mathbf{s^{A}_{i:i}}=v(x_{i})" text="(s ^ A) _ (i colon i) = v * x _ i">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                        <XMTok role="UNKNOWN" font="bold">s</XMTok>
                        <XMTok role="UNKNOWN" font="bold">A</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok name="colon" role="METARELOP">:</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                        <XMTok role="UNKNOWN" font="bold">i</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                      <XMDual>
                        <XMRef idref="XM1087"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="XM1087">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                            <XMTok role="UNKNOWN" font="italic">x</XMTok>
                            <XMTok role="UNKNOWN" font="italic">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s^{A}_{i:i}}=" xml:id="S12.Ex80.m1" text="(s ^ A) _ (i colon i) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">A</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle v(x_{i})" xml:id="S12.Ex80.m2" text="v * x _ i">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                        <XMDual>
                          <XMRef idref="XM1088"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="XM1088">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMTok role="UNKNOWN" font="italic">x</XMTok>
                              <XMTok role="UNKNOWN" font="italic">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S12.Ex81">
            <MathFork>
              <Math xml:id="S12.Ex81.m3" tex="\displaystyle\mathbf{s^{A}_{i:j}}=R(A,B,C,\mathbf{s^{B}_{i:k}},\mathbf{s^{C}_{%&#10;k+1:j}})\;\;\;\;\;\;q^{B}_{i:k}\in\mathcal{T},\;\;q^{C}_{k+1:j}\in\mathcal{T}" text="formulae@((s ^ A) _ (i colon j) = R * vector@(A, B, C, (s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)), formulae@((q ^ B) _ (i colon k) element-of T, (q ^ C) _ (k + 1 colon j) element-of T))">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="XM1096"/>
                      <XMRef idref="XM1097"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="XM1096">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">A</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="XM1089"/>
                              <XMRef idref="XM1090"/>
                              <XMRef idref="XM1091"/>
                              <XMRef idref="XM1092"/>
                              <XMRef idref="XM1093"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM1089" font="italic">A</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM1090" font="italic">B</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="XM1091" font="italic">C</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM1092">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">B</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok name="colon" role="METARELOP">:</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="XM1093">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                  <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">C</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok name="colon" role="METARELOP">:</XMTok>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                    <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                  </XMApp>
                                  <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok name="quad" role="PUNCT">   </XMTok>
                      <XMDual xml:id="XM1097">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM1094"/>
                          <XMRef idref="XM1095"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM1094">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">q</XMTok>
                                <XMTok role="UNKNOWN" font="italic">B</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                <XMTok role="UNKNOWN" font="italic">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                          <XMApp xml:id="XM1095">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">q</XMTok>
                                <XMTok role="UNKNOWN" font="italic">C</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right">
                  <Math mode="inline" tex="\displaystyle\mathbf{s^{A}_{i:j}}=" xml:id="S12.Ex81.m1" text="(s ^ A) _ (i colon j) = absent">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                            <XMTok role="UNKNOWN" font="bold">s</XMTok>
                            <XMTok role="UNKNOWN" font="bold">A</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok name="colon" role="METARELOP">:</XMTok>
                            <XMTok role="UNKNOWN" font="bold">i</XMTok>
                            <XMTok role="UNKNOWN" font="bold">j</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math>
                </td>
                <td align="left">
                  <Math mode="inline" tex="\displaystyle R(A,B,C,\mathbf{s^{B}_{i:k}},\mathbf{s^{C}_{k+1:j}})\;\;\;\;\;\;%&#10;q^{B}_{i:k}\in\mathcal{T},\;\;q^{C}_{k+1:j}\in\mathcal{T}" xml:id="S12.Ex81.m2" text="formulae@(list@(R * vector@(A, B, C, (s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)), (q ^ B) _ (i colon k)) element-of T, (q ^ C) _ (k + 1 colon j) element-of T)">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="XM1105"/>
                          <XMRef idref="XM1106"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="XM1105">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="XM1103"/>
                                <XMRef idref="XM1104"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="XM1103">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="vector"/>
                                      <XMRef idref="XM1098"/>
                                      <XMRef idref="XM1099"/>
                                      <XMRef idref="XM1100"/>
                                      <XMRef idref="XM1101"/>
                                      <XMRef idref="XM1102"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="XM1098" font="italic">A</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="XM1099" font="italic">B</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="XM1100" font="italic">C</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="XM1101">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                          <XMTok role="UNKNOWN" font="bold">B</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok name="colon" role="METARELOP">:</XMTok>
                                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                          <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="XM1102">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post9"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post9"/>
                                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                          <XMTok role="UNKNOWN" font="bold">C</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok name="colon" role="METARELOP">:</XMTok>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                          </XMApp>
                                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok name="quad" role="PUNCT" font="italic">   </XMTok>
                                <XMApp xml:id="XM1104">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                    <XMTok role="UNKNOWN" font="italic">q</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">B</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok name="colon" role="METARELOP">:</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">i</XMTok>
                                    <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                          <XMApp xml:id="XM1106">
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post8"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post8"/>
                                <XMTok role="UNKNOWN" font="italic">q</XMTok>
                                <XMTok role="UNKNOWN" font="italic">C</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="italic">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="italic">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="UNKNOWN" font="caligraphic">T</XMTok>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math>
                </td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="S12.SS1.p6">
        <p>The function <Math mode="inline" xml:id="S12.SS1.p6.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> usually takes the form of a simple linear
transformation, which may or may not be followed by a non-linear activation
function <Math mode="inline" xml:id="S12.SS1.p6.m2" tex="g" text="g"><XMath><XMTok role="UNKNOWN" font="italic">g</XMTok></XMath></Math>:</p>
      </para>
      <para xml:id="S12.SS1.p7">
        <equation xml:id="S12.Ex82">
          <Math mode="display" xml:id="S12.Ex82.m1" tex="R(A,B,C,\mathbf{s^{B}_{i:k}},\mathbf{s^{C}_{k+1:j}})=g([\mathbf{s^{B}_{i:k}};%&#10;\mathbf{s^{C}_{k+1:j}}]\mathbf{W})" text="R * vector@(A, B, C, (s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)) = g * list@((s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)) * W">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM1107"/>
                      <XMRef idref="XM1108"/>
                      <XMRef idref="XM1109"/>
                      <XMRef idref="XM1110"/>
                      <XMRef idref="XM1111"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1107" font="italic">A</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1108" font="italic">B</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1109" font="italic">C</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1110">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">B</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          <XMTok role="UNKNOWN" font="bold">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1111">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">C</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="bold">k</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                  <XMDual>
                    <XMRef idref="XM1120"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM1120">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="XM1118"/>
                            <XMRef idref="XM1119"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="XM1118">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">B</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                <XMTok role="UNKNOWN" font="bold">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="XM1119">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">C</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S12.SS1.p8" class="ltx_noindent">
        <p>This formulation of <Math mode="inline" xml:id="S12.SS1.p8.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> ignores the tree labels, using the same matrix <Math mode="inline" xml:id="S12.SS1.p8.m2" tex="\mathbf{W}\in\mathbb{R}^{2d\times d}" text="W element-of R ^ (2 * d * d)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">W</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp></XMath></Math> for all combinations. This may be a useful
formulation in case the node labels do not exist (e.g. when the tree does not
represent a syntactic structure with clearly defined labels) or when they are
unreliable. However, if the labels are available, it is generally useful to
<!-- %**** root.tex Line 3200 **** -->include them in the composition function. One approach would be to introduce
<emph>label embeddings</emph> <Math mode="inline" xml:id="S12.SS1.p8.m3" tex="v(A)" text="v * A"><XMath><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok><XMDual><XMRef idref="XM1121"/><XMWrap><XMTok role="OPEN" stretchy="false">(</XMTok><XMTok role="UNKNOWN" xml:id="XM1121" font="italic">A</XMTok><XMTok role="CLOSE" stretchy="false">)</XMTok></XMWrap></XMDual></XMApp></XMath></Math> mapping each non-terminal symbol to a <Math mode="inline" xml:id="S12.SS1.p8.m4" tex="d_{nt}" text="d _ (n * t)"><XMath><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMath></Math>
dimensional vector, and change <Math mode="inline" xml:id="S12.SS1.p8.m5" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> to include the embedded symbols in the
combination function:</p>
      </para>
      <para xml:id="S12.SS1.p9">
        <equation xml:id="S12.Ex83">
          <Math mode="display" xml:id="S12.Ex83.m1" tex="R(A,B,C,\mathbf{s^{B}_{i:k}},\mathbf{s^{C}_{k+1:j}})=g([\mathbf{s^{B}_{i:k}};%&#10;\mathbf{s^{C}_{k+1:j}};v(A);v(B)]\mathbf{W})" text="R * vector@(A, B, C, (s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)) = g * list@((s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j), v * A, v * B) * W">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM1122"/>
                      <XMRef idref="XM1123"/>
                      <XMRef idref="XM1124"/>
                      <XMRef idref="XM1125"/>
                      <XMRef idref="XM1126"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1122" font="italic">A</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1123" font="italic">B</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1124" font="italic">C</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1125">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">B</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          <XMTok role="UNKNOWN" font="bold">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1126">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">C</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="bold">k</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                  <XMDual>
                    <XMRef idref="XM1145"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM1145">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="XM1141"/>
                            <XMRef idref="XM1142"/>
                            <XMRef idref="XM1143"/>
                            <XMRef idref="XM1144"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="XM1141">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">B</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                <XMTok role="UNKNOWN" font="bold">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="XM1142">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">C</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="XM1143">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                              <XMDual>
                                <XMRef idref="XM1127"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="XM1127" font="italic">A</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="XM1144">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">v</XMTok>
                              <XMDual>
                                <XMRef idref="XM1128"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="XM1128" font="italic">B</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="UNKNOWN" font="bold">W</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S12.SS1.p10" class="ltx_noindent">
        <p>(here, <Math mode="inline" xml:id="S12.SS1.p10.m1" tex="\mathbf{W}\in\mathbb{R}^{2d+2d_{nt}\times d}" text="W element-of R ^ (2 * d + 2 * d _ (n * t) * d)"><XMath><XMApp><XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok><XMTok role="UNKNOWN" font="bold">W</XMTok><XMApp><XMTok role="SUPERSCRIPTOP" scriptpos="post3"/><XMTok role="UNKNOWN" font="blackboard">R</XMTok><XMApp><XMTok meaning="plus" role="ADDOP">+</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp><XMApp><XMTok meaning="times" role="MULOP">×</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok meaning="2" role="NUMBER">2</XMTok><XMApp><XMTok role="SUBSCRIPTOP" scriptpos="post4"/><XMTok role="UNKNOWN" font="italic">d</XMTok><XMApp><XMTok meaning="times" role="MULOP">⁢</XMTok><XMTok role="UNKNOWN" font="italic">n</XMTok><XMTok role="UNKNOWN" font="italic">t</XMTok></XMApp></XMApp></XMApp><XMTok role="UNKNOWN" font="italic">d</XMTok></XMApp></XMApp></XMApp></XMApp></XMath></Math>). Such approach is
taken by <cite>[<bibref bibrefs="qian2015learning" separator="," show="Refnum" yyseparator=","/>]</cite>.
An alternative approach, due to <cite>[<bibref bibrefs="socher2013parsing" separator="," show="Refnum" yyseparator=","/>]</cite> is to untie the weights
according to the non-terminals, using a different composition matrix for each
<Math mode="inline" xml:id="S12.SS1.p10.m2" tex="B,C" text="list@(B, C)"><XMath><XMDual><XMApp><XMTok meaning="list"/><XMRef idref="XM1146"/><XMRef idref="XM1147"/></XMApp><XMWrap><XMTok role="UNKNOWN" xml:id="XM1146" font="italic">B</XMTok><XMTok role="PUNCT">,</XMTok><XMTok role="UNKNOWN" xml:id="XM1147" font="italic">C</XMTok></XMWrap></XMDual></XMath></Math> pair of symbols:<note mark="39" role="footnote">While not explored in the literature, a trivial
extension would condition the transformation matrix also on <Math mode="inline" xml:id="S12.SS1.p10.m3" tex="A" text="A"><XMath><XMTok role="UNKNOWN" font="italic">A</XMTok></XMath></Math>.</note></p>
      </para>
      <para xml:id="S12.SS1.p11">
        <equation xml:id="S12.Ex84">
          <Math mode="display" xml:id="S12.Ex84.m1" tex="R(A,B,C,\mathbf{s^{B}_{i:k}},\mathbf{s^{C}_{k+1:j}})=g([\mathbf{s^{B}_{i:k}};%&#10;\mathbf{s^{C}_{k+1:j}}]\mathbf{W^{BC}})" text="R * vector@(A, B, C, (s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)) = g * list@((s ^ B) _ (i colon k), (s ^ C) _ (k + 1 colon j)) * W ^ BC">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">R</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="XM1148"/>
                      <XMRef idref="XM1149"/>
                      <XMRef idref="XM1150"/>
                      <XMRef idref="XM1151"/>
                      <XMRef idref="XM1152"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1148" font="italic">A</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1149" font="italic">B</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok role="UNKNOWN" xml:id="XM1150" font="italic">C</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1151">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">B</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMTok role="UNKNOWN" font="bold">i</XMTok>
                          <XMTok role="UNKNOWN" font="bold">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="XM1152">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">s</XMTok>
                          <XMTok role="UNKNOWN" font="bold">C</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok role="UNKNOWN" font="bold">k</XMTok>
                            <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                          </XMApp>
                          <XMTok role="UNKNOWN" font="bold">j</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok possibleFunction="yes" role="UNKNOWN" font="italic">g</XMTok>
                  <XMDual>
                    <XMRef idref="XM1161"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="XM1161">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="XM1159"/>
                            <XMRef idref="XM1160"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="XM1159">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">B</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMTok role="UNKNOWN" font="bold">i</XMTok>
                                <XMTok role="UNKNOWN" font="bold">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="XM1160">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                                <XMTok role="UNKNOWN" font="bold">s</XMTok>
                                <XMTok role="UNKNOWN" font="bold">C</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok role="UNKNOWN" font="bold">k</XMTok>
                                  <XMTok meaning="1" role="NUMBER" font="bold">1</XMTok>
                                </XMApp>
                                <XMTok role="UNKNOWN" font="bold">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post4"/>
                          <XMTok role="UNKNOWN" font="bold">W</XMTok>
                          <XMTok role="UNKNOWN" font="bold">BC</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S12.SS1.p12" class="ltx_noindent">
        <p>This formulation is useful when the number of non-terminal symbols (or
the number of possible symbol combinations) is relatively small, as is usually
the case with phrase-structure parse trees. A similar model was also used by
<cite>[<bibref bibrefs="hashimoto2013simple" separator="," show="Refnum" yyseparator=","/>]</cite> to encode subtrees in semantic-relation
classification task.
<!-- %**** root.tex Line 3225 **** --></p>
      </para>
    </subsection>
    <subsection refnum="12.2" xml:id="S12.SS2">
      <title><tag close=" ">12.2</tag>Extensions and Variations</title>
      <para xml:id="S12.SS2.p1">
        <p>As all of the definitions of <Math mode="inline" xml:id="S12.SS2.p1.m1" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> above suffer from the vanishing gradients
problem of the Simple RNN, several authors sought to replace it with functions
inspired by the Long Short-Term Memory (LSTM) gated architecture, resulting in
Tree-shaped LSTMs <cite>[<bibref bibrefs="tai2015improved,zhu2015long" separator="," show="Refnum" yyseparator=","/>]</cite>.
The question of optimal tree representation is still very much an open research
question, and the vast space of possible combination functions <Math mode="inline" xml:id="S12.SS2.p1.m2" tex="R" text="R"><XMath><XMTok role="UNKNOWN" font="italic">R</XMTok></XMath></Math> is yet to be
explored.
Other proposed variants on tree-structured RNNs includes a
<emph>recursive matrix-vector model</emph> <cite>[<bibref bibrefs="socher2012semantic" separator="," show="Refnum" yyseparator=","/>]</cite>
and <emph>recursive neural tensor network</emph> <cite>[<bibref bibrefs="socher2013recursive" separator="," show="Refnum" yyseparator=","/>]</cite>.
In the first variant, each word is
represented as a combination of a vector and a matrix, where the vector defines
the word’s static semantic content as before, while the matrix acts as a learned
“operator” for the word, allowing more subtle semantic compositions than the
addition and weighted averaging implied by the concatenation followed by linear
transformation function. In the second variant, words are associated with
vectors as usual, but the composition
function becomes more expressive by basing it on tensor instead of matrix operations.</p>
      </para>
    </subsection>
    <subsection refnum="12.3" xml:id="S12.SS3">
      <title><tag close=" ">12.3</tag>Training Recursive Neural Networks</title>
      <para xml:id="S12.SS3.p1">
        <p>The training procedure for a recursive neural network follows the same recipe as
<!-- %**** root.tex Line 3250 **** -->training other forms of networks: define a loss, spell out the computation graph, compute
gradients using backpropagation<note mark="40" role="footnote">Before the introduction of the
computation graph abstraction, the specific backpropagation procedure for
computing the gradients in a RecNN as defined above was referred to as the
Back-propagation trough Structure (BPTS) algorithm <cite>[<bibref bibrefs="goller1996learning" separator="," show="Refnum" yyseparator=","/>]</cite>.</note>, and train the parameters using SGD.</p>
      </para>
      <para xml:id="S12.SS3.p2">
        <p>With regard to the loss function, similar to the sequence RNN one can associate
a loss either with the root of the tree, with any given node, or with a set of
nodes, in which case the individual node’s losses are combined, usually by
summation. The loss function is based on the labeled training data which
associates a label or other quantity with different tree nodes.</p>
      </para>
      <para xml:id="S12.SS3.p3">
        <p>Additionally, one can treat the RecNN as an Encoder, whereas the inside-vector
associated with a node is taken to be an encoding of the tree rooted at that
node. The encoding can potentially be sensitive to arbitrary properties of
the structure. The vector is then passed as input to another network.</p>
      </para>
      <para xml:id="S12.SS3.p4">
        <p>For further discussion on recursive neural networks and
their use in natural language tasks, refer to the PhD thesis of Richard Socher
<ERROR class="undefined">\citeyear</ERROR>socher2014recursive.</p>
      </para>
      <pagination role="newpage"/>
    </subsection>
  </section>
  <section refnum="13" xml:id="S13">
    <title><tag close=" ">13</tag>Conclusions</title>
    <para xml:id="S13.p1">
      <p>Neural networks are powerful learners, providing opportunities
<!-- %**** root.tex Line 3275 **** -->ranging from non-linear classification to non-Markovian modeling of sequences
and trees.
We hope that this exposition
help NLP researchers to incorporate neural network models in
their work and take advantage of their power.</p>
    </para>
    <!-- %“paragraph–Extensions to non-binary trees˝ 
     %convolutional layer. RNN / LSTM.
     %**** root.tex Line 3300 ****-->
  </section>
  <bibliography bibstyle="theapa" citestyle="numbers" files="main" xml:id="bib">
    <title>References</title>
  </bibliography>
</document>
